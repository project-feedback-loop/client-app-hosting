"use strict";(self.webpackChunkfeedback_loop_client=self.webpackChunkfeedback_loop_client||[]).push([[895],{5499:(Te,me,v)=>{v.d(me,{T:()=>ie});var c=v(5e3),L=v(9826),se=v(6819),z=v(5319),N=v(9352),H=v(9808),W=v(4342),F=v(4112);function j(ce,de){if(1&ce&&c._UZ(0,"div",14),2&ce){const J=c.oxw(2);c.Q6J("MarkdownContentParser",J.flMilestone.content)}}function ue(ce,de){if(1&ce&&(c.TgZ(0,"span",15),c._uU(1),c.ALo(2,"date"),c.qZA()),2&ce){const J=c.oxw(2);c.xp6(1),c.AsE(" Updated At ",c.xi3(2,2,J.flMilestone.updatedAt,"h:mm a, MMM d, y")," . ",J.flMilestone.status," ")}}function ge(ce,de){if(1&ce&&(c.TgZ(0,"div",15),c._uU(1),c.qZA()),2&ce){const J=c.oxw(2);c.xp6(1),c.hij(" Created By ",J.user.name," ")}}function V(ce,de){1&ce&&(c.TgZ(0,"WingBlank",0)(1,"span",16),c._uU(2," task "),c.qZA()()),2&ce&&c.Q6J("size","sm")}function oe(ce,de){if(1&ce){const J=c.EpF();c.TgZ(0,"div",3),c.NdJ("click",function(){return c.CHM(J),c.oxw().openmilestone()}),c.TgZ(1,"header",4)(2,"div",5),c._UZ(3,"nz-progress",6),c.TgZ(4,"div",7),c.YNc(5,j,1,1,"div",8),c.YNc(6,ue,3,5,"span",9),c.qZA()(),c._UZ(7,"div",10),c.qZA(),c.TgZ(8,"footer",11),c.YNc(9,ge,2,1,"div",9),c.TgZ(10,"div",12),c.YNc(11,V,3,1,"WingBlank",13),c.qZA()()()}if(2&ce){const J=c.oxw();c.xp6(3),c.Q6J("nzStrokeColor","var(--accent-text-color)")("nzPercent",J.flMilestone.percentage)("nzWidth",50),c.xp6(2),c.Q6J("ngIf",J.flMilestone.content),c.xp6(1),c.Q6J("ngIf",J.user),c.xp6(3),c.Q6J("ngIf",J.user),c.xp6(2),c.Q6J("ngIf",J.hasAssociatedTasks())}}function te(ce,de){if(1&ce&&c._UZ(0,"div",14),2&ce){const J=c.oxw(2);c.Q6J("MarkdownContentParser",J.flMilestone.content)}}function ae(ce,de){if(1&ce){const J=c.EpF();c.TgZ(0,"div",17),c.NdJ("click",function(){return c.CHM(J),c.oxw().openmilestone()}),c.TgZ(1,"div",18),c._UZ(2,"nz-progress",19),c.TgZ(3,"div"),c.YNc(4,te,1,1,"div",8),c.TgZ(5,"span",20),c._uU(6),c.ALo(7,"date"),c.qZA()()()()}if(2&ce){const J=c.oxw();c.xp6(2),c.Q6J("nzStrokeColor","var(--accent-text-color)")("nzPercent",null==J.flMilestone?null:J.flMilestone.percentage)("nzWidth",50),c.xp6(2),c.Q6J("ngIf",J.flMilestone.content),c.xp6(2),c.Oqu(c.lcZ(7,5,null==J.flMilestone?null:J.flMilestone.updatedAt))}}let ie=(()=>{class ce{constructor(J,$,K){this.route=J,this.userQuery=$,this.userService=K}ngOnInit(){this.flMilestone&&this.flMilestone.createdByUser&&(this.userQuery.hasEntity(this.flMilestone.createdByUser)||this.userService.get(this.flMilestone.createdByUser).subscribe(),this.userSubscription=this.userQuery.selectEntity(this.flMilestone.createdByUser).subscribe(J=>{J&&(this.user=J)}))}hasAssociatedTasks(){return!!this.flMilestone.tasks&&this.flMilestone.tasks.length>0}openmilestone(){this.route.navigate([`/view/milestone/${this.flMilestone.id}`])}}return ce.\u0275fac=function(J){return new(J||ce)(c.Y36(L.F0),c.Y36(se.o),c.Y36(z.T))},ce.\u0275cmp=c.Xpm({type:ce,selectors:[["app-milestone-card"]],inputs:{flMilestone:"flMilestone",size:"size"},decls:3,vars:3,consts:[[3,"size"],["class","req-list-item-body",3,"click",4,"ngIf"],["class","rlth-minsize",3,"click",4,"ngIf"],[1,"req-list-item-body",3,"click"],[1,"req-list-item-header"],[1,"rlth-time"],["nzType","circle",1,"rlth-time-icon",3,"nzStrokeColor","nzPercent","nzWidth"],[1,"rlth-time-div"],["class","rlth-time-text",3,"MarkdownContentParser",4,"ngIf"],["class","rlth-time-user",4,"ngIf"],[1,"rlth-status"],[1,"req-list-item-footer"],[1,"rlth-time-user","rlth-time-user-row"],[3,"size",4,"ngIf"],[1,"rlth-time-text",3,"MarkdownContentParser"],[1,"rlth-time-user"],[1,"material-symbols-rounded","rlth-icon"],[1,"rlth-minsize",3,"click"],[1,"milestone-content"],["nzType","circle",1,"rlth-time-icon","progress-icon",3,"nzStrokeColor","nzPercent","nzWidth"],[1,"rlth-date"]],template:function(J,$){1&J&&(c._UZ(0,"WhiteSpace",0),c.YNc(1,oe,12,7,"div",1),c.YNc(2,ae,8,7,"div",2)),2&J&&(c.Q6J("size","md"),c.xp6(1),c.Q6J("ngIf",!$.size&&$.flMilestone),c.xp6(1),c.Q6J("ngIf",$.size))},directives:[N.yG,H.O5,W.M,F.J,N.gx],pipes:[H.uU],styles:[".card-body[_ngcontent-%COMP%]{width:100%;font-size:1rem}.header[_ngcontent-%COMP%]{width:100%;display:flex;align-items:flex-start}.title-container[_ngcontent-%COMP%]{flex:1;overflow:hidden}.title-div[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]{font-weight:500;text-transform:capitalize;overflow:hidden;text-overflow:ellipsis}.status-time-div[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color)}.task-div[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.task[_ngcontent-%COMP%]{background-color:var(--dim-bg-color);padding:2px 10px;border-radius:25px}.progress-icon[_ngcontent-%COMP%]{background-color:#f5f5f5;border-radius:50%;margin-right:8px;text-align:center}.req-list-item-body[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;font-size:1rem}.req-list-item-header[_ngcontent-%COMP%]{flex:1;display:flex}.req-list-item-container[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;white-space:break-spaces;font-size:1rem;padding:12px 0 6px}.rlth-time[_ngcontent-%COMP%]{display:flex;flex:3;align-items:flex-start;height:100%}.rlth-time-icon[_ngcontent-%COMP%]{max-width:40px;max-height:40px;background-color:#f5f5f5;border-radius:50%;margin-right:8px;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;height:28px;margin:auto}.rlth-time-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-self:center;max-width:100%;font-size:1rem}.rlth-time-div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;align-self:flex-start}.rlth-time-text[_ngcontent-%COMP%]{font-weight:500;font-size:1rem;text-transform:capitalize}.rlth-time-user[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color);overflow:hidden;margin-top:3px}.rlth-time-value[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color)}.rlth-status[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;justify-content:flex-end;max-width:50%;column-gap:4px}.rlth-status-span[_ngcontent-%COMP%]{font-size:1rem;background-color:#efd0dd;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;border-radius:25px;color:#ad1457}.rli-start[_ngcontent-%COMP%], .rli-end[_ngcontent-%COMP%]{display:flex;flex:1}.rli-start[_ngcontent-%COMP%]{justify-content:flex-start}.rli-end[_ngcontent-%COMP%]{justify-content:flex-end}.rli-end[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{justify-content:flex-end}button[_ngcontent-%COMP%]{border-radius:15px;padding:1px 8px;border:1px solid transparent;align-self:flex-start;position:relative;background-color:var(--dim-bg-color)}button[_ngcontent-%COMP%] > .dot[_ngcontent-%COMP%]{position:absolute;right:-4px;top:-9px;min-width:13px;max-width:25px;height:14px;border-radius:20px;background-color:#108ee9;padding:0 4%;color:#fff;font-size:10px}.rlth-time-user-row[_ngcontent-%COMP%]{display:flex}"]}),ce})()},5405:(Te,me,v)=>{v.d(me,{U:()=>J});var c=v(5e3),L=v(7465),se=v(9826),z=v(6819),N=v(5319),H=v(9808),W=v(4112),F=v(9352),j=v(5513);const ue=["content"];function ge($,K){if(1&$&&c._UZ(0,"img",17),2&$){const Z=c.oxw(3);c.Q6J("src",Z.user.picture,c.LSH)}}function V($,K){if(1&$&&(c._UZ(0,"img",18),c.ALo(1,"categoryImgPath")),2&$){const Z=c.oxw(3);c.Q6J("src",c.lcZ(1,1,Z.request.category),c.LSH)}}function oe($,K){if(1&$&&(c.TgZ(0,"header",8)(1,"div",9)(2,"span",10),c.YNc(3,ge,1,1,"img",11),c.qZA(),c.TgZ(4,"div",12)(5,"span",13),c._uU(6),c.qZA(),c.TgZ(7,"span",14),c._uU(8),c.qZA()()(),c.TgZ(9,"div",15),c.YNc(10,V,2,3,"img",16),c.qZA()()),2&$){const Z=c.oxw(2);c.xp6(3),c.Q6J("ngIf",Z.request.category),c.xp6(3),c.hij(" ",Z.user.name," "),c.xp6(2),c.hij(" ",Z.user.email," "),c.xp6(2),c.Q6J("ngIf",Z.request.category)}}function te($,K){1&$&&(c.TgZ(0,"div",6)(1,"WingBlank",19)(2,"span",20),c._uU(3," task "),c.qZA()()()),2&$&&(c.xp6(1),c.Q6J("size","sm"))}const ae=function($){return{"status-close":$}};function ie($,K){if(1&$){const Z=c.EpF();c.TgZ(0,"div",2),c.NdJ("click",function(){return c.CHM(Z),c.oxw().openRequest()}),c.YNc(1,oe,11,4,"header",3),c._UZ(2,"div",4),c.TgZ(3,"footer",5)(4,"div",6),c._uU(5),c.ALo(6,"date"),c.qZA(),c.YNc(7,te,4,1,"div",7),c.qZA()()}if(2&$){const Z=c.oxw();c.Q6J("ngClass",c.VKq(10,ae,"Close"===Z.request.status)),c.xp6(1),c.Q6J("ngIf",Z.user),c.xp6(1),c.Q6J("MarkdownContentParser",Z.request.content),c.xp6(3),c.lnq(" ",c.xi3(6,7,Z.request.createdAt,"MMM d, y At h:mm a")," . ",Z.request.status," . ",Z.request.severity," "),c.xp6(2),c.Q6J("ngIf",Z.checkIfAssociatedToTask())}}function ce($,K){if(1&$&&(c._UZ(0,"img",27),c.ALo(1,"categoryImgPath")),2&$){const Z=c.oxw(2);c.Q6J("src",c.lcZ(1,1,Z.request.category),c.LSH)}}function de($,K){if(1&$){const Z=c.EpF();c.TgZ(0,"div",21),c.NdJ("click",function(){return c.CHM(Z),c.oxw().openRequest()}),c.TgZ(1,"div",22)(2,"span",23),c.YNc(3,ce,2,3,"img",24),c.qZA(),c.TgZ(4,"div"),c._UZ(5,"span",25),c.TgZ(6,"span",26),c._uU(7),c.ALo(8,"date"),c.qZA()()()()}if(2&$){const Z=c.oxw();c.xp6(3),c.Q6J("ngIf",Z.request.category),c.xp6(2),c.Q6J("MarkdownContentParser",Z.request.content),c.xp6(2),c.Oqu(c.lcZ(8,3,Z.request.createdAt))}}let J=(()=>{class ${constructor(Z,Y,Ce,he){this.global=Z,this.router=Y,this.userQuery=Ce,this.userService=he,this.disabled=!0}ngOnInit(){this.request&&this.request.createdByUser&&(this.userQuery.hasEntity(this.request.createdByUser)||this.userService.get(this.request.createdByUser).subscribe(),this.userSubscription=this.userQuery.selectEntity(this.request.createdByUser).subscribe(Z=>{Z&&(this.user=Z)}))}ngAfterViewInit(){}checkIfAssociatedToTask(){return!(!this.request||!this.request.associatedTasks)&&this.request.associatedTasks.length>0}openRequest(){this.request&&!this.disabled&&this.router.navigate([`/view/request/${this.request.id}`])}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}}return $.\u0275fac=function(Z){return new(Z||$)(c.Y36(L.U),c.Y36(se.F0),c.Y36(z.o),c.Y36(N.T))},$.\u0275cmp=c.Xpm({type:$,selectors:[["app-req-list-item"]],viewQuery:function(Z,Y){if(1&Z&&c.Gf(ue,5),2&Z){let Ce;c.iGM(Ce=c.CRH())&&(Y.content=Ce.first)}},inputs:{request:"request",disabled:"disabled",size:"size",style:"style"},decls:2,vars:2,consts:[["class","req-list-item-body",3,"ngClass","click",4,"ngIf"],["class","rlth-minsize",3,"click",4,"ngIf"],[1,"req-list-item-body",3,"ngClass","click"],["class","req-list-item-header",4,"ngIf"],[1,"req-list-item-container",3,"MarkdownContentParser"],[1,"req-list-item-footer"],[1,"rlth-time-user"],["class","rlth-time-user",4,"ngIf"],[1,"req-list-item-header"],[1,"rlth-time"],[1,"material-symbols-rounded","rlth-time-icon"],["class","rlth-time-icon","alt","",3,"src",4,"ngIf"],[1,"rlth-time-div"],[1,"rlth-time-text"],[1,"rlth-time-user","rlth-time-user-min"],[1,"rlth-category"],["class","rlth-time-icon rlth-time-icon-min","alt","",3,"src",4,"ngIf"],["alt","",1,"rlth-time-icon",3,"src"],["alt","",1,"rlth-time-icon","rlth-time-icon-min",3,"src"],[3,"size"],[1,"material-symbols-rounded","rlth-icon"],[1,"rlth-minsize",3,"click"],[1,"milestone-content"],[1,"material-symbols-rounded","rlth-time-iconlist"],["alt","",3,"src",4,"ngIf"],[1,"rlth-title",3,"MarkdownContentParser"],[1,"rlth-date"],["alt","",3,"src"]],template:function(Z,Y){1&Z&&(c.YNc(0,ie,8,12,"div",0),c.YNc(1,de,9,5,"div",1)),2&Z&&(c.Q6J("ngIf",!Y.size&&Y.user&&Y.request),c.xp6(1),c.Q6J("ngIf",Y.size))},directives:[H.O5,H.mk,W.J,F.gx],pipes:[j.I,H.uU],styles:[".req-list-item-body[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:column;padding-bottom:6px}.req-list-item-header[_ngcontent-%COMP%]{max-height:38px;min-height:38px;height:38px;display:flex;justify-content:space-between;align-items:center;align-content:center}.req-list-item-container[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;white-space:break-spaces;font-size:1rem;padding-top:3px}.req-list-item-footer[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:space-between;align-items:center;font-size:.8rem!important;margin-top:12px}.rlth-time[_ngcontent-%COMP%]{display:flex;flex:9;align-items:center;height:100%!important}.rlth-category[_ngcontent-%COMP%]{display:flex;flex:1;align-items:flex-start;justify-content:flex-end;height:100%!important}.rlth-category[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;height:18px}.rlth-time-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-icon-min[_ngcontent-%COMP%]{width:12px;height:12px}.rlth-time[_ngcontent-%COMP%]   .rlth-time-div[_ngcontent-%COMP%]{margin-left:12px}.rlth-time-icon-space[_ngcontent-%COMP%]{margin-left:8px}.rlth-time-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;max-width:100%;font-size:1rem}.rlth-time-div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.rlth-time-text[_ngcontent-%COMP%]{font-size:1rem;text-transform:capitalize}.rlth-time-user[_ngcontent-%COMP%]{color:var(--dim-text-color);text-align:center;display:flex;align-items:center}.rlth-time-user-min[_ngcontent-%COMP%]{font-size:.8rem}.rlth-time-user-black[_ngcontent-%COMP%]{color:#000!important}.rlth-time-value[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color)}.rlth-status[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;justify-content:flex-end;align-items:flex-start;max-width:50%}.rlth-status-span[_ngcontent-%COMP%]{font-size:1rem;background-color:#efd0dd;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;border-radius:25px;color:#ad1457}.rlth-options-span[_ngcontent-%COMP%]{cursor:pointer}.rli-start[_ngcontent-%COMP%], .rli-end[_ngcontent-%COMP%]{display:flex;flex:1}.rli-start[_ngcontent-%COMP%]{justify-content:flex-start}.rli-end[_ngcontent-%COMP%]{justify-content:flex-end}.rli-end[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{justify-content:flex-end}.rlth-time-iconlist[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-iconlist[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:75%;height:75%;margin:auto}.rlth-details-gap[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.rlth-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;font-size:.9rem}.rlth-date[_ngcontent-%COMP%]{font-size:.8rem}.status-close[_ngcontent-%COMP%]{opacity:.6}.rlth-icon[_ngcontent-%COMP%]{margin-left:6px;font-size:1rem!important}"]}),$})()},6762:(Te,me,v)=>{v.d(me,{T:()=>$});var c=v(5e3),L=v(9826),se=v(5319),z=v(6819),N=v(9808),H=v(4342);let W=(()=>{class K{constructor(){this.status=""}ngOnInit(){}}return K.\u0275fac=function(Y){return new(Y||K)},K.\u0275cmp=c.Xpm({type:K,selectors:[["app-status-tag"]],inputs:{status:"status"},decls:2,vars:1,consts:[[1,"rlth-status-span"]],template:function(Y,Ce){1&Y&&(c.TgZ(0,"span",0),c._uU(1),c.qZA()),2&Y&&(c.xp6(1),c.Oqu(Ce.status))},styles:["span[_ngcontent-%COMP%]{font-size:1rem;background-color:var(--dim-bg-color);width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;padding:2px 10px;border-radius:25px}"]}),K})();var F=v(4112),j=v(9352);function ue(K,Z){if(1&K&&c._UZ(0,"div",13),2&K){const Y=c.oxw(2);c.Q6J("MarkdownContentParser",Y.flTask.content)}}function ge(K,Z){if(1&K){const Y=c.EpF();c.TgZ(0,"div",2),c.NdJ("click",function(){return c.CHM(Y),c.oxw().openTask()}),c.TgZ(1,"header",3)(2,"div",4),c._UZ(3,"nz-progress",5),c.TgZ(4,"div",6)(5,"span",7),c._uU(6),c.TgZ(7,"span",8),c._uU(8),c.ALo(9,"date"),c.qZA()(),c.TgZ(10,"span",8),c._uU(11),c.qZA()()(),c.TgZ(12,"div",9),c._UZ(13,"app-status-tag",10),c.TgZ(14,"span",11),c._uU(15," more_vert "),c.qZA()()(),c.YNc(16,ue,1,1,"div",12),c.qZA()}if(2&K){const Y=c.oxw();c.xp6(3),c.Q6J("nzStrokeColor","var(--accent-text-color)")("nzPercent",Y.flTask.percentage)("nzWidth",50),c.xp6(3),c.hij(" ",Y.flTask.status,""),c.xp6(2),c.hij(" . ",c.lcZ(9,8,Y.flTask.createdAt),""),c.xp6(3),c.hij(" ",Y.flTask.userEmail," "),c.xp6(2),c.Q6J("status",Y.flTask.requestCount?Y.flTask.requestCount.toString():"0"),c.xp6(3),c.Q6J("ngIf",Y.flTask.content)}}function V(K,Z){if(1&K&&c._UZ(0,"div",19),2&K){const Y=c.oxw(2);c.Q6J("MarkdownContentParser",Y.flTask.content)}}function oe(K,Z){if(1&K&&(c.TgZ(0,"span",8),c._uU(1),c.ALo(2,"date"),c.qZA()),2&K){const Y=c.oxw(2);c.xp6(1),c.AsE(" Updated At ",c.xi3(2,2,Y.flTask.updatedAt,"h:mm a, MMM d, y")," . ",Y.flTask.status," ")}}function te(K,Z){if(1&K&&(c.TgZ(0,"div",8),c._uU(1),c.qZA()),2&K){const Y=c.oxw(2);c.xp6(1),c.hij(" Created By ",Y.user.name," ")}}function ae(K,Z){1&K&&(c.TgZ(0,"WingBlank",20)(1,"span",21),c._uU(2," back_hand "),c.qZA()()),2&K&&c.Q6J("size","sm")}function ie(K,Z){1&K&&(c.TgZ(0,"WingBlank",20)(1,"span",21),c._uU(2," emoji_flags "),c.qZA()()),2&K&&c.Q6J("size","sm")}function ce(K,Z){if(1&K){const Y=c.EpF();c.TgZ(0,"div",2),c.NdJ("click",function(){return c.CHM(Y),c.oxw().openTask()}),c.TgZ(1,"header",3)(2,"div",4),c._UZ(3,"nz-progress",5),c.TgZ(4,"div",6),c.YNc(5,V,1,1,"div",14),c.YNc(6,oe,3,5,"span",15),c.qZA()(),c._UZ(7,"div",9),c.qZA(),c.TgZ(8,"footer",16),c.YNc(9,te,2,1,"div",15),c.TgZ(10,"div",17),c.YNc(11,ae,3,1,"WingBlank",18),c.YNc(12,ie,3,1,"WingBlank",18),c.qZA()()()}if(2&K){const Y=c.oxw();c.xp6(3),c.Q6J("nzStrokeColor","var(--accent-text-color)")("nzPercent",Y.flTask.percentage)("nzWidth",50),c.xp6(2),c.Q6J("ngIf",Y.flTask.content),c.xp6(1),c.Q6J("ngIf",Y.user),c.xp6(3),c.Q6J("ngIf",Y.user),c.xp6(2),c.Q6J("ngIf",Y.hasAssociatedRequests()),c.xp6(1),c.Q6J("ngIf",Y.hasAssociatedMilestone())}}function de(K,Z){if(1&K&&c._UZ(0,"div",26),2&K){const Y=c.oxw(2);c.Q6J("MarkdownContentParser",Y.flTask.content)}}function J(K,Z){if(1&K){const Y=c.EpF();c.TgZ(0,"div",22),c.NdJ("click",function(){return c.CHM(Y),c.oxw().openTask()}),c.TgZ(1,"div",23),c._UZ(2,"nz-progress",5),c.TgZ(3,"div"),c.YNc(4,de,1,1,"div",24),c.TgZ(5,"span",25),c._uU(6),c.ALo(7,"date"),c.qZA()()()()}if(2&K){const Y=c.oxw();c.xp6(2),c.Q6J("nzStrokeColor","var(--accent-text-color)")("nzPercent",Y.flTask.percentage)("nzWidth",50),c.xp6(2),c.Q6J("ngIf",Y.flTask.content),c.xp6(2),c.Oqu(c.lcZ(7,5,Y.flTask.createdAt))}}let $=(()=>{class K{constructor(Y,Ce,he){this.router=Y,this.userService=Ce,this.userQuery=he,this.flTask={},this.disabled=!0}ngOnInit(){this.flTask&&this.flTask.createdByUser&&(this.userQuery.hasEntity(this.flTask.createdByUser)||this.userService.get(this.flTask.createdByUser).subscribe(),this.userSubscription=this.userQuery.selectEntity(this.flTask.createdByUser).subscribe(Y=>{Y&&(this.user=Y)}))}openTask(){console.log("Called openTask"),this.flTask&&!this.disabled&&(console.log("Called openTask inside"),this.router.navigate([`/view/task/${this.flTask.id}`]))}hasAssociatedRequests(){var Y;return!!(null===(Y=this.flTask)||void 0===Y?void 0:Y.requests)&&this.flTask.requests.length>0}hasAssociatedMilestone(){var Y;return!!(null===(Y=this.flTask)||void 0===Y?void 0:Y.associatedMilestone)}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}}return K.\u0275fac=function(Y){return new(Y||K)(c.Y36(L.F0),c.Y36(se.T),c.Y36(z.o))},K.\u0275cmp=c.Xpm({type:K,selectors:[["app-task-list-item"]],inputs:{flTask:"flTask",disabled:"disabled",size:"size"},decls:3,vars:3,consts:[["class","req-list-item-body",3,"click",4,"ngIf"],["class","rlth-minsize",3,"click",4,"ngIf"],[1,"req-list-item-body",3,"click"],[1,"req-list-item-header"],[1,"rlth-time"],["nzType","circle",1,"rlth-time-icon",3,"nzStrokeColor","nzPercent","nzWidth"],[1,"rlth-time-div"],[1,"rlth-time-text"],[1,"rlth-time-user"],[1,"rlth-status"],[3,"status"],[1,"material-symbols-rounded","rlth-options-span"],["class","req-list-item-container",3,"MarkdownContentParser",4,"ngIf"],[1,"req-list-item-container",3,"MarkdownContentParser"],["class","rlth-time-text",3,"MarkdownContentParser",4,"ngIf"],["class","rlth-time-user",4,"ngIf"],[1,"req-list-item-footer"],[1,"rlth-time-user","rlth-time-user-row"],[3,"size",4,"ngIf"],[1,"rlth-time-text",3,"MarkdownContentParser"],[3,"size"],[1,"material-symbols-rounded","rlth-icon"],[1,"rlth-minsize",3,"click"],[1,"milestone-content"],["class","rlth-title",3,"MarkdownContentParser",4,"ngIf"],[1,"rlth-date"],[1,"rlth-title",3,"MarkdownContentParser"]],template:function(Y,Ce){1&Y&&(c.YNc(0,ge,17,10,"div",0),c.YNc(1,ce,13,8,"div",0),c.YNc(2,J,8,7,"div",1)),2&Y&&(c.Q6J("ngIf",!Ce.size&&Ce.flTask&&!1),c.xp6(1),c.Q6J("ngIf",!Ce.size&&Ce.flTask),c.xp6(1),c.Q6J("ngIf",Ce.size&&Ce.flTask))},directives:[N.O5,H.M,W,F.J,j.gx],pipes:[N.uU],styles:[".req-list-item-body[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;font-size:1rem}.req-list-item-header[_ngcontent-%COMP%]{flex:1;display:flex}.req-list-item-container[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;white-space:break-spaces;font-size:1rem;padding:12px 0 6px}.rlth-time[_ngcontent-%COMP%]{display:flex;flex:3;align-items:flex-start;height:100%}.rlth-time-icon[_ngcontent-%COMP%]{max-width:40px;max-height:40px;background-color:#f5f5f5;border-radius:50%;margin-right:8px;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;height:28px;margin:auto}.rlth-time-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-self:center;max-width:100%;font-size:1rem}.rlth-time-div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;align-self:flex-start}.rlth-time-text[_ngcontent-%COMP%]{font-weight:500;font-size:1rem;text-transform:capitalize}.rlth-time-user[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color);overflow:hidden;margin-top:3px}.rlth-time-value[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color)}.rlth-status[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;justify-content:flex-end;max-width:50%;column-gap:4px}.rlth-status-span[_ngcontent-%COMP%]{font-size:1rem;background-color:#efd0dd;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;border-radius:25px;color:#ad1457}.rli-start[_ngcontent-%COMP%], .rli-end[_ngcontent-%COMP%]{display:flex;flex:1}.rli-start[_ngcontent-%COMP%]{justify-content:flex-start}.rli-end[_ngcontent-%COMP%]{justify-content:flex-end}.rli-end[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{justify-content:flex-end}button[_ngcontent-%COMP%]{border-radius:15px;padding:1px 8px;border:1px solid transparent;align-self:flex-start;position:relative;background-color:var(--dim-bg-color)}button[_ngcontent-%COMP%] > .dot[_ngcontent-%COMP%]{position:absolute;right:-4px;top:-9px;min-width:13px;max-width:25px;height:14px;border-radius:20px;background-color:#108ee9;padding:0 4%;color:#fff;font-size:10px}.rlth-time-user-row[_ngcontent-%COMP%]{display:flex}"]}),K})()},3455:(Te,me,v)=>{v.d(me,{l:()=>N});var c=v(655),L=v(9458),se=v(5e3),z=v(7564);let N=class extends L.Gv{constructor(W){super(W),this.store=W,this.$milestones=this.selectAll(),this.$milestoneCount=this.selectCount()}getMilestonesByStatus(W){return"All"===W?this.selectAll():this.selectAll({filterBy:F=>F.status===W})}getMilestonesByStatusCount(W){return"All"===W?this.selectCount():this.selectCount(F=>F.status===W)}};N.\u0275fac=function(W){return new(W||N)(se.LFG(z.w))},N.\u0275prov=se.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N=(0,c.gn)([(0,L.xR)({sortBy:"updatedAt",sortByOrder:L.KM.DESC})],N)},9033:(Te,me,v)=>{v.d(me,{l:()=>N});var c=v(914),L=v(5e3),se=v(7564),z=v(3616);let N=(()=>{class H extends c.Hb{constructor(F,j){super(F),this.store=F,this.authQuery=j,this.appConfig={headers:{Authorization:`Bearer ${this.authQuery.jwtToken}`}},this.authQuery.$jwtToken.subscribe(ue=>this.appConfig={headers:{Authorization:`Bearer ${ue}`}})}getall(){return this.get({params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}getOne(F){return this.get(F,{params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}addMilestone(F){return this.add(Object.assign(Object.assign({},F),{data:F}),this.appConfig).subscribe()}deleteMilestone(F){return this.delete(F,this.appConfig).subscribe()}updateMilestone(F,j){return this.update(F,{data:j},this.appConfig).subscribe()}}return H.\u0275fac=function(F){return new(F||H)(L.LFG(se.w),L.LFG(z.i))},H.\u0275prov=L.Yz7({token:H,factory:H.\u0275fac,providedIn:"root"}),H})()},7564:(Te,me,v)=>{v.d(me,{w:()=>z});var c=v(655),L=v(9458),se=v(5e3);let z=class extends L.cf{constructor(){super()}};z.\u0275fac=function(H){return new(H||z)},z.\u0275prov=se.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z=(0,c.gn)([(0,L.yC)({name:"milestones"})],z)},6832:(Te,me,v)=>{v.d(me,{Z:()=>N});var c=v(655),L=v(9458),se=v(5e3),z=v(6580);let N=class extends L.Gv{constructor(W){super(W),this.store=W,this.$requests=this.selectAll(),this.$openRequests=this.selectAll({filterBy:F=>"Open"===F.status}),this.$closeRequests=this.selectAll({filterBy:F=>"Close"===F.status}),this.$requestCount=this.selectCount(),this.$openRequestsCount=this.selectCount(F=>"Open"===F.status),this.$closeRequestsCount=this.selectCount(F=>"Close"===F.status)}getRequestsByStatus(W){return"Open"===W?this.$openRequests:"Close"===W?this.$closeRequests:this.$requests}getRequestsByStatusCount(W){return"Open"===W?this.$openRequestsCount:"Close"===W?this.$closeRequestsCount:this.$requestCount}};N.\u0275fac=function(W){return new(W||N)(se.LFG(z.y))},N.\u0275prov=se.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N=(0,c.gn)([(0,L.xR)({sortBy:"updatedAt",sortByOrder:L.KM.DESC})],N)},6335:(Te,me,v)=>{v.d(me,{P:()=>N});var c=v(914),L=v(5e3),se=v(6580),z=v(3616);let N=(()=>{class H extends c.Hb{constructor(F,j){super(F),this.store=F,this.authQuery=j,this.appConfig={headers:{Authorization:`Bearer ${this.authQuery.jwtToken}`}},this.authQuery.$jwtToken.subscribe(ue=>this.appConfig={headers:{Authorization:`Bearer ${ue}`}})}getall(){return this.get({params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}getOne(F){return this.get(F,{params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}addRequest(F){return this.add(Object.assign(Object.assign({},F),{data:F}),this.appConfig).subscribe()}deleteRequest(F){return this.delete(F,this.appConfig).subscribe()}updateRequest(F,j){return this.update(F,{data:{content:j.content,rawContent:j.rawContent,category:j.category,severity:j.severity,status:j.status,module:j.module,associatedTasks:j.associatedTasks,createdByUser:j.createdByUser}},this.appConfig).subscribe()}}return H.\u0275fac=function(F){return new(F||H)(L.LFG(se.y),L.LFG(z.i))},H.\u0275prov=L.Yz7({token:H,factory:H.\u0275fac,providedIn:"root"}),H})()},6580:(Te,me,v)=>{v.d(me,{y:()=>z});var c=v(655),L=v(9458),se=v(5e3);let z=class extends L.cf{constructor(){super()}};z.\u0275fac=function(H){return new(H||z)},z.\u0275prov=se.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z=(0,c.gn)([(0,L.yC)({name:"requests"})],z)},3616:(Te,me,v)=>{v.d(me,{i:()=>z});var c=v(9458),L=v(5e3),se=v(4277);let z=(()=>{class N extends c.Gv{constructor(W){super(W),this.store=W,this.jwtToken="",this.isLoggedIn=""!=this.jwtToken,this.$jwtToken=this.select("jwt"),this.$authUser=this.select("user"),this.$accessToken=this.select("accessToken"),this.$jwtToken.subscribe(F=>{this.jwtToken=F,this.isLoggedIn=""!=this.jwtToken}),this.$authUser.subscribe(F=>this.user=F)}}return N.\u0275fac=function(W){return new(W||N)(L.LFG(se.C))},N.\u0275prov=L.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},4419:(Te,me,v)=>{v.d(me,{R:()=>N});var c=v(655),L=v(9458),se=v(5e3),z=v(1790);let N=class extends L.Gv{constructor(W){super(W),this.store=W,this.$tasks=this.selectAll(),this.$taskCount=this.selectCount()}getTasksByStatus(W){return"All"===W?this.selectAll():this.selectAll({filterBy:F=>F.status===W})}getTasksByStatusCount(W){return"All"===W?this.selectCount():this.selectCount(F=>F.status===W)}};N.\u0275fac=function(W){return new(W||N)(se.LFG(z.N))},N.\u0275prov=se.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N=(0,c.gn)([(0,L.xR)({sortBy:"updatedAt",sortByOrder:L.KM.DESC})],N)},6101:(Te,me,v)=>{v.d(me,{Y:()=>N});var c=v(914),L=v(5e3),se=v(1790),z=v(3616);let N=(()=>{class H extends c.Hb{constructor(F,j){super(F),this.store=F,this.authQuery=j,this.appConfig={headers:{Authorization:`Bearer ${this.authQuery.jwtToken}`}},this.authQuery.$jwtToken.subscribe(ue=>this.appConfig={headers:{Authorization:`Bearer ${ue}`}})}getall(){return console.log("Called get in FlTaskService"),this.get({params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}getOne(F){return console.log("Called get in FlTaskService"),this.get(F,{params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}addTask(F){return this.add(Object.assign(Object.assign({},F),{data:F}),this.appConfig).subscribe()}deleteTask(F){return this.delete(F,this.appConfig).subscribe()}updateTask(F,j){return this.update(F,{data:j},this.appConfig).subscribe()}}return H.\u0275fac=function(F){return new(F||H)(L.LFG(se.N),L.LFG(z.i))},H.\u0275prov=L.Yz7({token:H,factory:H.\u0275fac,providedIn:"root"}),H})()},1790:(Te,me,v)=>{v.d(me,{N:()=>z});var c=v(655),L=v(9458),se=v(5e3);let z=class extends L.cf{constructor(){super()}};z.\u0275fac=function(H){return new(H||z)},z.\u0275prov=se.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z=(0,c.gn)([(0,L.yC)({name:"tasks"})],z)},6819:(Te,me,v)=>{v.d(me,{o:()=>z});var c=v(9458),L=v(5e3),se=v(3557);let z=(()=>{class N extends c.Gv{constructor(W){super(W),this.store=W,console.log("USER QUERY")}}return N.\u0275fac=function(W){return new(W||N)(L.LFG(se.X))},N.\u0275prov=L.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},4817:(Te,me,v)=>{v.d(me,{z:()=>se});var c=v(5e3),L=v(9565);let se=(()=>{class z{constructor(H){this.navigation=H}onClick(){this.navigation.back()}}return z.\u0275fac=function(H){return new(H||z)(c.Y36(L.f))},z.\u0275dir=c.lG2({type:z,selectors:[["","appBackButton",""]],hostBindings:function(H,W){1&H&&c.NdJ("click",function(){return W.onClick()})}}),z})()},4112:(Te,me,v)=>{v.d(me,{J:()=>ge});var c=v(6956),L=v(412),se=v(8197),z=v(3981),N=v(5e3),H=v(7465);v(8769);const j={group:"inline",inline:!0,atom:!0,attrs:{tag:{},type:{}},selectable:!1,draggable:!1,toDOM:V=>["a",{class:"tag",tag:V.attrs.tag},"#"+V.attrs.tag]},ue={group:"inline",inline:!0,atom:!0,attrs:{name:{},email:{},id:{}},selectable:!1,draggable:!1,toDOM:V=>["a",{class:"mention",mention:V.attrs.name},"@"+V.attrs.name]};let ge=(()=>{class V{constructor(te,ae){this.element=te,this.global=ae,this.customSchema=new se.V_({nodes:z.fK.spec.nodes.append({mention:ue,tag:j}),marks:z.fK.spec.marks})}ngOnChanges(te){te.content&&te.content.currentValue&&(this.editorView?this.editorView.updateState(c.yy.fromJSON({schema:this.customSchema},te.content.currentValue)):this.editorView||(this.editorView=new L.tk(this.element.nativeElement,{state:c.yy.fromJSON({schema:this.customSchema},this.content),editable:()=>!1})))}ngAfterViewInit(){if(this.content&&!this.editorView&&(this.editorView=new L.tk(this.element.nativeElement,{state:c.yy.fromJSON({schema:this.customSchema},this.content),editable:()=>!1})),!this.editorView)return;let te=this.editorView.dom.querySelectorAll(".tag"),ae=this.editorView.dom.querySelectorAll(".mention");(te.length>0||ae.length>0)&&(te.forEach(ie=>{ie.addEventListener("click",ce=>{let de=ie.getAttribute("tag");ce.stopPropagation(),this.global.navigatToSearch(de)})}),ae.forEach(ie=>{ie.addEventListener("click",ce=>{let de=ie.getAttribute("mention");ce.stopPropagation(),this.global.navigatToSearch(de)})}))}}return V.\u0275fac=function(te){return new(te||V)(N.Y36(N.SBq),N.Y36(H.U))},V.\u0275dir=N.lG2({type:V,selectors:[["","MarkdownContentParser",""]],inputs:{content:["MarkdownContentParser","content"]},features:[N.TTD]}),V})()},5513:(Te,me,v)=>{v.d(me,{I:()=>H});var z=(()=>{return(W=z||(z={})).Issue="Issue",W.FeatureRequest="Feature",W.Feedback="Feedback",z;var W})(),N=v(5e3);let H=(()=>{class W{transform(j){return j==z.Feedback?"assets/fl-feedback.png":j==z.FeatureRequest?"assets/fl-feature.png":j==z.Issue?"assets/fl-issue.png":"assets/"+j}}return W.\u0275fac=function(j){return new(j||W)},W.\u0275pipe=N.Yjl({name:"categoryImgPath",type:W,pure:!0}),W})()},8793:(Te,me,v)=>{v.d(me,{$:()=>L});var c=v(5e3);let L=(()=>{class se{constructor(){this.entities=["Request","Task","Milestone"],this.categories=["Issue","Feature","Feedback"],this.severities=["ShowStopper","Critical","Major","Minor"],this.modules=["Grid","Canvas","Explorer","Widgets","Data Panel","IDE Client","IDE Server","Style Panel","Route","Offline"],this.requestStatus=["Open","Close"],this.taskPriorites=["Urgent","High","Medium","Low"],this.taskStatus=["Yet To Start","In Discussion","In Progress","Completed","Testing","Released"],this.milestoneStatus=["Yet To Start","In Discussion","In Progress","Completed","Testing","Released"]}}return se.\u0275fac=function(N){return new(N||se)},se.\u0275prov=c.Yz7({token:se,factory:se.\u0275fac,providedIn:"root"}),se})()},7465:(Te,me,v)=>{v.d(me,{U:()=>ue});var c=v(9826),L=v(8197),se=v(3981),z=v(5e3),N=v(8793);const H=v(8769),{addMentionNodes:F}=H;let ue=(()=>{class ge{constructor(oe,te){this.router=oe,this.fields=te,this.selectedIndex=0,this.isSearching=!1,this.url="",this.showMenu=!1,this.entity="Request",this.requestTagArray=[],this.taskTagArray=[],this.milestoneTagArray=[],this.requestSubFilterList=["All","Open","Close"],this.taskSubFilterList=["All","Yet To Start","In Discussion","In Progress","Completed","Testing","Released"],this.searchFilterList=["Requests","Tasks","Milestones"],this.milestoneSubFilterList=["All","Yet To Start","In Discussion","In Progress","Completed","Testing","Released"],this.customSchema=new L.V_({nodes:F(F(se.fK.spec.nodes)),marks:se.fK.spec.marks}),this.mentionArray=[{name:"IlayaSelvaGanesh",id:"101",email:"ilaya@gmail.com"},{name:"SanthoshBalaji",id:"102",email:"santhosh@gmail.com"},{name:"Dhivya",id:"103",email:"dhivya@gmail.com"},{name:"Ramya",id:"104",email:"ramya@gmail.com"},{name:"Sathya",id:"104",email:"sathya@gmail.com"},{name:"Murali",id:"105",email:"murali@gmail.com"}],this.tagArray=[{tag:"ShowStopper",type:"Severity"},{tag:"Critical",type:"Severity"},{tag:"Major",type:"Severity"},{tag:"Minor",type:"Severity"},{tag:"Grid",type:"Module"},{tag:"Issue",type:"Category"},{tag:"Feature",type:"Category"},{tag:"Feedback",type:"Category"}],oe.events.subscribe(ae=>{ae instanceof c.m2&&(this.url=ae.url)}),this.fields.categories.forEach(ae=>{this.requestTagArray.push({type:"Category",tag:ae})}),this.fields.severities.forEach(ae=>{this.requestTagArray.push({type:"Severity",tag:ae})}),this.fields.modules.forEach(ae=>{this.requestTagArray.push({type:"Module",tag:ae}),this.taskTagArray.push({type:"Module",tag:ae})}),this.fields.taskPriorites.forEach(ae=>{this.taskTagArray.push({type:"Priority",tag:ae})}),this.fields.taskStatus.forEach(ae=>{this.taskTagArray.push({type:"Status",tag:ae}),this.milestoneTagArray.push({type:"Status",tag:ae})})}getFilterListFromEntity(oe){switch(oe){case"request":return this.requestSubFilterList;case"task":return this.taskSubFilterList;case"search":return this.searchFilterList;case"milestone":return this.milestoneSubFilterList;default:return[]}return[]}navigatToSearch(oe){null==event||event.stopPropagation(),this.router.navigate([`/home/search/${oe}`])}}return ge.\u0275fac=function(oe){return new(oe||ge)(z.LFG(c.F0),z.LFG(N.$))},ge.\u0275prov=z.Yz7({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge})()},9565:(Te,me,v)=>{v.d(me,{f:()=>z});var c=v(9826),L=v(5e3),se=v(9808);let z=(()=>{class N{constructor(W,F){this.router=W,this.location=F,this.history=[],this.history.push(this.router.url),this.router.events.subscribe(j=>{j instanceof c.m2&&this.history.push(j.urlAfterRedirects)})}back(){this.history.pop(),this.history.length>0?this.location.back():this.router.navigateByUrl("/")}}return N.\u0275fac=function(W){return new(W||N)(L.LFG(c.F0),L.LFG(se.Ye))},N.\u0275prov=L.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},8769:(Te,me,v)=>{v.r(me),v.d(me,{addMentionNodes:()=>ue,addTagNodes:()=>ge,getMentionsPlugin:()=>W,mentionNode:()=>F,tagNode:()=>j});var c=v(6956),L=v(412);const N=(V=null,function(oe,te,ae){return ae=ae||this,clearTimeout(V),V=setTimeout(function(){oe.apply(ae,arguments)},te),V});var V;function W(te){te=Object.assign({},{mentionTrigger:"@",hashtagTrigger:"#",allowSpace:!0,getSuggestions:(he,ne,ye)=>{ye([])},getSuggestionsHTML:he=>'<div class="suggestion-item-list">'+he.map(ne=>'<div class="suggestion-item">'+ne.name+"</div>").join("")+"</div>",activeClass:"suggestion-item-active",suggestionTextClass:"prosemirror-suggestion",maxNoOfSuggestions:10,delay:500},te);var ae=null,ie=document.createElement("div"),de=function(){ie.style.display="none"},J=function(he,ne){ie.querySelector(".suggestion-item-list").childNodes[he].classList.remove(ne)},$=function(he,ne){ie.querySelector(".suggestion-item-list").childNodes[he].classList.add(ne)},K=function(he,ne,ye){J(ne.index,ye.activeClass),ne.index=he,$(ne.index,ye.activeClass)},Ce=function(he,ne,ye){var Oe=ne.suggestions[ne.index],G=he.state.schema.nodes[ne.type].create("mention"===ne.type?{name:Oe.name,id:Oe.id,email:Oe.email}:{tag:Oe.tag}),M=he.state.tr.replaceWith(ne.range.from,ne.range.to,G);he.dispatch(M)};return new c.Sy({key:new c.H$("autosuggestions"),state:{init:()=>({active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0}),apply(he,ne){var ye={active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0},Oe=he.selection;if(Oe.from!==Oe.to)return ye;const G=function z(V,oe){var te=V.before();const ae=V.doc.textBetween(te,V.pos,"\n","\0");var $,ie=function se(V,oe,te){return{mention:te?new RegExp("(^|\\s)"+V+"([\\w-\\+]+\\s?[\\w-\\+]*)$"):new RegExp("(^|\\s)"+V+"([\\w-\\+]+)$"),tag:new RegExp("(^|\\s)"+oe+"([\\w-]+)$")}}(oe.mentionTrigger,oe.hashtagTrigger,oe.allowSpace),ce=ae.match(ie.mention),de=ae.match(ie.tag),J=ce||de;if(ce?$="mention":de&&($="tag"),J){J.index=J[0].startsWith(" ")?J.index+1:J.index,J[0]=J[0].startsWith(" ")?J[0].substring(1,J[0].length):J[0];var K=V.start()+J.index;return{range:{from:K,to:K+J[0].length},queryText:J[2],type:$}}}(Oe.$from,te);return G&&(ye.active=!0,ye.range=G.range,ye.type=G.type,ye.text=G.queryText),ye}},props:{handleKeyDown(he,ne){var Se,G,M,ye=this.getState(he.state);return!(!ye.active&&!ye.suggestions.length||(G=13===ne.keyCode,Se=38===ne.keyCode,M=27===ne.keyCode,40===ne.keyCode?(function(he,ne,ye){J(ne.index,ye.activeClass),ne.index++,ne.index=ne.index===ne.suggestions.length?0:ne.index,$(ne.index,ye.activeClass)}(0,ye,te),0):Se?(function(he,ne,ye){J(ne.index,ye.activeClass),ne.index--,ne.index=-1===ne.index?ne.suggestions.length-1:ne.index,$(ne.index,ye.activeClass)}(0,ye,te),0):G?(Ce(he,ye),0):!M||(clearTimeout(ae),de(),this.state={active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0},0)))},decorations(he){const{active:ne,range:ye}=this.getState(he);return ne?L.EH.create(he.doc,[L.p.inline(ye.from,ye.to,{nodeName:"span",class:te.suggestionTextClass})]):null}},view(){return{update:he=>{var ne=this.key.getState(he.state);if(!ne.text)return de(),void clearTimeout(ae);ae=N(function(){te.getSuggestions(ne.type,ne.text,function(ye){ne.suggestions=ye,function(he,ne,ye,Oe){ie.innerHTML=Oe.getSuggestionsHTML(ye,ne.type),ie.querySelectorAll(".suggestion-item").forEach(function(q,ee){q.addEventListener("click",function(){Ce(he,ne),he.focus()}),q.addEventListener("mouseover",function(){K(ee,ne,Oe)}),q.addEventListener("mouseout",function(){K(ee,ne,Oe)})}),$(ne.index,Oe.activeClass);var M=he.domAtPos(he.state.selection.$from.pos).node.querySelector("."+Oe.suggestionTextClass),E=M.getBoundingClientRect();document.body.appendChild(ie),ie.classList.add("suggestion-item-container"),ie.style.position="fixed",ie.style.left=E.left+"px",ie.style.top=M.offsetHeight+E.top+"px",ie.style.display="block",ie.style.zIndex="999999"}(he,ne,ye,te)})},te.delay,this)}}}})}const F={group:"inline",inline:!0,atom:!0,attrs:{id:"",name:"",email:""},selectable:!1,draggable:!1,toDOM:V=>["span",{"data-mention-id":V.attrs.id,"data-mention-name":V.attrs.name,"data-mention-email":V.attrs.email,class:"prosemirror-mention-node"},"@"+V.attrs.name||0],parseDOM:[{tag:"span[data-mention-id][data-mention-name][data-mention-email]",getAttrs:V=>({id:V.getAttribute("data-mention-id"),name:V.getAttribute("data-mention-name"),email:V.getAttribute("data-mention-email")})}]},j={group:"inline",inline:!0,atom:!0,attrs:{tag:""},selectable:!1,draggable:!1,toDOM:V=>["span",{"data-tag":V.attrs.tag,class:"prosemirror-tag-node"},"#"+V.attrs.tag],parseDOM:[{tag:"span[data-tag]",getAttrs:V=>({tag:V.getAttribute("data-tag")})}]};function ue(V){return V.append({mention:F})}function ge(V){return V.append({tag:j})}},8197:(Te,me,v)=>{function c(x){this.content=x}v.d(me,{aw:()=>Fe,PW:()=>X,HY:()=>N,vc:()=>j,ZU:()=>Ne,NB:()=>G,Ts:()=>Oe,e4:()=>ue,V_:()=>Mt,p2:()=>ge}),c.prototype={constructor:c,find:function(x){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===x)return i;return-1},get:function(x){var i=this.find(x);return-1==i?void 0:this.content[i+1]},update:function(x,i,s){var a=s&&s!=x?this.remove(s):this,f=a.find(x),m=a.content.slice();return-1==f?m.push(s||x,i):(m[f+1]=i,s&&(m[f]=s)),new c(m)},remove:function(x){var i=this.find(x);if(-1==i)return this;var s=this.content.slice();return s.splice(i,2),new c(s)},addToStart:function(x,i){return new c([x,i].concat(this.remove(x).content))},addToEnd:function(x,i){var s=this.remove(x).content.slice();return s.push(x,i),new c(s)},addBefore:function(x,i,s){var a=this.remove(i),f=a.content.slice(),m=a.find(x);return f.splice(-1==m?f.length:m,0,i,s),new c(f)},forEach:function(x){for(var i=0;i<this.content.length;i+=2)x(this.content[i],this.content[i+1])},prepend:function(x){return(x=c.from(x)).size?new c(x.content.concat(this.subtract(x).content)):this},append:function(x){return(x=c.from(x)).size?new c(this.subtract(x).content.concat(x.content)):this},subtract:function(x){var i=this;x=c.from(x);for(var s=0;s<x.content.length;s+=2)i=i.remove(x.content[s]);return i},get size(){return this.content.length>>1}},c.from=function(x){if(x instanceof c)return x;var i=[];if(x)for(var s in x)i.push(s,x[s]);return new c(i)};const L=c;function se(x,i,s){for(let a=0;;a++){if(a==x.childCount||a==i.childCount)return x.childCount==i.childCount?null:s;let f=x.child(a),m=i.child(a);if(f!=m){if(!f.sameMarkup(m))return s;if(f.isText&&f.text!=m.text){for(let k=0;f.text[k]==m.text[k];k++)s++;return s}if(f.content.size||m.content.size){let k=se(f.content,m.content,s+1);if(null!=k)return k}s+=f.nodeSize}else s+=f.nodeSize}}function z(x,i,s,a){for(let f=x.childCount,m=i.childCount;;){if(0==f||0==m)return f==m?null:{a:s,b:a};let k=x.child(--f),D=i.child(--m),w=k.nodeSize;if(k!=D){if(!k.sameMarkup(D))return{a:s,b:a};if(k.isText&&k.text!=D.text){let le=0,pe=Math.min(k.text.length,D.text.length);for(;le<pe&&k.text[k.text.length-le-1]==D.text[D.text.length-le-1];)le++,s--,a--;return{a:s,b:a}}if(k.content.size||D.content.size){let le=z(k.content,D.content,s-1,a-1);if(le)return le}s-=w,a-=w}else s-=w,a-=w}}class N{constructor(i,s){if(this.content=i,this.size=s||0,null==s)for(let a=0;a<i.length;a++)this.size+=i[a].nodeSize}nodesBetween(i,s,a,f=0,m){for(let k=0,D=0;D<s;k++){let w=this.content[k],le=D+w.nodeSize;if(le>i&&!1!==a(w,f+D,m||null,k)&&w.content.size){let pe=D+1;w.nodesBetween(Math.max(0,i-pe),Math.min(w.content.size,s-pe),a,f+pe)}D=le}}descendants(i){this.nodesBetween(0,this.size,i)}textBetween(i,s,a,f){let m="",k=!0;return this.nodesBetween(i,s,(D,w)=>{D.isText?(m+=D.text.slice(Math.max(i,w)-w,s-w),k=!a):D.isLeaf?(f?m+="function"==typeof f?f(D):f:D.type.spec.leafText&&(m+=D.type.spec.leafText(D)),k=!a):!k&&D.isBlock&&(m+=a,k=!0)},0),m}append(i){if(!i.size)return this;if(!this.size)return i;let s=this.lastChild,a=i.firstChild,f=this.content.slice(),m=0;for(s.isText&&s.sameMarkup(a)&&(f[f.length-1]=s.withText(s.text+a.text),m=1);m<i.content.length;m++)f.push(i.content[m]);return new N(f,this.size+i.size)}cut(i,s=this.size){if(0==i&&s==this.size)return this;let a=[],f=0;if(s>i)for(let m=0,k=0;k<s;m++){let D=this.content[m],w=k+D.nodeSize;w>i&&((k<i||w>s)&&(D=D.isText?D.cut(Math.max(0,i-k),Math.min(D.text.length,s-k)):D.cut(Math.max(0,i-k-1),Math.min(D.content.size,s-k-1))),a.push(D),f+=D.nodeSize),k=w}return new N(a,f)}cutByIndex(i,s){return i==s?N.empty:0==i&&s==this.content.length?this:new N(this.content.slice(i,s))}replaceChild(i,s){let a=this.content[i];if(a==s)return this;let f=this.content.slice(),m=this.size+s.nodeSize-a.nodeSize;return f[i]=s,new N(f,m)}addToStart(i){return new N([i].concat(this.content),this.size+i.nodeSize)}addToEnd(i){return new N(this.content.concat(i),this.size+i.nodeSize)}eq(i){if(this.content.length!=i.content.length)return!1;for(let s=0;s<this.content.length;s++)if(!this.content[s].eq(i.content[s]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(i){let s=this.content[i];if(!s)throw new RangeError("Index "+i+" out of range for "+this);return s}maybeChild(i){return this.content[i]||null}forEach(i){for(let s=0,a=0;s<this.content.length;s++){let f=this.content[s];i(f,a,s),a+=f.nodeSize}}findDiffStart(i,s=0){return se(this,i,s)}findDiffEnd(i,s=this.size,a=i.size){return z(this,i,s,a)}findIndex(i,s=-1){if(0==i)return W(0,i);if(i==this.size)return W(this.content.length,i);if(i>this.size||i<0)throw new RangeError(`Position ${i} outside of fragment (${this})`);for(let a=0,f=0;;a++){let k=f+this.child(a).nodeSize;if(k>=i)return k==i||s>0?W(a+1,k):W(a,f);f=k}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(i=>i.toJSON()):null}static fromJSON(i,s){if(!s)return N.empty;if(!Array.isArray(s))throw new RangeError("Invalid input for Fragment.fromJSON");return new N(s.map(i.nodeFromJSON))}static fromArray(i){if(!i.length)return N.empty;let s,a=0;for(let f=0;f<i.length;f++){let m=i[f];a+=m.nodeSize,f&&m.isText&&i[f-1].sameMarkup(m)?(s||(s=i.slice(0,f)),s[s.length-1]=m.withText(s[s.length-1].text+m.text)):s&&s.push(m)}return new N(s||i,a)}static from(i){if(!i)return N.empty;if(i instanceof N)return i;if(Array.isArray(i))return this.fromArray(i);if(i.attrs)return new N([i],i.nodeSize);throw new RangeError("Can not convert "+i+" to a Fragment"+(i.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}N.empty=new N([],0);const H={index:0,offset:0};function W(x,i){return H.index=x,H.offset=i,H}function F(x,i){if(x===i)return!0;if(!x||"object"!=typeof x||!i||"object"!=typeof i)return!1;let s=Array.isArray(x);if(Array.isArray(i)!=s)return!1;if(s){if(x.length!=i.length)return!1;for(let a=0;a<x.length;a++)if(!F(x[a],i[a]))return!1}else{for(let a in x)if(!(a in i)||!F(x[a],i[a]))return!1;for(let a in i)if(!(a in x))return!1}return!0}let j=(()=>{class x{constructor(s,a){this.type=s,this.attrs=a}addToSet(s){let a,f=!1;for(let m=0;m<s.length;m++){let k=s[m];if(this.eq(k))return s;if(this.type.excludes(k.type))a||(a=s.slice(0,m));else{if(k.type.excludes(this.type))return s;!f&&k.type.rank>this.type.rank&&(a||(a=s.slice(0,m)),a.push(this),f=!0),a&&a.push(k)}}return a||(a=s.slice()),f||a.push(this),a}removeFromSet(s){for(let a=0;a<s.length;a++)if(this.eq(s[a]))return s.slice(0,a).concat(s.slice(a+1));return s}isInSet(s){for(let a=0;a<s.length;a++)if(this.eq(s[a]))return!0;return!1}eq(s){return this==s||this.type==s.type&&F(this.attrs,s.attrs)}toJSON(){let s={type:this.type.name};for(let a in this.attrs){s.attrs=this.attrs;break}return s}static fromJSON(s,a){if(!a)throw new RangeError("Invalid input for Mark.fromJSON");let f=s.marks[a.type];if(!f)throw new RangeError(`There is no mark type ${a.type} in this schema`);return f.create(a.attrs)}static sameSet(s,a){if(s==a)return!0;if(s.length!=a.length)return!1;for(let f=0;f<s.length;f++)if(!s[f].eq(a[f]))return!1;return!0}static setFrom(s){if(!s||Array.isArray(s)&&0==s.length)return x.none;if(s instanceof x)return[s];let a=s.slice();return a.sort((f,m)=>f.type.rank-m.type.rank),a}}return x.none=[],x})();class ue extends Error{}class ge{constructor(i,s,a){this.content=i,this.openStart=s,this.openEnd=a}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(i,s){let a=oe(this.content,i+this.openStart,s);return a&&new ge(a,this.openStart,this.openEnd)}removeBetween(i,s){return new ge(V(this.content,i+this.openStart,s+this.openStart),this.openStart,this.openEnd)}eq(i){return this.content.eq(i.content)&&this.openStart==i.openStart&&this.openEnd==i.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let i={content:this.content.toJSON()};return this.openStart>0&&(i.openStart=this.openStart),this.openEnd>0&&(i.openEnd=this.openEnd),i}static fromJSON(i,s){if(!s)return ge.empty;let a=s.openStart||0,f=s.openEnd||0;if("number"!=typeof a||"number"!=typeof f)throw new RangeError("Invalid input for Slice.fromJSON");return new ge(N.fromJSON(i,s.content),a,f)}static maxOpen(i,s=!0){let a=0,f=0;for(let m=i.firstChild;m&&!m.isLeaf&&(s||!m.type.spec.isolating);m=m.firstChild)a++;for(let m=i.lastChild;m&&!m.isLeaf&&(s||!m.type.spec.isolating);m=m.lastChild)f++;return new ge(i,a,f)}}function V(x,i,s){let{index:a,offset:f}=x.findIndex(i),m=x.maybeChild(a),{index:k,offset:D}=x.findIndex(s);if(f==i||m.isText){if(D!=s&&!x.child(k).isText)throw new RangeError("Removing non-flat range");return x.cut(0,i).append(x.cut(s))}if(a!=k)throw new RangeError("Removing non-flat range");return x.replaceChild(a,m.copy(V(m.content,i-f-1,s-f-1)))}function oe(x,i,s,a){let{index:f,offset:m}=x.findIndex(i),k=x.maybeChild(f);if(m==i||k.isText)return a&&!a.canReplace(f,f,s)?null:x.cut(0,i).append(s).append(x.cut(i));let D=oe(k.content,i-m-1,s);return D&&x.replaceChild(f,k.copy(D))}function te(x,i,s){if(s.openStart>x.depth)throw new ue("Inserted content deeper than insertion position");if(x.depth-s.openStart!=i.depth-s.openEnd)throw new ue("Inconsistent open depths");return ae(x,i,s,0)}function ae(x,i,s,a){let f=x.index(a),m=x.node(a);if(f==i.index(a)&&a<x.depth-s.openStart){let k=ae(x,i,s,a+1);return m.copy(m.content.replaceChild(f,k))}if(s.content.size){if(s.openStart||s.openEnd||x.depth!=a||i.depth!=a){let{start:k,end:D}=function Y(x,i){let s=i.depth-x.openStart,f=i.node(s).copy(x.content);for(let m=s-1;m>=0;m--)f=i.node(m).copy(N.from(f));return{start:f.resolveNoCache(x.openStart+s),end:f.resolveNoCache(f.content.size-x.openEnd-s)}}(s,x);return $(m,K(x,k,D,i,a))}{let k=x.parent,D=k.content;return $(k,D.cut(0,x.parentOffset).append(s.content).append(D.cut(i.parentOffset)))}}return $(m,Z(x,i,a))}function ie(x,i){if(!i.type.compatibleContent(x.type))throw new ue("Cannot join "+i.type.name+" onto "+x.type.name)}function ce(x,i,s){let a=x.node(s);return ie(a,i.node(s)),a}function de(x,i){let s=i.length-1;s>=0&&x.isText&&x.sameMarkup(i[s])?i[s]=x.withText(i[s].text+x.text):i.push(x)}function J(x,i,s,a){let f=(i||x).node(s),m=0,k=i?i.index(s):f.childCount;x&&(m=x.index(s),x.depth>s?m++:x.textOffset&&(de(x.nodeAfter,a),m++));for(let D=m;D<k;D++)de(f.child(D),a);i&&i.depth==s&&i.textOffset&&de(i.nodeBefore,a)}function $(x,i){if(!x.type.validContent(i))throw new ue("Invalid content for node "+x.type.name);return x.copy(i)}function K(x,i,s,a,f){let m=x.depth>f&&ce(x,i,f+1),k=a.depth>f&&ce(s,a,f+1),D=[];return J(null,x,f,D),m&&k&&i.index(f)==s.index(f)?(ie(m,k),de($(m,K(x,i,s,a,f+1)),D)):(m&&de($(m,Z(x,i,f+1)),D),J(i,s,f,D),k&&de($(k,Z(s,a,f+1)),D)),J(a,null,f,D),new N(D)}function Z(x,i,s){let a=[];return J(null,x,s,a),x.depth>s&&de($(ce(x,i,s+1),Z(x,i,s+1)),a),J(i,null,s,a),new N(a)}ge.empty=new ge(N.empty,0,0);class Ce{constructor(i,s,a){this.pos=i,this.path=s,this.parentOffset=a,this.depth=s.length/3-1}resolveDepth(i){return null==i?this.depth:i<0?this.depth+i:i}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(i){return this.path[3*this.resolveDepth(i)]}index(i){return this.path[3*this.resolveDepth(i)+1]}indexAfter(i){return i=this.resolveDepth(i),this.index(i)+(i!=this.depth||this.textOffset?1:0)}start(i){return 0==(i=this.resolveDepth(i))?0:this.path[3*i-1]+1}end(i){return i=this.resolveDepth(i),this.start(i)+this.node(i).content.size}before(i){if(!(i=this.resolveDepth(i)))throw new RangeError("There is no position before the top-level node");return i==this.depth+1?this.pos:this.path[3*i-1]}after(i){if(!(i=this.resolveDepth(i)))throw new RangeError("There is no position after the top-level node");return i==this.depth+1?this.pos:this.path[3*i-1]+this.path[3*i].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let i=this.parent,s=this.index(this.depth);if(s==i.childCount)return null;let a=this.pos-this.path[this.path.length-1],f=i.child(s);return a?i.child(s).cut(a):f}get nodeBefore(){let i=this.index(this.depth),s=this.pos-this.path[this.path.length-1];return s?this.parent.child(i).cut(0,s):0==i?null:this.parent.child(i-1)}posAtIndex(i,s){s=this.resolveDepth(s);let a=this.path[3*s],f=0==s?0:this.path[3*s-1]+1;for(let m=0;m<i;m++)f+=a.child(m).nodeSize;return f}marks(){let i=this.parent,s=this.index();if(0==i.content.size)return j.none;if(this.textOffset)return i.child(s).marks;let a=i.maybeChild(s-1),f=i.maybeChild(s);if(!a){let D=a;a=f,f=D}let m=a.marks;for(var k=0;k<m.length;k++)!1===m[k].type.spec.inclusive&&(!f||!m[k].isInSet(f.marks))&&(m=m[k--].removeFromSet(m));return m}marksAcross(i){let s=this.parent.maybeChild(this.index());if(!s||!s.isInline)return null;let a=s.marks,f=i.parent.maybeChild(i.index());for(var m=0;m<a.length;m++)!1===a[m].type.spec.inclusive&&(!f||!a[m].isInSet(f.marks))&&(a=a[m--].removeFromSet(a));return a}sharedDepth(i){for(let s=this.depth;s>0;s--)if(this.start(s)<=i&&this.end(s)>=i)return s;return 0}blockRange(i=this,s){if(i.pos<this.pos)return i.blockRange(this);for(let a=this.depth-(this.parent.inlineContent||this.pos==i.pos?1:0);a>=0;a--)if(i.pos<=this.end(a)&&(!s||s(this.node(a))))return new Oe(this,i,a);return null}sameParent(i){return this.pos-this.parentOffset==i.pos-i.parentOffset}max(i){return i.pos>this.pos?i:this}min(i){return i.pos<this.pos?i:this}toString(){let i="";for(let s=1;s<=this.depth;s++)i+=(i?"/":"")+this.node(s).type.name+"_"+this.index(s-1);return i+":"+this.parentOffset}static resolve(i,s){if(!(s>=0&&s<=i.content.size))throw new RangeError("Position "+s+" out of range");let a=[],f=0,m=s;for(let k=i;;){let{index:D,offset:w}=k.content.findIndex(m),le=m-w;if(a.push(k,D,f+w),!le||(k=k.child(D),k.isText))break;m=le-1,f+=w+1}return new Ce(s,a,m)}static resolveCached(i,s){for(let f=0;f<he.length;f++){let m=he[f];if(m.pos==s&&m.doc==i)return m}let a=he[ne]=Ce.resolve(i,s);return ne=(ne+1)%ye,a}}let he=[],ne=0,ye=12;class Oe{constructor(i,s,a){this.$from=i,this.$to=s,this.depth=a}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Se=Object.create(null);class G{constructor(i,s,a,f=j.none){this.type=i,this.attrs=s,this.marks=f,this.content=a||N.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(i){return this.content.child(i)}maybeChild(i){return this.content.maybeChild(i)}forEach(i){this.content.forEach(i)}nodesBetween(i,s,a,f=0){this.content.nodesBetween(i,s,a,f,this)}descendants(i){this.nodesBetween(0,this.content.size,i)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(i,s,a,f){return this.content.textBetween(i,s,a,f)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(i){return this==i||this.sameMarkup(i)&&this.content.eq(i.content)}sameMarkup(i){return this.hasMarkup(i.type,i.attrs,i.marks)}hasMarkup(i,s,a){return this.type==i&&F(this.attrs,s||i.defaultAttrs||Se)&&j.sameSet(this.marks,a||j.none)}copy(i=null){return i==this.content?this:new G(this.type,this.attrs,i,this.marks)}mark(i){return i==this.marks?this:new G(this.type,this.attrs,this.content,i)}cut(i,s=this.content.size){return 0==i&&s==this.content.size?this:this.copy(this.content.cut(i,s))}slice(i,s=this.content.size,a=!1){if(i==s)return ge.empty;let f=this.resolve(i),m=this.resolve(s),k=a?0:f.sharedDepth(s),D=f.start(k),le=f.node(k).content.cut(f.pos-D,m.pos-D);return new ge(le,f.depth-k,m.depth-k)}replace(i,s,a){return te(this.resolve(i),this.resolve(s),a)}nodeAt(i){for(let s=this;;){let{index:a,offset:f}=s.content.findIndex(i);if(s=s.maybeChild(a),!s)return null;if(f==i||s.isText)return s;i-=f+1}}childAfter(i){let{index:s,offset:a}=this.content.findIndex(i);return{node:this.content.maybeChild(s),index:s,offset:a}}childBefore(i){if(0==i)return{node:null,index:0,offset:0};let{index:s,offset:a}=this.content.findIndex(i);if(a<i)return{node:this.content.child(s),index:s,offset:a};let f=this.content.child(s-1);return{node:f,index:s-1,offset:a-f.nodeSize}}resolve(i){return Ce.resolveCached(this,i)}resolveNoCache(i){return Ce.resolve(this,i)}rangeHasMark(i,s,a){let f=!1;return s>i&&this.nodesBetween(i,s,m=>(a.isInSet(m.marks)&&(f=!0),!f)),f}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let i=this.type.name;return this.content.size&&(i+="("+this.content.toStringInner()+")"),E(this.marks,i)}contentMatchAt(i){let s=this.type.contentMatch.matchFragment(this.content,0,i);if(!s)throw new Error("Called contentMatchAt on a node with invalid content");return s}canReplace(i,s,a=N.empty,f=0,m=a.childCount){let k=this.contentMatchAt(i).matchFragment(a,f,m),D=k&&k.matchFragment(this.content,s);if(!D||!D.validEnd)return!1;for(let w=f;w<m;w++)if(!this.type.allowsMarks(a.child(w).marks))return!1;return!0}canReplaceWith(i,s,a,f){if(f&&!this.type.allowsMarks(f))return!1;let m=this.contentMatchAt(i).matchType(a),k=m&&m.matchFragment(this.content,s);return!!k&&k.validEnd}canAppend(i){return i.content.size?this.canReplace(this.childCount,this.childCount,i.content):this.type.compatibleContent(i.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let i=j.none;for(let s=0;s<this.marks.length;s++)i=this.marks[s].addToSet(i);if(!j.sameSet(i,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(s=>s.type.name)}`);this.content.forEach(s=>s.check())}toJSON(){let i={type:this.type.name};for(let s in this.attrs){i.attrs=this.attrs;break}return this.content.size&&(i.content=this.content.toJSON()),this.marks.length&&(i.marks=this.marks.map(s=>s.toJSON())),i}static fromJSON(i,s){if(!s)throw new RangeError("Invalid input for Node.fromJSON");let a=null;if(s.marks){if(!Array.isArray(s.marks))throw new RangeError("Invalid mark data for Node.fromJSON");a=s.marks.map(i.markFromJSON)}if("text"==s.type){if("string"!=typeof s.text)throw new RangeError("Invalid text node in JSON");return i.text(s.text,a)}let f=N.fromJSON(i,s.content);return i.nodeType(s.type).create(s.attrs,f,a)}}G.prototype.text=void 0;class M extends G{constructor(i,s,a,f){if(super(i,s,null,f),!a)throw new RangeError("Empty text nodes are not allowed");this.text=a}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):E(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(i,s){return this.text.slice(i,s)}get nodeSize(){return this.text.length}mark(i){return i==this.marks?this:new M(this.type,this.attrs,this.text,i)}withText(i){return i==this.text?this:new M(this.type,this.attrs,i,this.marks)}cut(i=0,s=this.text.length){return 0==i&&s==this.text.length?this:this.withText(this.text.slice(i,s))}eq(i){return this.sameMarkup(i)&&this.text==i.text}toJSON(){let i=super.toJSON();return i.text=this.text,i}}function E(x,i){for(let s=x.length-1;s>=0;s--)i=x[s].type.name+"("+i+")";return i}class P{constructor(i){this.validEnd=i,this.next=[],this.wrapCache=[]}static parse(i,s){let a=new q(i,s);if(null==a.next)return P.empty;let f=ee(a);a.next&&a.err("Unexpected trailing text");let m=function dt(x){let i=Object.create(null);return function s(a){let f=[];a.forEach(k=>{x[k].forEach(({term:D,to:w})=>{if(!D)return;let le;for(let pe=0;pe<f.length;pe++)f[pe][0]==D&&(le=f[pe][1]);nt(x,w).forEach(pe=>{le||f.push([D,le=[]]),-1==le.indexOf(pe)&&le.push(pe)})})});let m=i[a.join(",")]=new P(a.indexOf(x.length-1)>-1);for(let k=0;k<f.length;k++){let D=f[k][1].sort(ht);m.next.push({type:f[k][0],next:i[D.join(",")]||s(D)})}return m}(nt(x,0))}(function Je(x){let i=[[]];return f(function m(k,D){if("choice"==k.type)return k.exprs.reduce((w,le)=>w.concat(m(le,D)),[]);if("seq"!=k.type){if("star"==k.type){let w=s();return a(D,w),f(m(k.expr,w),w),[a(w)]}if("plus"==k.type){let w=s();return f(m(k.expr,D),w),f(m(k.expr,w),w),[a(w)]}if("opt"==k.type)return[a(D)].concat(m(k.expr,D));if("range"==k.type){let w=D;for(let le=0;le<k.min;le++){let pe=s();f(m(k.expr,w),pe),w=pe}if(-1==k.max)f(m(k.expr,w),w);else for(let le=k.min;le<k.max;le++){let pe=s();a(w,pe),f(m(k.expr,w),pe),w=pe}return[a(w)]}if("name"==k.type)return[a(D,void 0,k.value)];throw new Error("Unknown expr type")}for(let w=0;;w++){let le=m(k.exprs[w],D);if(w==k.exprs.length-1)return le;f(le,D=s())}}(x,0),s()),i;function s(){return i.push([])-1}function a(k,D,w){let le={term:w,to:D};return i[k].push(le),le}function f(k,D){k.forEach(w=>w.to=D)}}(f));return function je(x,i){for(let s=0,a=[x];s<a.length;s++){let f=a[s],m=!f.validEnd,k=[];for(let D=0;D<f.next.length;D++){let{type:w,next:le}=f.next[D];k.push(w.name),m&&!(w.isText||w.hasRequiredAttrs())&&(m=!1),-1==a.indexOf(le)&&a.push(le)}m&&i.err("Only non-generatable nodes ("+k.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(m,a),m}matchType(i){for(let s=0;s<this.next.length;s++)if(this.next[s].type==i)return this.next[s].next;return null}matchFragment(i,s=0,a=i.childCount){let f=this;for(let m=s;f&&m<a;m++)f=f.matchType(i.child(m).type);return f}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let i=0;i<this.next.length;i++){let{type:s}=this.next[i];if(!s.isText&&!s.hasRequiredAttrs())return s}return null}compatible(i){for(let s=0;s<this.next.length;s++)for(let a=0;a<i.next.length;a++)if(this.next[s].type==i.next[a].type)return!0;return!1}fillBefore(i,s=!1,a=0){let f=[this];return function m(k,D){let w=k.matchFragment(i,a);if(w&&(!s||w.validEnd))return N.from(D.map(le=>le.createAndFill()));for(let le=0;le<k.next.length;le++){let{type:pe,next:Re}=k.next[le];if(!pe.isText&&!pe.hasRequiredAttrs()&&-1==f.indexOf(Re)){f.push(Re);let rt=m(Re,D.concat(pe));if(rt)return rt}}return null}(this,[])}findWrapping(i){for(let a=0;a<this.wrapCache.length;a+=2)if(this.wrapCache[a]==i)return this.wrapCache[a+1];let s=this.computeWrapping(i);return this.wrapCache.push(i,s),s}computeWrapping(i){let s=Object.create(null),a=[{match:this,type:null,via:null}];for(;a.length;){let f=a.shift(),m=f.match;if(m.matchType(i)){let k=[];for(let D=f;D.type;D=D.via)k.push(D.type);return k.reverse()}for(let k=0;k<m.next.length;k++){let{type:D,next:w}=m.next[k];!D.isLeaf&&!D.hasRequiredAttrs()&&!(D.name in s)&&(!f.type||w.validEnd)&&(a.push({match:D.contentMatch,type:D,via:f}),s[D.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(i){if(i>=this.next.length)throw new RangeError(`There's no ${i}th edge in this content match`);return this.next[i]}toString(){let i=[];return function s(a){i.push(a);for(let f=0;f<a.next.length;f++)-1==i.indexOf(a.next[f].next)&&s(a.next[f].next)}(this),i.map((a,f)=>{let m=f+(a.validEnd?"*":" ")+" ";for(let k=0;k<a.next.length;k++)m+=(k?", ":"")+a.next[k].type.name+"->"+i.indexOf(a.next[k].next);return m}).join("\n")}}P.empty=new P(!0);class q{constructor(i,s){this.string=i,this.nodeTypes=s,this.inline=null,this.pos=0,this.tokens=i.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(i){return this.next==i&&(this.pos++||!0)}err(i){throw new SyntaxError(i+" (in content expression '"+this.string+"')")}}function ee(x){let i=[];do{i.push(xe(x))}while(x.eat("|"));return 1==i.length?i[0]:{type:"choice",exprs:i}}function xe(x){let i=[];do{i.push(_e(x))}while(x.next&&")"!=x.next&&"|"!=x.next);return 1==i.length?i[0]:{type:"seq",exprs:i}}function _e(x){let i=function qe(x){if(x.eat("(")){let i=ee(x);return x.eat(")")||x.err("Missing closing paren"),i}if(!/\W/.test(x.next)){let i=function De(x,i){let s=x.nodeTypes,a=s[i];if(a)return[a];let f=[];for(let m in s){let k=s[m];k.groups.indexOf(i)>-1&&f.push(k)}return 0==f.length&&x.err("No node type or group '"+i+"' found"),f}(x,x.next).map(s=>(null==x.inline?x.inline=s.isInline:x.inline!=s.isInline&&x.err("Mixing inline and block content"),{type:"name",value:s}));return x.pos++,1==i.length?i[0]:{type:"choice",exprs:i}}x.err("Unexpected token '"+x.next+"'")}(x);for(;;)if(x.eat("+"))i={type:"plus",expr:i};else if(x.eat("*"))i={type:"star",expr:i};else if(x.eat("?"))i={type:"opt",expr:i};else{if(!x.eat("{"))break;i=Pe(x,i)}return i}function Ee(x){/\D/.test(x.next)&&x.err("Expected number, got '"+x.next+"'");let i=Number(x.next);return x.pos++,i}function Pe(x,i){let s=Ee(x),a=s;return x.eat(",")&&(a="}"!=x.next?Ee(x):-1),x.eat("}")||x.err("Unclosed braced range"),{type:"range",min:s,max:a,expr:i}}function ht(x,i){return i-x}function nt(x,i){let s=[];return function a(f){let m=x[f];if(1==m.length&&!m[0].term)return a(m[0].to);s.push(f);for(let k=0;k<m.length;k++){let{term:D,to:w}=m[k];!D&&-1==s.indexOf(w)&&a(w)}}(i),s.sort(ht)}function ut(x){let i=Object.create(null);for(let s in x){let a=x[s];if(!a.hasDefault)return null;i[s]=a.default}return i}function Ke(x,i){let s=Object.create(null);for(let a in x){let f=i&&i[a];if(void 0===f){let m=x[a];if(!m.hasDefault)throw new RangeError("No value supplied for attribute "+a);f=m.default}s[a]=f}return s}function Ye(x){let i=Object.create(null);if(x)for(let s in x)i[s]=new ft(x[s]);return i}class Ue{constructor(i,s,a){this.name=i,this.schema=s,this.spec=a,this.markSet=null,this.groups=a.group?a.group.split(" "):[],this.attrs=Ye(a.attrs),this.defaultAttrs=ut(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(a.inline||"text"==i),this.isText="text"==i}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==P.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let i in this.attrs)if(this.attrs[i].isRequired)return!0;return!1}compatibleContent(i){return this==i||this.contentMatch.compatible(i.contentMatch)}computeAttrs(i){return!i&&this.defaultAttrs?this.defaultAttrs:Ke(this.attrs,i)}create(i=null,s,a){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new G(this,this.computeAttrs(i),N.from(s),j.setFrom(a))}createChecked(i=null,s,a){if(s=N.from(s),!this.validContent(s))throw new RangeError("Invalid content for node "+this.name);return new G(this,this.computeAttrs(i),s,j.setFrom(a))}createAndFill(i=null,s,a){if(i=this.computeAttrs(i),(s=N.from(s)).size){let k=this.contentMatch.fillBefore(s);if(!k)return null;s=k.append(s)}let f=this.contentMatch.matchFragment(s),m=f&&f.fillBefore(N.empty,!0);return m?new G(this,i,s.append(m),j.setFrom(a)):null}validContent(i){let s=this.contentMatch.matchFragment(i);if(!s||!s.validEnd)return!1;for(let a=0;a<i.childCount;a++)if(!this.allowsMarks(i.child(a).marks))return!1;return!0}allowsMarkType(i){return null==this.markSet||this.markSet.indexOf(i)>-1}allowsMarks(i){if(null==this.markSet)return!0;for(let s=0;s<i.length;s++)if(!this.allowsMarkType(i[s].type))return!1;return!0}allowedMarks(i){if(null==this.markSet)return i;let s;for(let a=0;a<i.length;a++)this.allowsMarkType(i[a].type)?s&&s.push(i[a]):s||(s=i.slice(0,a));return s?s.length?s:j.none:i}static compile(i,s){let a=Object.create(null);i.forEach((m,k)=>a[m]=new Ue(m,s,k));let f=s.spec.topNode||"doc";if(!a[f])throw new RangeError("Schema is missing its top node type ('"+f+"')");if(!a.text)throw new RangeError("Every schema needs a 'text' type");for(let m in a.text.attrs)throw new RangeError("The text node type should not have attributes");return a}}class ft{constructor(i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default}get isRequired(){return!this.hasDefault}}class Ne{constructor(i,s,a,f){this.name=i,this.rank=s,this.schema=a,this.spec=f,this.attrs=Ye(f.attrs),this.excluded=null;let m=ut(this.attrs);this.instance=m?new j(this,m):null}create(i=null){return!i&&this.instance?this.instance:new j(this,Ke(this.attrs,i))}static compile(i,s){let a=Object.create(null),f=0;return i.forEach((m,k)=>a[m]=new Ne(m,f++,s,k)),a}removeFromSet(i){for(var s=0;s<i.length;s++)i[s].type==this&&(i=i.slice(0,s).concat(i.slice(s+1)),s--);return i}isInSet(i){for(let s=0;s<i.length;s++)if(i[s].type==this)return i[s]}excludes(i){return this.excluded.indexOf(i)>-1}}class Mt{constructor(i){this.cached=Object.create(null),this.spec={nodes:L.from(i.nodes),marks:L.from(i.marks||{}),topNode:i.topNode},this.nodes=Ue.compile(this.spec.nodes,this),this.marks=Ne.compile(this.spec.marks,this);let s=Object.create(null);for(let a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");let f=this.nodes[a],m=f.spec.content||"",k=f.spec.marks;f.contentMatch=s[m]||(s[m]=P.parse(m,this.nodes)),f.inlineContent=f.contentMatch.inlineContent,f.markSet="_"==k?null:k?it(this,k.split(" ")):""!=k&&f.inlineContent?null:[]}for(let a in this.marks){let f=this.marks[a],m=f.spec.excludes;f.excluded=null==m?[f]:""==m?[]:it(this,m.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(i,s=null,a,f){if("string"==typeof i)i=this.nodeType(i);else{if(!(i instanceof Ue))throw new RangeError("Invalid node type: "+i);if(i.schema!=this)throw new RangeError("Node type from different schema used ("+i.name+")")}return i.createChecked(s,a,f)}text(i,s){let a=this.nodes.text;return new M(a,a.defaultAttrs,i,j.setFrom(s))}mark(i,s){return"string"==typeof i&&(i=this.marks[i]),i.create(s)}nodeFromJSON(i){return G.fromJSON(this,i)}markFromJSON(i){return j.fromJSON(this,i)}nodeType(i){let s=this.nodes[i];if(!s)throw new RangeError("Unknown node type: "+i);return s}}function it(x,i){let s=[];for(let a=0;a<i.length;a++){let f=i[a],m=x.marks[f],k=m;if(m)s.push(m);else for(let D in x.marks){let w=x.marks[D];("_"==f||w.spec.group&&w.spec.group.split(" ").indexOf(f)>-1)&&s.push(k=w)}if(!k)throw new SyntaxError("Unknown mark type: '"+i[a]+"'")}return s}class Fe{constructor(i,s){this.schema=i,this.rules=s,this.tags=[],this.styles=[],s.forEach(a=>{a.tag?this.tags.push(a):a.style&&this.styles.push(a)}),this.normalizeLists=!this.tags.some(a=>{if(!/^(ul|ol)\b/.test(a.tag)||!a.node)return!1;let f=i.nodes[a.node];return f.contentMatch.matchType(f)})}parse(i,s={}){let a=new p(this,s,!1);return a.addAll(i,s.from,s.to),a.finish()}parseSlice(i,s={}){let a=new p(this,s,!0);return a.addAll(i,s.from,s.to),ge.maxOpen(a.finish())}matchTag(i,s,a){for(let f=a?this.tags.indexOf(a)+1:0;f<this.tags.length;f++){let m=this.tags[f];if(C(i,m.tag)&&(void 0===m.namespace||i.namespaceURI==m.namespace)&&(!m.context||s.matchesContext(m.context))){if(m.getAttrs){let k=m.getAttrs(i);if(!1===k)continue;m.attrs=k||void 0}return m}}}matchStyle(i,s,a,f){for(let m=f?this.styles.indexOf(f)+1:0;m<this.styles.length;m++){let k=this.styles[m],D=k.style;if(!(0!=D.indexOf(i)||k.context&&!a.matchesContext(k.context)||D.length>i.length&&(61!=D.charCodeAt(i.length)||D.slice(i.length+1)!=s))){if(k.getAttrs){let w=k.getAttrs(s);if(!1===w)continue;k.attrs=w||void 0}return k}}}static schemaRules(i){let s=[];function a(f){let m=null==f.priority?50:f.priority,k=0;for(;k<s.length;k++){let D=s[k];if((null==D.priority?50:D.priority)<m)break}s.splice(k,0,f)}for(let f in i.marks){let m=i.marks[f].spec.parseDOM;m&&m.forEach(k=>{a(k=T(k)),k.mark=f})}for(let f in i.nodes){let m=i.nodes[f].spec.parseDOM;m&&m.forEach(k=>{a(k=T(k)),k.node=f})}return s}static fromSchema(i){return i.cached.domParser||(i.cached.domParser=new Fe(i,Fe.schemaRules(i)))}}const He={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},pt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},mt={ol:!0,ul:!0};function S(x,i,s){return null!=i?(i?1:0)|("full"===i?2:0):x&&"pre"==x.whitespace?3:-5&s}class d{constructor(i,s,a,f,m,k,D){this.type=i,this.attrs=s,this.marks=a,this.pendingMarks=f,this.solid=m,this.options=D,this.content=[],this.activeMarks=j.none,this.stashMarks=[],this.match=k||(4&D?null:i.contentMatch)}findWrapping(i){if(!this.match){if(!this.type)return[];let s=this.type.contentMatch.fillBefore(N.from(i));if(!s){let f,a=this.type.contentMatch;return(f=a.findWrapping(i.type))?(this.match=a,f):null}this.match=this.type.contentMatch.matchFragment(s)}return this.match.findWrapping(i.type)}finish(i){if(!(1&this.options)){let f,a=this.content[this.content.length-1];if(a&&a.isText&&(f=/[ \t\r\n\u000c]+$/.exec(a.text))){let m=a;a.text.length==f[0].length?this.content.pop():this.content[this.content.length-1]=m.withText(m.text.slice(0,m.text.length-f[0].length))}}let s=N.from(this.content);return!i&&this.match&&(s=s.append(this.match.fillBefore(N.empty,!0))),this.type?this.type.create(this.attrs,s,this.marks):s}popFromStashMark(i){for(let s=this.stashMarks.length-1;s>=0;s--)if(i.eq(this.stashMarks[s]))return this.stashMarks.splice(s,1)[0]}applyPending(i){for(let s=0,a=this.pendingMarks;s<a.length;s++){let f=a[s];(this.type?this.type.allowsMarkType(f.type):I(f.type,i))&&!f.isInSet(this.activeMarks)&&(this.activeMarks=f.addToSet(this.activeMarks),this.pendingMarks=f.removeFromSet(this.pendingMarks))}}inlineContext(i){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:i.parentNode&&!He.hasOwnProperty(i.parentNode.nodeName.toLowerCase())}}class p{constructor(i,s,a){this.parser=i,this.options=s,this.isOpen=a,this.open=0;let m,f=s.topNode,k=S(null,s.preserveWhitespace,0)|(a?4:0);m=f?new d(f.type,f.attrs,j.none,j.none,!0,s.topMatch||f.type.contentMatch,k):new d(a?null:i.schema.topNodeType,null,j.none,j.none,!0,null,k),this.nodes=[m],this.find=s.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(i){if(3==i.nodeType)this.addTextNode(i);else if(1==i.nodeType){let s=i.getAttribute("style"),a=s?this.readStyles(function b(x){let s,i=/\s*([\w-]+)\s*:\s*([^;]+)/g,a=[];for(;s=i.exec(x);)a.push(s[1],s[2].trim());return a}(s)):null,f=this.top;if(null!=a)for(let m=0;m<a.length;m++)this.addPendingMark(a[m]);if(this.addElement(i),null!=a)for(let m=0;m<a.length;m++)this.removePendingMark(a[m],f)}}addTextNode(i){let s=i.nodeValue,a=this.top;if(2&a.options||a.inlineContext(i)||/[^ \t\r\n\u000c]/.test(s)){if(1&a.options)s=2&a.options?s.replace(/\r\n?/g,"\n"):s.replace(/\r?\n|\r/g," ");else if(s=s.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(s)&&this.open==this.nodes.length-1){let f=a.content[a.content.length-1],m=i.previousSibling;(!f||m&&"BR"==m.nodeName||f.isText&&/[ \t\r\n\u000c]$/.test(f.text))&&(s=s.slice(1))}s&&this.insertNode(this.parser.schema.text(s)),this.findInText(i)}else this.findInside(i)}addElement(i,s){let f,a=i.nodeName.toLowerCase();mt.hasOwnProperty(a)&&this.parser.normalizeLists&&function y(x){for(let i=x.firstChild,s=null;i;i=i.nextSibling){let a=1==i.nodeType?i.nodeName.toLowerCase():null;a&&mt.hasOwnProperty(a)&&s?(s.appendChild(i),i=s):"li"==a?s=i:a&&(s=null)}}(i);let m=this.options.ruleFromNode&&this.options.ruleFromNode(i)||(f=this.parser.matchTag(i,this,s));if(m?m.ignore:pt.hasOwnProperty(a))this.findInside(i),this.ignoreFallback(i);else if(!m||m.skip||m.closeParent){m&&m.closeParent?this.open=Math.max(0,this.open-1):m&&m.skip.nodeType&&(i=m.skip);let k,D=this.top,w=this.needsBlock;if(He.hasOwnProperty(a))k=!0,D.type||(this.needsBlock=!0);else if(!i.firstChild)return void this.leafFallback(i);this.addAll(i),k&&this.sync(D),this.needsBlock=w}else this.addElementByRule(i,m,!1===m.consuming?f:void 0)}leafFallback(i){"BR"==i.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(i.ownerDocument.createTextNode("\n"))}ignoreFallback(i){"BR"==i.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(i){let s=j.none;e:for(let a=0;a<i.length;a+=2)for(let f;;){let m=this.parser.matchStyle(i[a],i[a+1],this,f);if(!m)continue e;if(m.ignore)return null;if(s=this.parser.schema.marks[m.mark].create(m.attrs).addToSet(s),!1!==m.consuming)break;f=m}return s}addElementByRule(i,s,a){let f,m,k;s.node?(m=this.parser.schema.nodes[s.node],m.isLeaf?this.insertNode(m.create(s.attrs))||this.leafFallback(i):f=this.enter(m,s.attrs||null,s.preserveWhitespace)):(k=this.parser.schema.marks[s.mark].create(s.attrs),this.addPendingMark(k));let D=this.top;if(m&&m.isLeaf)this.findInside(i);else if(a)this.addElement(i,a);else if(s.getContent)this.findInside(i),s.getContent(i,this.parser.schema).forEach(w=>this.insertNode(w));else{let w=i;"string"==typeof s.contentElement?w=i.querySelector(s.contentElement):"function"==typeof s.contentElement?w=s.contentElement(i):s.contentElement&&(w=s.contentElement),this.findAround(i,w,!0),this.addAll(w)}f&&this.sync(D)&&this.open--,k&&this.removePendingMark(k,D)}addAll(i,s,a){let f=s||0;for(let m=s?i.childNodes[s]:i.firstChild,k=null==a?null:i.childNodes[a];m!=k;m=m.nextSibling,++f)this.findAtPoint(i,f),this.addDOM(m);this.findAtPoint(i,f)}findPlace(i){let s,a;for(let f=this.open;f>=0;f--){let m=this.nodes[f],k=m.findWrapping(i);if(k&&(!s||s.length>k.length)&&(s=k,a=m,!k.length)||m.solid)break}if(!s)return!1;this.sync(a);for(let f=0;f<s.length;f++)this.enterInner(s[f],null,!1);return!0}insertNode(i){if(i.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&this.enterInner(s)}if(this.findPlace(i)){this.closeExtra();let s=this.top;s.applyPending(i.type),s.match&&(s.match=s.match.matchType(i.type));let a=s.activeMarks;for(let f=0;f<i.marks.length;f++)(!s.type||s.type.allowsMarkType(i.marks[f].type))&&(a=i.marks[f].addToSet(a));return s.content.push(i.mark(a)),!0}return!1}enter(i,s,a){let f=this.findPlace(i.create(s));return f&&this.enterInner(i,s,!0,a),f}enterInner(i,s=null,a=!1,f){this.closeExtra();let m=this.top;m.applyPending(i),m.match=m.match&&m.match.matchType(i);let k=S(i,f,m.options);4&m.options&&0==m.content.length&&(k|=4),this.nodes.push(new d(i,s,m.activeMarks,m.pendingMarks,a,null,k)),this.open++}closeExtra(i=!1){let s=this.nodes.length-1;if(s>this.open){for(;s>this.open;s--)this.nodes[s-1].content.push(this.nodes[s].finish(i));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(i){for(let s=this.open;s>=0;s--)if(this.nodes[s]==i)return this.open=s,!0;return!1}get currentPos(){this.closeExtra();let i=0;for(let s=this.open;s>=0;s--){let a=this.nodes[s].content;for(let f=a.length-1;f>=0;f--)i+=a[f].nodeSize;s&&i++}return i}findAtPoint(i,s){if(this.find)for(let a=0;a<this.find.length;a++)this.find[a].node==i&&this.find[a].offset==s&&(this.find[a].pos=this.currentPos)}findInside(i){if(this.find)for(let s=0;s<this.find.length;s++)null==this.find[s].pos&&1==i.nodeType&&i.contains(this.find[s].node)&&(this.find[s].pos=this.currentPos)}findAround(i,s,a){if(i!=s&&this.find)for(let f=0;f<this.find.length;f++)null==this.find[f].pos&&1==i.nodeType&&i.contains(this.find[f].node)&&s.compareDocumentPosition(this.find[f].node)&(a?2:4)&&(this.find[f].pos=this.currentPos)}findInText(i){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].node==i&&(this.find[s].pos=this.currentPos-(i.nodeValue.length-this.find[s].offset))}matchesContext(i){if(i.indexOf("|")>-1)return i.split(/\s*\|\s*/).some(this.matchesContext,this);let s=i.split("/"),a=this.options.context,f=!(this.isOpen||a&&a.parent.type!=this.nodes[0].type),m=(f?0:1)-(a?a.depth+1:0),k=(D,w)=>{for(;D>=0;D--){let le=s[D];if(""==le){if(D==s.length-1||0==D)continue;for(;w>=m;w--)if(k(D-1,w))return!0;return!1}{let pe=w>0||0==w&&f?this.nodes[w].type:a&&w>=m?a.node(w-m).type:null;if(!pe||pe.name!=le&&-1==pe.groups.indexOf(le))return!1;w--}}return!0};return k(s.length-1,this.open)}textblockFromContext(){let i=this.options.context;if(i)for(let s=i.depth;s>=0;s--){let a=i.node(s).contentMatchAt(i.indexAfter(s)).defaultType;if(a&&a.isTextblock&&a.defaultAttrs)return a}for(let s in this.parser.schema.nodes){let a=this.parser.schema.nodes[s];if(a.isTextblock&&a.defaultAttrs)return a}}addPendingMark(i){let s=function U(x,i){for(let s=0;s<i.length;s++)if(x.eq(i[s]))return i[s]}(i,this.top.pendingMarks);s&&this.top.stashMarks.push(s),this.top.pendingMarks=i.addToSet(this.top.pendingMarks)}removePendingMark(i,s){for(let a=this.open;a>=0;a--){let f=this.nodes[a];if(f.pendingMarks.lastIndexOf(i)>-1)f.pendingMarks=i.removeFromSet(f.pendingMarks);else{f.activeMarks=i.removeFromSet(f.activeMarks);let k=f.popFromStashMark(i);k&&f.type&&f.type.allowsMarkType(k.type)&&(f.activeMarks=k.addToSet(f.activeMarks))}if(f==s)break}}}function C(x,i){return(x.matches||x.msMatchesSelector||x.webkitMatchesSelector||x.mozMatchesSelector).call(x,i)}function T(x){let i={};for(let s in x)i[s]=x[s];return i}function I(x,i){let s=i.schema.nodes;for(let a in s){let f=s[a];if(!f.allowsMarkType(x))continue;let m=[],k=D=>{m.push(D);for(let w=0;w<D.edgeCount;w++){let{type:le,next:pe}=D.edge(w);if(le==i||m.indexOf(pe)<0&&k(pe))return!0}};if(k(f.contentMatch))return!0}}class X{constructor(i,s){this.nodes=i,this.marks=s}serializeFragment(i,s={},a){a||(a=fe(s).createDocumentFragment());let f=a,m=[];return i.forEach(k=>{if(m.length||k.marks.length){let D=0,w=0;for(;D<m.length&&w<k.marks.length;){let le=k.marks[w];if(this.marks[le.type.name]){if(!le.eq(m[D][0])||!1===le.type.spec.spanning)break;D++,w++}else w++}for(;D<m.length;)f=m.pop()[1];for(;w<k.marks.length;){let le=k.marks[w++],pe=this.serializeMark(le,k.isInline,s);pe&&(m.push([le,f]),f.appendChild(pe.dom),f=pe.contentDOM||pe.dom)}}f.appendChild(this.serializeNodeInner(k,s))}),a}serializeNodeInner(i,s){let{dom:a,contentDOM:f}=X.renderSpec(fe(s),this.nodes[i.type.name](i));if(f){if(i.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(i.content,s,f)}return a}serializeNode(i,s={}){let a=this.serializeNodeInner(i,s);for(let f=i.marks.length-1;f>=0;f--){let m=this.serializeMark(i.marks[f],i.isInline,s);m&&((m.contentDOM||m.dom).appendChild(a),a=m.dom)}return a}serializeMark(i,s,a={}){let f=this.marks[i.type.name];return f&&X.renderSpec(fe(a),f(i,s))}static renderSpec(i,s,a=null){if("string"==typeof s)return{dom:i.createTextNode(s)};if(null!=s.nodeType)return{dom:s};if(s.dom&&null!=s.dom.nodeType)return s;let f=s[0],m=f.indexOf(" ");m>0&&(a=f.slice(0,m),f=f.slice(m+1));let k,D=a?i.createElementNS(a,f):i.createElement(f),w=s[1],le=1;if(w&&"object"==typeof w&&null==w.nodeType&&!Array.isArray(w)){le=2;for(let pe in w)if(null!=w[pe]){let Re=pe.indexOf(" ");Re>0?D.setAttributeNS(pe.slice(0,Re),pe.slice(Re+1),w[pe]):D.setAttribute(pe,w[pe])}}for(let pe=le;pe<s.length;pe++){let Re=s[pe];if(0===Re){if(pe<s.length-1||pe>le)throw new RangeError("Content hole must be the only child of its parent node");return{dom:D,contentDOM:D}}{let{dom:rt,contentDOM:Ot}=X.renderSpec(i,Re,a);if(D.appendChild(rt),Ot){if(k)throw new RangeError("Multiple content holes");k=Ot}}}return{dom:D,contentDOM:k}}static fromSchema(i){return i.cached.domSerializer||(i.cached.domSerializer=new X(this.nodesFromSchema(i),this.marksFromSchema(i)))}static nodesFromSchema(i){let s=re(i.nodes);return s.text||(s.text=a=>a.text),s}static marksFromSchema(i){return re(i.marks)}}function re(x){let i={};for(let s in x){let a=x[s].spec.toDOM;a&&(i[s]=a)}return i}function fe(x){return x.document||window.document}},3981:(Te,me,v)=>{v.d(me,{fK:()=>V});var c=v(8197);const L=["p",0],se=["blockquote",0],z=["hr"],N=["pre",["code",0]],H=["br"],F=["em",0],j=["strong",0],ue=["code",0],V=new c.V_({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>L},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>se},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>z},heading:{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:oe=>["h"+oe.attrs.level,0]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>N},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:oe=>({src:oe.getAttribute("src"),title:oe.getAttribute("title"),alt:oe.getAttribute("alt")})}],toDOM(oe){let{src:te,alt:ae,title:ie}=oe.attrs;return["img",{src:te,alt:ae,title:ie}]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>H}},marks:{link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:oe=>({href:oe.getAttribute("href"),title:oe.getAttribute("title")})}],toDOM(oe){let{href:te,title:ae}=oe.attrs;return["a",{href:te,title:ae},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>F},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:oe=>"normal"!=oe.style.fontWeight&&null},{style:"font-weight",getAttrs:oe=>/^(bold(er)?|[5-9]\d{2,})$/.test(oe)&&null}],toDOM:()=>j},code:{parseDOM:[{tag:"code"}],toDOM:()=>ue}}})},6956:(Te,me,v)=>{v.d(me,{Bs:()=>F,C1:()=>V,H$:()=>Se,Sy:()=>ne,Y1:()=>z,qv:()=>ue,yy:()=>Ce});var c=v(8197),L=v(3060);const se=Object.create(null);class z{constructor(M,E,P){this.$anchor=M,this.$head=E,this.ranges=P||[new N(M.min(E),M.max(E))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let M=this.ranges;for(let E=0;E<M.length;E++)if(M[E].$from.pos!=M[E].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(M,E=c.p2.empty){let P=E.content.lastChild,q=null;for(let _e=0;_e<E.openEnd;_e++)q=P,P=P.lastChild;let ee=M.steps.length,xe=this.ranges;for(let _e=0;_e<xe.length;_e++){let{$from:Ee,$to:Pe}=xe[_e],De=M.mapping.slice(ee);M.replaceRange(De.map(Ee.pos),De.map(Pe.pos),_e?c.p2.empty:E),0==_e&&ae(M,ee,(P?P.isInline:q&&q.isTextblock)?-1:1)}}replaceWith(M,E){let P=M.steps.length,q=this.ranges;for(let ee=0;ee<q.length;ee++){let{$from:xe,$to:_e}=q[ee],Ee=M.mapping.slice(P),Pe=Ee.map(xe.pos),De=Ee.map(_e.pos);ee?M.deleteRange(Pe,De):(M.replaceRangeWith(Pe,De,E),ae(M,P,E.isInline?-1:1))}}static findFrom(M,E,P=!1){let q=M.parent.inlineContent?new F(M):te(M.node(0),M.parent,M.pos,M.index(),E,P);if(q)return q;for(let ee=M.depth-1;ee>=0;ee--){let xe=E<0?te(M.node(0),M.node(ee),M.before(ee+1),M.index(ee),E,P):te(M.node(0),M.node(ee),M.after(ee+1),M.index(ee)+1,E,P);if(xe)return xe}return null}static near(M,E=1){return this.findFrom(M,E)||this.findFrom(M,-E)||new V(M.node(0))}static atStart(M){return te(M,M,0,0,1)||new V(M)}static atEnd(M){return te(M,M,M.content.size,M.childCount,-1)||new V(M)}static fromJSON(M,E){if(!E||!E.type)throw new RangeError("Invalid input for Selection.fromJSON");let P=se[E.type];if(!P)throw new RangeError(`No selection type ${E.type} defined`);return P.fromJSON(M,E)}static jsonID(M,E){if(M in se)throw new RangeError("Duplicate use of selection JSON ID "+M);return se[M]=E,E.prototype.jsonID=M,E}getBookmark(){return F.between(this.$anchor,this.$head).getBookmark()}}z.prototype.visible=!0;class N{constructor(M,E){this.$from=M,this.$to=E}}let H=!1;function W(G){!H&&!G.parent.inlineContent&&(H=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+G.parent.type.name+")"))}class F extends z{constructor(M,E=M){W(M),W(E),super(M,E)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(M,E){let P=M.resolve(E.map(this.head));if(!P.parent.inlineContent)return z.near(P);let q=M.resolve(E.map(this.anchor));return new F(q.parent.inlineContent?q:P,P)}replace(M,E=c.p2.empty){if(super.replace(M,E),E==c.p2.empty){let P=this.$from.marksAcross(this.$to);P&&M.ensureMarks(P)}}eq(M){return M instanceof F&&M.anchor==this.anchor&&M.head==this.head}getBookmark(){return new j(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(M,E){if("number"!=typeof E.anchor||"number"!=typeof E.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new F(M.resolve(E.anchor),M.resolve(E.head))}static create(M,E,P=E){let q=M.resolve(E);return new this(q,P==E?q:M.resolve(P))}static between(M,E,P){let q=M.pos-E.pos;if((!P||q)&&(P=q>=0?1:-1),!E.parent.inlineContent){let ee=z.findFrom(E,P,!0)||z.findFrom(E,-P,!0);if(!ee)return z.near(E,P);E=ee.$head}return M.parent.inlineContent||(0==q||(M=(z.findFrom(M,-P,!0)||z.findFrom(M,P,!0)).$anchor).pos<E.pos!=q<0)&&(M=E),new F(M,E)}}z.jsonID("text",F);class j{constructor(M,E){this.anchor=M,this.head=E}map(M){return new j(M.map(this.anchor),M.map(this.head))}resolve(M){return F.between(M.resolve(this.anchor),M.resolve(this.head))}}class ue extends z{constructor(M){let E=M.nodeAfter,P=M.node(0).resolve(M.pos+E.nodeSize);super(M,P),this.node=E}map(M,E){let{deleted:P,pos:q}=E.mapResult(this.anchor),ee=M.resolve(q);return P?z.near(ee):new ue(ee)}content(){return new c.p2(c.HY.from(this.node),0,0)}eq(M){return M instanceof ue&&M.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ge(this.anchor)}static fromJSON(M,E){if("number"!=typeof E.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ue(M.resolve(E.anchor))}static create(M,E){return new ue(M.resolve(E))}static isSelectable(M){return!M.isText&&!1!==M.type.spec.selectable}}ue.prototype.visible=!1,z.jsonID("node",ue);class ge{constructor(M){this.anchor=M}map(M){let{deleted:E,pos:P}=M.mapResult(this.anchor);return E?new j(P,P):new ge(P)}resolve(M){let E=M.resolve(this.anchor),P=E.nodeAfter;return P&&ue.isSelectable(P)?new ue(E):z.near(E)}}class V extends z{constructor(M){super(M.resolve(0),M.resolve(M.content.size))}replace(M,E=c.p2.empty){if(E==c.p2.empty){M.delete(0,M.doc.content.size);let P=z.atStart(M.doc);P.eq(M.selection)||M.setSelection(P)}else super.replace(M,E)}toJSON(){return{type:"all"}}static fromJSON(M){return new V(M)}map(M){return new V(M)}eq(M){return M instanceof V}getBookmark(){return oe}}z.jsonID("all",V);const oe={map(){return this},resolve:G=>new V(G)};function te(G,M,E,P,q,ee=!1){if(M.inlineContent)return F.create(G,E);for(let xe=P-(q>0?0:1);q>0?xe<M.childCount:xe>=0;xe+=q){let _e=M.child(xe);if(_e.isAtom){if(!ee&&ue.isSelectable(_e))return ue.create(G,E-(q<0?_e.nodeSize:0))}else{let Ee=te(G,_e,E+q,q<0?_e.childCount:0,q,ee);if(Ee)return Ee}E+=_e.nodeSize*q}return null}function ae(G,M,E){let P=G.steps.length-1;if(P<M)return;let xe,q=G.steps[P];(q instanceof L.Pu||q instanceof L.FC)&&(G.mapping.maps[P].forEach((_e,Ee,Pe,De)=>{null==xe&&(xe=De)}),G.setSelection(z.near(G.doc.resolve(xe),E)))}class J extends L.wx{constructor(M){super(M.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=M.selection,this.storedMarks=M.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(M){if(M.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=M,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(M){return this.storedMarks=M,this.updated|=2,this}ensureMarks(M){return c.vc.sameSet(this.storedMarks||this.selection.$from.marks(),M)||this.setStoredMarks(M),this}addStoredMark(M){return this.ensureMarks(M.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(M){return this.ensureMarks(M.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(M,E){super.addStep(M,E),this.updated=-3&this.updated,this.storedMarks=null}setTime(M){return this.time=M,this}replaceSelection(M){return this.selection.replace(this,M),this}replaceSelectionWith(M,E=!0){let P=this.selection;return E&&(M=M.mark(this.storedMarks||(P.empty?P.$from.marks():P.$from.marksAcross(P.$to)||c.vc.none))),P.replaceWith(this,M),this}deleteSelection(){return this.selection.replace(this),this}insertText(M,E,P){let q=this.doc.type.schema;if(null==E)return M?this.replaceSelectionWith(q.text(M),!0):this.deleteSelection();{if(null==P&&(P=E),P=null==P?E:P,!M)return this.deleteRange(E,P);let ee=this.storedMarks;if(!ee){let xe=this.doc.resolve(E);ee=P==E?xe.marks():xe.marksAcross(this.doc.resolve(P))}return this.replaceRangeWith(E,P,q.text(M,ee)),this.selection.empty||this.setSelection(z.near(this.selection.$to)),this}}setMeta(M,E){return this.meta["string"==typeof M?M:M.key]=E,this}getMeta(M){return this.meta["string"==typeof M?M:M.key]}get isGeneric(){for(let M in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function $(G,M){return M&&G?G.bind(M):G}class K{constructor(M,E,P){this.name=M,this.init=$(E.init,P),this.apply=$(E.apply,P)}}const Z=[new K("doc",{init:G=>G.doc||G.schema.topNodeType.createAndFill(),apply:G=>G.doc}),new K("selection",{init:(G,M)=>G.selection||z.atStart(M.doc),apply:G=>G.selection}),new K("storedMarks",{init:G=>G.storedMarks||null,apply:(G,M,E,P)=>P.selection.$cursor?G.storedMarks:null}),new K("scrollToSelection",{init:()=>0,apply:(G,M)=>G.scrolledIntoView?M+1:M})];class Y{constructor(M,E){this.schema=M,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Z.slice(),E&&E.forEach(P=>{if(this.pluginsByKey[P.key])throw new RangeError("Adding different instances of a keyed plugin ("+P.key+")");this.plugins.push(P),this.pluginsByKey[P.key]=P,P.spec.state&&this.fields.push(new K(P.key,P.spec.state,P))})}}class Ce{constructor(M){this.config=M}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(M){return this.applyTransaction(M).state}filterTransaction(M,E=-1){for(let P=0;P<this.config.plugins.length;P++)if(P!=E){let q=this.config.plugins[P];if(q.spec.filterTransaction&&!q.spec.filterTransaction.call(q,M,this))return!1}return!0}applyTransaction(M){if(!this.filterTransaction(M))return{state:this,transactions:[]};let E=[M],P=this.applyInner(M),q=null;for(;;){let ee=!1;for(let xe=0;xe<this.config.plugins.length;xe++){let _e=this.config.plugins[xe];if(_e.spec.appendTransaction){let Ee=q?q[xe].n:0,Pe=q?q[xe].state:this,De=Ee<E.length&&_e.spec.appendTransaction.call(_e,Ee?E.slice(Ee):E,Pe,P);if(De&&P.filterTransaction(De,xe)){if(De.setMeta("appendedTransaction",M),!q){q=[];for(let qe=0;qe<this.config.plugins.length;qe++)q.push(qe<xe?{state:P,n:E.length}:{state:this,n:0})}E.push(De),P=P.applyInner(De),ee=!0}q&&(q[xe]={state:P,n:E.length})}}if(!ee)return{state:P,transactions:E}}}applyInner(M){if(!M.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let E=new Ce(this.config),P=this.config.fields;for(let q=0;q<P.length;q++){let ee=P[q];E[ee.name]=ee.apply(M,this[ee.name],this,E)}return E}get tr(){return new J(this)}static create(M){let E=new Y(M.doc?M.doc.type.schema:M.schema,M.plugins),P=new Ce(E);for(let q=0;q<E.fields.length;q++)P[E.fields[q].name]=E.fields[q].init(M,P);return P}reconfigure(M){let E=new Y(this.schema,M.plugins),P=E.fields,q=new Ce(E);for(let ee=0;ee<P.length;ee++){let xe=P[ee].name;q[xe]=this.hasOwnProperty(xe)?this[xe]:P[ee].init(M,q)}return q}toJSON(M){let E={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(E.storedMarks=this.storedMarks.map(P=>P.toJSON())),M&&"object"==typeof M)for(let P in M){if("doc"==P||"selection"==P)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let q=M[P],ee=q.spec.state;ee&&ee.toJSON&&(E[P]=ee.toJSON.call(q,this[q.key]))}return E}static fromJSON(M,E,P){if(!E)throw new RangeError("Invalid input for EditorState.fromJSON");if(!M.schema)throw new RangeError("Required config field 'schema' missing");let q=new Y(M.schema,M.plugins),ee=new Ce(q);return q.fields.forEach(xe=>{if("doc"==xe.name)ee.doc=c.NB.fromJSON(M.schema,E.doc);else if("selection"==xe.name)ee.selection=z.fromJSON(ee.doc,E.selection);else if("storedMarks"==xe.name)E.storedMarks&&(ee.storedMarks=E.storedMarks.map(M.schema.markFromJSON));else{if(P)for(let _e in P){let Ee=P[_e],Pe=Ee.spec.state;if(Ee.key==xe.name&&Pe&&Pe.fromJSON&&Object.prototype.hasOwnProperty.call(E,_e))return void(ee[xe.name]=Pe.fromJSON.call(Ee,M,E[_e],ee))}ee[xe.name]=xe.init(M,ee)}}),ee}}function he(G,M,E){for(let P in G){let q=G[P];q instanceof Function?q=q.bind(M):"handleDOMEvents"==P&&(q=he(q,M,{})),E[P]=q}return E}class ne{constructor(M){this.spec=M,this.props={},M.props&&he(M.props,this,this.props),this.key=M.key?M.key.key:Oe("plugin")}getState(M){return M[this.key]}}const ye=Object.create(null);function Oe(G){return G in ye?G+"$"+ ++ye[G]:(ye[G]=0,G+"$")}class Se{constructor(M="key"){this.key=Oe(M)}get(M){return M.config.pluginsByKey[this.key]}getState(M){return M[this.key]}}},3060:(Te,me,v)=>{v.d(me,{Ax:()=>_e,FC:()=>K,GJ:()=>qe,Mn:()=>Pe,Pu:()=>$,dR:()=>dt,k9:()=>ye,nd:()=>Se,nj:()=>nt,vs:()=>oe,wx:()=>Ze});var c=v(8197);const se=Math.pow(2,16);function z(S,d){return S+d*se}function N(S){return 65535&S}class ge{constructor(d,p,y){this.pos=d,this.delInfo=p,this.recover=y}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class V{constructor(d,p=!1){if(this.ranges=d,this.inverted=p,!d.length&&V.empty)return V.empty}recover(d){let p=0,y=N(d);if(!this.inverted)for(let C=0;C<y;C++)p+=this.ranges[3*C+2]-this.ranges[3*C+1];return this.ranges[3*y]+p+function H(S){return(S-(65535&S))/se}(d)}mapResult(d,p=1){return this._map(d,p,!1)}map(d,p=1){return this._map(d,p,!0)}_map(d,p,y){let C=0,b=this.inverted?2:1,T=this.inverted?1:2;for(let I=0;I<this.ranges.length;I+=3){let U=this.ranges[I]-(this.inverted?C:0);if(U>d)break;let X=this.ranges[I+b],re=this.ranges[I+T],fe=U+X;if(d<=fe){let i=U+C+((X?d==U?-1:d==fe?1:p:p)<0?0:re);if(y)return i;let s=d==(p<0?U:fe)?null:z(I/3,d-U),a=d==U?2:d==fe?1:4;return(p<0?d!=U:d!=fe)&&(a|=8),new ge(i,a,s)}C+=re-X}return y?d+C:new ge(d+C,0,null)}touches(d,p){let y=0,C=N(p),b=this.inverted?2:1,T=this.inverted?1:2;for(let I=0;I<this.ranges.length;I+=3){let U=this.ranges[I]-(this.inverted?y:0);if(U>d)break;let X=this.ranges[I+b];if(d<=U+X&&I==3*C)return!0;y+=this.ranges[I+T]-X}return!1}forEach(d){let p=this.inverted?2:1,y=this.inverted?1:2;for(let C=0,b=0;C<this.ranges.length;C+=3){let T=this.ranges[C],I=T-(this.inverted?b:0),U=T+(this.inverted?0:b),X=this.ranges[C+p],re=this.ranges[C+y];d(I,I+X,U,U+re),b+=re-X}}invert(){return new V(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(d){return 0==d?V.empty:new V(d<0?[0,-d,0]:[0,0,d])}}V.empty=new V([]);class oe{constructor(d=[],p,y=0,C=d.length){this.maps=d,this.mirror=p,this.from=y,this.to=C}slice(d=0,p=this.maps.length){return new oe(this.maps,this.mirror,d,p)}copy(){return new oe(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(d,p){this.to=this.maps.push(d),null!=p&&this.setMirror(this.maps.length-1,p)}appendMapping(d){for(let p=0,y=this.maps.length;p<d.maps.length;p++){let C=d.getMirror(p);this.appendMap(d.maps[p],null!=C&&C<p?y+C:void 0)}}getMirror(d){if(this.mirror)for(let p=0;p<this.mirror.length;p++)if(this.mirror[p]==d)return this.mirror[p+(p%2?-1:1)]}setMirror(d,p){this.mirror||(this.mirror=[]),this.mirror.push(d,p)}appendMappingInverted(d){for(let p=d.maps.length-1,y=this.maps.length+d.maps.length;p>=0;p--){let C=d.getMirror(p);this.appendMap(d.maps[p].invert(),null!=C&&C>p?y-C-1:void 0)}}invert(){let d=new oe;return d.appendMappingInverted(this),d}map(d,p=1){if(this.mirror)return this._map(d,p,!0);for(let y=this.from;y<this.to;y++)d=this.maps[y].map(d,p);return d}mapResult(d,p=1){return this._map(d,p,!1)}_map(d,p,y){let C=0;for(let b=this.from;b<this.to;b++){let I=this.maps[b].mapResult(d,p);if(null!=I.recover){let U=this.getMirror(b);if(null!=U&&U>b&&U<this.to){b=U,d=this.maps[U].recover(I.recover);continue}}C|=I.delInfo,d=I.pos}return y?d:new ge(d,C,null)}}const te=Object.create(null);class ae{getMap(){return V.empty}merge(d){return null}static fromJSON(d,p){if(!p||!p.stepType)throw new RangeError("Invalid input for Step.fromJSON");let y=te[p.stepType];if(!y)throw new RangeError(`No step type ${p.stepType} defined`);return y.fromJSON(d,p)}static jsonID(d,p){if(d in te)throw new RangeError("Duplicate use of step JSON ID "+d);return te[d]=p,p.prototype.jsonID=d,p}}class ie{constructor(d,p){this.doc=d,this.failed=p}static ok(d){return new ie(d,null)}static fail(d){return new ie(null,d)}static fromReplace(d,p,y,C){try{return ie.ok(d.replace(p,y,C))}catch(b){if(b instanceof c.e4)return ie.fail(b.message);throw b}}}function ce(S,d,p){let y=[];for(let C=0;C<S.childCount;C++){let b=S.child(C);b.content.size&&(b=b.copy(ce(b.content,d,b))),b.isInline&&(b=d(b,p,C)),y.push(b)}return c.HY.fromArray(y)}class de extends ae{constructor(d,p,y){super(),this.from=d,this.to=p,this.mark=y}apply(d){let p=d.slice(this.from,this.to),y=d.resolve(this.from),C=y.node(y.sharedDepth(this.to)),b=new c.p2(ce(p.content,(T,I)=>T.isAtom&&I.type.allowsMarkType(this.mark.type)?T.mark(this.mark.addToSet(T.marks)):T,C),p.openStart,p.openEnd);return ie.fromReplace(d,this.from,this.to,b)}invert(){return new J(this.from,this.to,this.mark)}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1);return p.deleted&&y.deleted||p.pos>=y.pos?null:new de(p.pos,y.pos,this.mark)}merge(d){return d instanceof de&&d.mark.eq(this.mark)&&this.from<=d.to&&this.to>=d.from?new de(Math.min(this.from,d.from),Math.max(this.to,d.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new de(p.from,p.to,d.markFromJSON(p.mark))}}ae.jsonID("addMark",de);class J extends ae{constructor(d,p,y){super(),this.from=d,this.to=p,this.mark=y}apply(d){let p=d.slice(this.from,this.to),y=new c.p2(ce(p.content,C=>C.mark(this.mark.removeFromSet(C.marks)),d),p.openStart,p.openEnd);return ie.fromReplace(d,this.from,this.to,y)}invert(){return new de(this.from,this.to,this.mark)}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1);return p.deleted&&y.deleted||p.pos>=y.pos?null:new J(p.pos,y.pos,this.mark)}merge(d){return d instanceof J&&d.mark.eq(this.mark)&&this.from<=d.to&&this.to>=d.from?new J(Math.min(this.from,d.from),Math.max(this.to,d.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new J(p.from,p.to,d.markFromJSON(p.mark))}}ae.jsonID("removeMark",J);class $ extends ae{constructor(d,p,y,C=!1){super(),this.from=d,this.to=p,this.slice=y,this.structure=C}apply(d){return this.structure&&Z(d,this.from,this.to)?ie.fail("Structure replace would overwrite content"):ie.fromReplace(d,this.from,this.to,this.slice)}getMap(){return new V([this.from,this.to-this.from,this.slice.size])}invert(d){return new $(this.from,this.from+this.slice.size,d.slice(this.from,this.to))}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1);return p.deletedAcross&&y.deletedAcross?null:new $(p.pos,Math.max(p.pos,y.pos),this.slice)}merge(d){if(!(d instanceof $)||d.structure||this.structure)return null;if(this.from+this.slice.size!=d.from||this.slice.openEnd||d.slice.openStart){if(d.to!=this.from||this.slice.openStart||d.slice.openEnd)return null;{let p=this.slice.size+d.slice.size==0?c.p2.empty:new c.p2(d.slice.content.append(this.slice.content),d.slice.openStart,this.slice.openEnd);return new $(d.from,this.to,p,this.structure)}}{let p=this.slice.size+d.slice.size==0?c.p2.empty:new c.p2(this.slice.content.append(d.slice.content),this.slice.openStart,d.slice.openEnd);return new $(this.from,this.to+(d.to-d.from),p,this.structure)}}toJSON(){let d={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(d.slice=this.slice.toJSON()),this.structure&&(d.structure=!0),d}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new $(p.from,p.to,c.p2.fromJSON(d,p.slice),!!p.structure)}}ae.jsonID("replace",$);class K extends ae{constructor(d,p,y,C,b,T,I=!1){super(),this.from=d,this.to=p,this.gapFrom=y,this.gapTo=C,this.slice=b,this.insert=T,this.structure=I}apply(d){if(this.structure&&(Z(d,this.from,this.gapFrom)||Z(d,this.gapTo,this.to)))return ie.fail("Structure gap-replace would overwrite content");let p=d.slice(this.gapFrom,this.gapTo);if(p.openStart||p.openEnd)return ie.fail("Gap is not a flat range");let y=this.slice.insertAt(this.insert,p.content);return y?ie.fromReplace(d,this.from,this.to,y):ie.fail("Content does not fit in gap")}getMap(){return new V([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(d){let p=this.gapTo-this.gapFrom;return new K(this.from,this.from+this.slice.size+p,this.from+this.insert,this.from+this.insert+p,d.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1),C=d.map(this.gapFrom,-1),b=d.map(this.gapTo,1);return p.deletedAcross&&y.deletedAcross||C<p.pos||b>y.pos?null:new K(p.pos,y.pos,C,b,this.slice,this.insert,this.structure)}toJSON(){let d={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(d.slice=this.slice.toJSON()),this.structure&&(d.structure=!0),d}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to||"number"!=typeof p.gapFrom||"number"!=typeof p.gapTo||"number"!=typeof p.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new K(p.from,p.to,p.gapFrom,p.gapTo,c.p2.fromJSON(d,p.slice),p.insert,!!p.structure)}}function Z(S,d,p){let y=S.resolve(d),C=p-d,b=y.depth;for(;C>0&&b>0&&y.indexAfter(b)==y.node(b).childCount;)b--,C--;if(C>0){let T=y.node(b).maybeChild(y.indexAfter(b));for(;C>0;){if(!T||T.isLeaf)return!0;T=T.firstChild,C--}}return!1}function ne(S,d,p){return(0==d||S.canReplace(d,S.childCount))&&(p==S.childCount||S.canReplace(0,p))}function ye(S){let p=S.parent.content.cutByIndex(S.startIndex,S.endIndex);for(let y=S.depth;;--y){let C=S.$from.node(y),b=S.$from.index(y),T=S.$to.indexAfter(y);if(y<S.depth&&C.canReplace(b,T,p))return y;if(0==y||C.type.spec.isolating||!ne(C,b,T))break}return null}function Se(S,d,p=null,y=S){let C=function M(S,d){let{parent:p,startIndex:y,endIndex:C}=S,b=p.contentMatchAt(y).findWrapping(d);return b&&p.canReplaceWith(y,C,b.length?b[0]:d)?b:null}(S,d),b=C&&function E(S,d){let{parent:p,startIndex:y,endIndex:C}=S,b=p.child(y),T=d.contentMatch.findWrapping(b.type);if(!T)return null;let U=(T.length?T[T.length-1]:d).contentMatch;for(let X=y;U&&X<C;X++)U=U.matchType(p.child(X).type);return U&&U.validEnd?T:null}(y,d);return b?C.map(G).concat({type:d,attrs:p}).concat(b.map(G)):null}function G(S){return{type:S,attrs:null}}function _e(S,d,p=1,y){let C=S.resolve(d),b=C.depth-p,T=y&&y[y.length-1]||C.parent;if(b<0||C.parent.type.spec.isolating||!C.parent.canReplace(C.index(),C.parent.childCount)||!T.type.validContent(C.parent.content.cutByIndex(C.index(),C.parent.childCount)))return!1;for(let X=C.depth-1,re=p-2;X>b;X--,re--){let fe=C.node(X),x=C.index(X);if(fe.type.spec.isolating)return!1;let i=fe.content.cutByIndex(x,fe.childCount),s=y&&y[re]||fe;if(s!=fe&&(i=i.replaceChild(0,s.type.create(s.attrs))),!fe.canReplace(x+1,fe.childCount)||!s.type.validContent(i))return!1}let I=C.indexAfter(b),U=y&&y[0];return C.node(b).canReplaceWith(I,I,U?U.type:C.node(b+1).type)}function Pe(S,d){let p=S.resolve(d),y=p.index();return De(p.nodeBefore,p.nodeAfter)&&p.parent.canReplace(y,y+1)}function De(S,d){return!(!S||!d||S.isLeaf||!S.canAppend(d))}function qe(S,d,p=-1){let y=S.resolve(d);for(let C=y.depth;;C--){let b,T,I=y.index(C);if(C==y.depth?(b=y.nodeBefore,T=y.nodeAfter):p>0?(b=y.node(C+1),I++,T=y.node(C).maybeChild(I)):(b=y.node(C).maybeChild(I-1),T=y.node(C+1)),b&&!b.isTextblock&&De(b,T)&&y.node(C).canReplace(I,I+1))return d;if(0==C)break;d=p<0?y.before(C):y.after(C)}}function nt(S,d,p){let y=S.resolve(d);if(!p.content.size)return d;let C=p.content;for(let b=0;b<p.openStart;b++)C=C.firstChild.content;for(let b=1;b<=(0==p.openStart&&p.size?2:1);b++)for(let T=y.depth;T>=0;T--){let I=T==y.depth?0:y.pos<=(y.start(T+1)+y.end(T+1))/2?-1:1,U=y.index(T)+(I>0?1:0),X=y.node(T),re=!1;if(1==b)re=X.canReplace(U,U,C);else{let fe=X.contentMatchAt(U).findWrapping(C.firstChild.type);re=fe&&X.canReplaceWith(U,U,fe[0])}if(re)return 0==I?y.pos:I<0?y.before(T+1):y.after(T+1)}return null}function dt(S,d,p=d,y=c.p2.empty){if(d==p&&!y.size)return null;let C=S.resolve(d),b=S.resolve(p);return je(C,b,y)?new $(d,p,y):new ut(C,b,y).fit()}function je(S,d,p){return!p.openStart&&!p.openEnd&&S.start()==d.start()&&S.parent.canReplace(S.index(),d.index(),p.content)}ae.jsonID("replaceAround",K);class ut{constructor(d,p,y){this.$from=d,this.$to=p,this.unplaced=y,this.frontier=[],this.placed=c.HY.empty;for(let C=0;C<=d.depth;C++){let b=d.node(C);this.frontier.push({type:b.type,match:b.contentMatchAt(d.indexAfter(C))})}for(let C=d.depth;C>0;C--)this.placed=c.HY.from(d.node(C).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let X=this.findFittable();X?this.placeNodes(X):this.openMore()||this.dropNode()}let d=this.mustMoveInline(),p=this.placed.size-this.depth-this.$from.depth,y=this.$from,C=this.close(d<0?this.$to:y.doc.resolve(d));if(!C)return null;let b=this.placed,T=y.depth,I=C.depth;for(;T&&I&&1==b.childCount;)b=b.firstChild.content,T--,I--;let U=new c.p2(b,T,I);return d>-1?new K(y.pos,d,this.$to.pos,this.$to.end(),U,p):U.size||y.pos!=this.$to.pos?new $(y.pos,C.pos,U):null}findFittable(){for(let d=1;d<=2;d++)for(let p=this.unplaced.openStart;p>=0;p--){let y,C=null;p?(C=Ue(this.unplaced.content,p-1).firstChild,y=C.content):y=this.unplaced.content;let b=y.firstChild;for(let T=this.depth;T>=0;T--){let X,{type:I,match:U}=this.frontier[T],re=null;if(1==d&&(b?U.matchType(b.type)||(re=U.fillBefore(c.HY.from(b),!1)):C&&I.compatibleContent(C.type)))return{sliceDepth:p,frontierDepth:T,parent:C,inject:re};if(2==d&&b&&(X=U.findWrapping(b.type)))return{sliceDepth:p,frontierDepth:T,parent:C,wrap:X};if(C&&U.matchType(C.type))break}}}openMore(){let{content:d,openStart:p,openEnd:y}=this.unplaced,C=Ue(d,p);return!(!C.childCount||C.firstChild.isLeaf||(this.unplaced=new c.p2(d,p+1,Math.max(y,C.size+p>=d.size-y?p+1:0)),0))}dropNode(){let{content:d,openStart:p,openEnd:y}=this.unplaced,C=Ue(d,p);if(C.childCount<=1&&p>0){let b=d.size-p<=p+C.size;this.unplaced=new c.p2(Ke(d,p-1,1),p-1,b?p-1:y)}else this.unplaced=new c.p2(Ke(d,p,1),p,y)}placeNodes({sliceDepth:d,frontierDepth:p,parent:y,inject:C,wrap:b}){for(;this.depth>p;)this.closeFrontierNode();if(b)for(let a=0;a<b.length;a++)this.openFrontierNode(b[a]);let T=this.unplaced,I=y?y.content:T.content,U=T.openStart-d,X=0,re=[],{match:fe,type:x}=this.frontier[p];if(C){for(let a=0;a<C.childCount;a++)re.push(C.child(a));fe=fe.matchFragment(C)}let i=I.size+d-(T.content.size-T.openEnd);for(;X<I.childCount;){let a=I.child(X),f=fe.matchType(a.type);if(!f)break;X++,(X>1||0==U||a.content.size)&&(fe=f,re.push(ft(a.mark(x.allowedMarks(a.marks)),1==X?U:0,X==I.childCount?i:-1)))}let s=X==I.childCount;s||(i=-1),this.placed=Ye(this.placed,p,c.HY.from(re)),this.frontier[p].match=fe,s&&i<0&&y&&y.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let a=0,f=I;a<i;a++){let m=f.lastChild;this.frontier.push({type:m.type,match:m.contentMatchAt(m.childCount)}),f=m.content}this.unplaced=s?0==d?c.p2.empty:new c.p2(Ke(T.content,d-1,1),d-1,i<0?T.openEnd:d-1):new c.p2(Ke(T.content,d,X),T.openStart,T.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let p,d=this.frontier[this.depth];if(!d.type.isTextblock||!Ne(this.$to,this.$to.depth,d.type,d.match,!1)||this.$to.depth==this.depth&&(p=this.findCloseLevel(this.$to))&&p.depth==this.depth)return-1;let{depth:y}=this.$to,C=this.$to.after(y);for(;y>1&&C==this.$to.end(--y);)++C;return C}findCloseLevel(d){e:for(let p=Math.min(this.depth,d.depth);p>=0;p--){let{match:y,type:C}=this.frontier[p],b=p<d.depth&&d.end(p+1)==d.pos+(d.depth-(p+1)),T=Ne(d,p,C,y,b);if(T){for(let I=p-1;I>=0;I--){let{match:U,type:X}=this.frontier[I],re=Ne(d,I,X,U,!0);if(!re||re.childCount)continue e}return{depth:p,fit:T,move:b?d.doc.resolve(d.after(p+1)):d}}}}close(d){let p=this.findCloseLevel(d);if(!p)return null;for(;this.depth>p.depth;)this.closeFrontierNode();p.fit.childCount&&(this.placed=Ye(this.placed,p.depth,p.fit)),d=p.move;for(let y=p.depth+1;y<=d.depth;y++){let C=d.node(y),b=C.type.contentMatch.fillBefore(C.content,!0,d.index(y));this.openFrontierNode(C.type,C.attrs,b)}return d}openFrontierNode(d,p=null,y){let C=this.frontier[this.depth];C.match=C.match.matchType(d),this.placed=Ye(this.placed,this.depth,c.HY.from(d.create(p,y))),this.frontier.push({type:d,match:d.contentMatch})}closeFrontierNode(){let p=this.frontier.pop().match.fillBefore(c.HY.empty,!0);p.childCount&&(this.placed=Ye(this.placed,this.frontier.length,p))}}function Ke(S,d,p){return 0==d?S.cutByIndex(p,S.childCount):S.replaceChild(0,S.firstChild.copy(Ke(S.firstChild.content,d-1,p)))}function Ye(S,d,p){return 0==d?S.append(p):S.replaceChild(S.childCount-1,S.lastChild.copy(Ye(S.lastChild.content,d-1,p)))}function Ue(S,d){for(let p=0;p<d;p++)S=S.firstChild.content;return S}function ft(S,d,p){if(d<=0)return S;let y=S.content;return d>1&&(y=y.replaceChild(0,ft(y.firstChild,d-1,1==y.childCount?p-1:0))),d>0&&(y=S.type.contentMatch.fillBefore(y).append(y),p<=0&&(y=y.append(S.type.contentMatch.matchFragment(y).fillBefore(c.HY.empty,!0)))),S.copy(y)}function Ne(S,d,p,y,C){let b=S.node(d),T=C?S.indexAfter(d):S.index(d);if(T==b.childCount&&!p.compatibleContent(b.type))return null;let I=y.fillBefore(b.content,!0,T);return I&&!function Mt(S,d,p){for(let y=p;y<d.childCount;y++)if(!S.allowsMarks(d.child(y).marks))return!0;return!1}(p,b.content,T)?I:null}function it(S){return S.spec.defining||S.spec.definingForContent}function He(S,d,p,y,C){if(d<p){let b=S.firstChild;S=S.replaceChild(0,b.copy(He(b.content,d+1,p,y,b)))}if(d>y){let b=C.contentMatchAt(0),T=b.fillBefore(S).append(S);S=T.append(b.matchFragment(T).fillBefore(c.HY.empty,!0))}return S}function Qe(S,d){let p=[];for(let C=Math.min(S.depth,d.depth);C>=0;C--){let b=S.start(C);if(b<S.pos-(S.depth-C)||d.end(C)>d.pos+(d.depth-C)||S.node(C).type.spec.isolating||d.node(C).type.spec.isolating)break;(b==d.start(C)||C==S.depth&&C==d.depth&&S.parent.inlineContent&&d.parent.inlineContent&&C&&d.start(C-1)==b-1)&&p.push(C)}return p}let Be=class extends Error{};Be=function S(d){let p=Error.call(this,d);return p.__proto__=S.prototype,p},(Be.prototype=Object.create(Error.prototype)).constructor=Be,Be.prototype.name="TransformError";class Ze{constructor(d){this.doc=d,this.steps=[],this.docs=[],this.mapping=new oe}get before(){return this.docs.length?this.docs[0]:this.doc}step(d){let p=this.maybeStep(d);if(p.failed)throw new Be(p.failed);return this}maybeStep(d){let p=d.apply(this.doc);return p.failed||this.addStep(d,p.doc),p}get docChanged(){return this.steps.length>0}addStep(d,p){this.docs.push(this.doc),this.steps.push(d),this.mapping.appendMap(d.getMap()),this.doc=p}replace(d,p=d,y=c.p2.empty){let C=dt(this.doc,d,p,y);return C&&this.step(C),this}replaceWith(d,p,y){return this.replace(d,p,new c.p2(c.HY.from(y),0,0))}delete(d,p){return this.replace(d,p,c.p2.empty)}insert(d,p){return this.replaceWith(d,d,p)}replaceRange(d,p,y){return function Fe(S,d,p,y){if(!y.size)return S.deleteRange(d,p);let C=S.doc.resolve(d),b=S.doc.resolve(p);if(je(C,b,y))return S.step(new $(d,p,y));let T=Qe(C,S.doc.resolve(p));0==T[T.length-1]&&T.pop();let I=-(C.depth+1);T.unshift(I);for(let x=C.depth,i=C.pos-1;x>0;x--,i--){let s=C.node(x).type.spec;if(s.defining||s.definingAsContext||s.isolating)break;T.indexOf(x)>-1?I=x:C.before(x)==i&&T.splice(1,0,-x)}let U=T.indexOf(I),X=[],re=y.openStart;for(let x=y.content,i=0;;i++){let s=x.firstChild;if(X.push(s),i==y.openStart)break;x=s.content}for(let x=re-1;x>=0;x--){let i=X[x].type,s=it(i);if(s&&C.node(U).type!=i)re=x;else if(s||!i.isTextblock)break}for(let x=y.openStart;x>=0;x--){let i=(x+re+1)%(y.openStart+1),s=X[i];if(s)for(let a=0;a<T.length;a++){let f=T[(a+U)%T.length],m=!0;f<0&&(m=!1,f=-f);let k=C.node(f-1),D=C.index(f-1);if(k.canReplaceWith(D,D,s.type,s.marks))return S.replace(C.before(f),m?b.after(f):p,new c.p2(He(y.content,0,y.openStart,i),i,y.openEnd))}}let fe=S.steps.length;for(let x=T.length-1;x>=0&&(S.replace(d,p,y),!(S.steps.length>fe));x--){let i=T[x];i<0||(d=C.before(i),p=b.after(i))}}(this,d,p,y),this}replaceRangeWith(d,p,y){return function pt(S,d,p,y){if(!y.isInline&&d==p&&S.doc.resolve(d).parent.content.size){let C=function ht(S,d,p){let y=S.resolve(d);if(y.parent.canReplaceWith(y.index(),y.index(),p))return d;if(0==y.parentOffset)for(let C=y.depth-1;C>=0;C--){let b=y.index(C);if(y.node(C).canReplaceWith(b,b,p))return y.before(C+1);if(b>0)return null}if(y.parentOffset==y.parent.content.size)for(let C=y.depth-1;C>=0;C--){let b=y.indexAfter(C);if(y.node(C).canReplaceWith(b,b,p))return y.after(C+1);if(b<y.node(C).childCount)return null}return null}(S.doc,d,y.type);null!=C&&(d=p=C)}S.replaceRange(d,p,new c.p2(c.HY.from(y),0,0))}(this,d,p,y),this}deleteRange(d,p){return function mt(S,d,p){let y=S.doc.resolve(d),C=S.doc.resolve(p),b=Qe(y,C);for(let T=0;T<b.length;T++){let I=b[T],U=T==b.length-1;if(U&&0==I||y.node(I).type.contentMatch.validEnd)return S.delete(y.start(I),C.end(I));if(I>0&&(U||y.node(I-1).canReplace(y.index(I-1),C.indexAfter(I-1))))return S.delete(y.before(I),C.after(I))}for(let T=1;T<=y.depth&&T<=C.depth;T++)if(d-y.start(T)==y.depth-T&&p>y.end(T)&&C.end(T)-p!=C.depth-T)return S.delete(y.before(T),p);S.delete(d,p)}(this,d,p),this}lift(d,p){return function Oe(S,d,p){let{$from:y,$to:C,depth:b}=d,T=y.before(b+1),I=C.after(b+1),U=T,X=I,re=c.HY.empty,fe=0;for(let s=b,a=!1;s>p;s--)a||y.index(s)>0?(a=!0,re=c.HY.from(y.node(s).copy(re)),fe++):U--;let x=c.HY.empty,i=0;for(let s=b,a=!1;s>p;s--)a||C.after(s+1)<C.end(s)?(a=!0,x=c.HY.from(C.node(s).copy(x)),i++):X++;S.step(new K(U,X,T,I,new c.p2(re.append(x),fe,i),re.size-fe,!0))}(this,d,p),this}join(d,p=1){return function Je(S,d,p){let y=new $(d-p,d+p,c.p2.empty,!0);S.step(y)}(this,d,p),this}wrap(d,p){return function P(S,d,p){let y=c.HY.empty;for(let T=p.length-1;T>=0;T--){if(y.size){let I=p[T].type.contentMatch.matchFragment(y);if(!I||!I.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}y=c.HY.from(p[T].type.create(p[T].attrs,y))}let C=d.start,b=d.end;S.step(new K(C,b,C,b,new c.p2(y,0,0),p.length,!0))}(this,d,p),this}setBlockType(d,p=d,y,C=null){return function q(S,d,p,y,C){if(!y.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let b=S.steps.length;S.doc.nodesBetween(d,p,(T,I)=>{if(T.isTextblock&&!T.hasMarkup(y,C)&&function ee(S,d,p){let y=S.resolve(d),C=y.index();return y.parent.canReplaceWith(C,C+1,p)}(S.doc,S.mapping.slice(b).map(I),y)){S.clearIncompatible(S.mapping.slice(b).map(I,1),y);let U=S.mapping.slice(b),X=U.map(I,1),re=U.map(I+T.nodeSize,1);return S.step(new K(X,re,X+1,re-1,new c.p2(c.HY.from(y.create(C,null,T.marks)),0,0),1,!0)),!1}})}(this,d,p,y,C),this}setNodeMarkup(d,p,y=null,C=[]){return function xe(S,d,p,y,C){let b=S.doc.nodeAt(d);if(!b)throw new RangeError("No node at given position");p||(p=b.type);let T=p.create(y,null,C||b.marks);if(b.isLeaf)return S.replaceWith(d,d+b.nodeSize,T);if(!p.validContent(b.content))throw new RangeError("Invalid content for node type "+p.name);S.step(new K(d,d+b.nodeSize,d+1,d+b.nodeSize-1,new c.p2(c.HY.from(T),0,0),1,!0))}(this,d,p,y,C),this}split(d,p=1,y){return function Ee(S,d,p=1,y){let C=S.doc.resolve(d),b=c.HY.empty,T=c.HY.empty;for(let I=C.depth,U=C.depth-p,X=p-1;I>U;I--,X--){b=c.HY.from(C.node(I).copy(b));let re=y&&y[X];T=c.HY.from(re?re.type.create(re.attrs,T):C.node(I).copy(T))}S.step(new $(d,d,new c.p2(b.append(T),p,p),!0))}(this,d,p,y),this}addMark(d,p,y){return function Y(S,d,p,y){let T,I,C=[],b=[];S.doc.nodesBetween(d,p,(U,X,re)=>{if(!U.isInline)return;let fe=U.marks;if(!y.isInSet(fe)&&re.type.allowsMarkType(y.type)){let x=Math.max(X,d),i=Math.min(X+U.nodeSize,p),s=y.addToSet(fe);for(let a=0;a<fe.length;a++)fe[a].isInSet(s)||(T&&T.to==x&&T.mark.eq(fe[a])?T.to=i:C.push(T=new J(x,i,fe[a])));I&&I.to==x?I.to=i:b.push(I=new de(x,i,y))}}),C.forEach(U=>S.step(U)),b.forEach(U=>S.step(U))}(this,d,p,y),this}removeMark(d,p,y){return function Ce(S,d,p,y){let C=[],b=0;S.doc.nodesBetween(d,p,(T,I)=>{if(!T.isInline)return;b++;let U=null;if(y instanceof c.ZU){let re,X=T.marks;for(;re=y.isInSet(X);)(U||(U=[])).push(re),X=re.removeFromSet(X)}else y?y.isInSet(T.marks)&&(U=[y]):U=T.marks;if(U&&U.length){let X=Math.min(I+T.nodeSize,p);for(let re=0;re<U.length;re++){let x,fe=U[re];for(let i=0;i<C.length;i++){let s=C[i];s.step==b-1&&fe.eq(C[i].style)&&(x=s)}x?(x.to=X,x.step=b):C.push({style:fe,from:Math.max(I,d),to:X,step:b})}}}),C.forEach(T=>S.step(new J(T.from,T.to,T.style)))}(this,d,p,y),this}clearIncompatible(d,p,y){return function he(S,d,p,y=p.contentMatch){let C=S.doc.nodeAt(d),b=[],T=d+1;for(let I=0;I<C.childCount;I++){let U=C.child(I),X=T+U.nodeSize,re=y.matchType(U.type);if(re){y=re;for(let fe=0;fe<U.marks.length;fe++)p.allowsMarkType(U.marks[fe].type)||S.step(new J(T,X,U.marks[fe]))}else b.push(new $(T,X,c.p2.empty));T=X}if(!y.validEnd){let I=y.fillBefore(c.HY.empty,!0);S.replace(T,T,new c.p2(I,0,0))}for(let I=b.length-1;I>=0;I--)S.step(b[I])}(this,d,p,y),this}}},412:(Te,me,v)=>{v.d(me,{EH:()=>we,p:()=>Le,tk:()=>vi});var c=v(6956),L=v(8197),se=v(3060);const z="undefined"!=typeof navigator?navigator:null,N="undefined"!=typeof document?document:null,H=z&&z.userAgent||"",W=/Edge\/(\d+)/.exec(H),F=/MSIE \d/.exec(H),j=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(H),ue=!!(F||j||W),ge=F?document.documentMode:j?+j[1]:W?+W[1]:0,V=!ue&&/gecko\/(\d+)/i.test(H);V&&/Firefox\/(\d+)/.exec(H);const oe=!ue&&/Chrome\/(\d+)/.exec(H),te=!!oe,ae=oe?+oe[1]:0,ie=!ue&&!!z&&/Apple Computer/.test(z.vendor),ce=ie&&(/Mobile\/\w+/.test(H)||!!z&&z.maxTouchPoints>2),de=ce||!!z&&/Mac/.test(z.platform),J=/Android \d/.test(H),$=!!N&&"webkitFontSmoothing"in N.documentElement.style,K=$?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,Z=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Y=function(t){let e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e};let Ce=null;const he=function(t,e,n){let r=Ce||(Ce=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},ne=function(t,e,n,r){return n&&(Oe(t,e,n,r,-1)||Oe(t,e,n,r,1))},ye=/^(img|br|input|textarea|hr)$/i;function Oe(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Se(t))){let l=t.parentNode;if(!l||1!=l.nodeType||M(t)||ye.test(t.nodeName)||"false"==t.contentEditable)return!1;e=Z(t)+(o<0?0:1),t=l}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?Se(t):0}}}function Se(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function M(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const E=function(t){let e=t.isCollapsed;return e&&te&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function P(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function q(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function ee(t,e){return"number"==typeof t?t:t[e]}function xe(t){let e=t.getBoundingClientRect();return{left:e.left,right:e.left+t.clientWidth*(e.width/t.offsetWidth||1),top:e.top,bottom:e.top+t.clientHeight*(e.height/t.offsetHeight||1)}}function _e(t,e,n){let r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,l=t.dom.ownerDocument;for(let h=n||t.dom;h;h=Y(h)){if(1!=h.nodeType)continue;let u=h,g=u==l.body,O=g?q(l):xe(u),_=0,B=0;if(e.top<O.top+ee(r,"top")?B=-(O.top-e.top+ee(o,"top")):e.bottom>O.bottom-ee(r,"bottom")&&(B=e.bottom-O.bottom+ee(o,"bottom")),e.left<O.left+ee(r,"left")?_=-(O.left-e.left+ee(o,"left")):e.right>O.right-ee(r,"right")&&(_=e.right-O.right+ee(o,"right")),_||B)if(g)l.defaultView.scrollBy(_,B);else{let R=u.scrollLeft,A=u.scrollTop;B&&(u.scrollTop+=B),_&&(u.scrollLeft+=_);let Q=u.scrollLeft-R,Me=u.scrollTop-A;e={left:e.left-Q,top:e.top-Me,right:e.right-Q,bottom:e.bottom-Me}}if(g)break}}function Pe(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Y(r));return e}function qe(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:o,left:l}=t[n];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=l&&(r.scrollLeft=l)}}let Je=null;function nt(t,e){let n,o,r=2e8,l=0,h=e.top,u=e.top;for(let g=t.firstChild,O=0;g;g=g.nextSibling,O++){let _;if(1==g.nodeType)_=g.getClientRects();else{if(3!=g.nodeType)continue;_=he(g).getClientRects()}for(let B=0;B<_.length;B++){let R=_[B];if(R.top<=h&&R.bottom>=u){h=Math.max(R.bottom,h),u=Math.min(R.top,u);let A=R.left>e.left?R.left-e.left:R.right<e.left?e.left-R.right:0;if(A<r){n=g,r=A,o=A&&3==n.nodeType?{left:R.right<e.left?R.right:R.left,top:e.top}:e,1==g.nodeType&&A&&(l=O+(e.left>=(R.left+R.right)/2?1:0));continue}}!n&&(e.left>=R.right&&e.top>=R.top||e.left>=R.left&&e.top>=R.bottom)&&(l=O+1)}}return n&&3==n.nodeType?function dt(t,e){let n=t.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let l=Ne(r,1);if(l.top!=l.bottom&&je(e,l))return{node:t,offset:o+(e.left>=(l.left+l.right)/2?1:0)}}return{node:t,offset:0}}(n,o):!n||r&&1==n.nodeType?{node:t,offset:l}:nt(n,o)}function je(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function Ue(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),l=o;;){let h=t.childNodes[l];if(1==h.nodeType){let u=h.getClientRects();for(let g=0;g<u.length;g++){let O=u[g];if(je(e,O))return Ue(h,e,O)}}if((l=(l+1)%r)==o)break}return t}function ft(t,e){let r,n=t.dom.ownerDocument,o=0;if(n.caretPositionFromPoint)try{let g=n.caretPositionFromPoint(e.left,e.top);g&&({offsetNode:r,offset:o}=g)}catch(g){}if(!r&&n.caretRangeFromPoint){let g=n.caretRangeFromPoint(e.left,e.top);g&&({startContainer:r,startOffset:o}=g)}let h,l=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top);if(!l||!t.dom.contains(1!=l.nodeType?l.parentNode:l)){let g=t.dom.getBoundingClientRect();if(!je(e,g)||(l=Ue(t.dom,e,g),!l))return null}if(ie)for(let g=l;r&&g;g=Y(g))g.draggable&&(r=void 0);if(l=function ut(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(l,e),r){if(V&&1==r.nodeType&&(o=Math.min(o,r.childNodes.length),o<r.childNodes.length)){let O,g=r.childNodes[o];"IMG"==g.nodeName&&(O=g.getBoundingClientRect()).right<=e.left&&O.bottom>e.top&&o++}r==t.dom&&o==r.childNodes.length-1&&1==r.lastChild.nodeType&&e.top>r.lastChild.getBoundingClientRect().bottom?h=t.state.doc.content.size:(0==o||1!=r.nodeType||"BR"!=r.childNodes[o-1].nodeName)&&(h=function Ye(t,e,n,r){let o=-1;for(let l=e;l!=t.dom;){let h=t.docView.nearestDesc(l,!0);if(!h)return null;if(h.node.isBlock&&h.parent){let u=h.dom.getBoundingClientRect();if(u.left>r.left||u.top>r.top)o=h.posBefore;else{if(!(u.right<r.left||u.bottom<r.top))break;o=h.posAfter}}l=h.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,1)}(t,r,o,e))}null==h&&(h=function Ke(t,e,n){let{node:r,offset:o}=nt(e,n),l=-1;if(1==r.nodeType&&!r.firstChild){let h=r.getBoundingClientRect();l=h.left!=h.right&&n.left>(h.left+h.right)/2?1:-1}return t.docView.posFromDOM(r,o,l)}(t,l,e));let u=t.docView.nearestDesc(l,!0);return{pos:h,inside:u?u.posAtStart-u.border:-1}}function Ne(t,e){let n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}const Mt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function it(t,e,n){let{node:r,offset:o,atom:l}=t.docView.domFromPos(e,n<0?-1:1),h=$||V;if(3==r.nodeType){if(!h||!Mt.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let g=o,O=o,_=n<0?1:-1;return n<0&&!o?(O++,_=-1):n>=0&&o==r.nodeValue.length?(g--,_=1):n<0?g--:O++,Fe(Ne(he(r,g,O),_),_<0)}{let g=Ne(he(r,o,o),n);if(V&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let O=Ne(he(r,o-1,o-1),-1);if(O.top==g.top){let _=Ne(he(r,o,o+1),-1);if(_.top!=g.top)return Fe(_,_.left<O.left)}}return g}}if(!t.state.doc.resolve(e-(l||0)).parent.inlineContent){if(null==l&&o&&(n<0||o==Se(r))){let g=r.childNodes[o-1];if(1==g.nodeType)return He(g.getBoundingClientRect(),!1)}if(null==l&&o<Se(r)){let g=r.childNodes[o];if(1==g.nodeType)return He(g.getBoundingClientRect(),!0)}return He(r.getBoundingClientRect(),n>=0)}if(null==l&&o&&(n<0||o==Se(r))){let g=r.childNodes[o-1],O=3==g.nodeType?he(g,Se(g)-(h?0:1)):1!=g.nodeType||"BR"==g.nodeName&&g.nextSibling?null:g;if(O)return Fe(Ne(O,1),!1)}if(null==l&&o<Se(r)){let g=r.childNodes[o];for(;g.pmViewDesc&&g.pmViewDesc.ignoreForCoords;)g=g.nextSibling;let O=g?3==g.nodeType?he(g,0,h?0:1):1==g.nodeType?g:null:null;if(O)return Fe(Ne(O,-1),!0)}return Fe(Ne(3==r.nodeType?he(r):r,-n),n>=0)}function Fe(t,e){if(0==t.width)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function He(t,e){if(0==t.height)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function pt(t,e,n){let r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}const Qe=/[\u0590-\u08ac]/;let Ze=null,S=null,d=!1;class I{constructor(e,n,r,o){this.parent=e,this.children=n,this.dom=r,this.contentDOM=o,this.dirty=0,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let o=this.children[n];if(o==e)return r;r+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(r<0){let l,h;if(e==this.contentDOM)l=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;l=e.previousSibling}for(;l&&(!(h=l.pmViewDesc)||h.parent!=this);)l=l.previousSibling;return l?this.posBeforeChild(h)+h.size:this.posAtStart}{let l,h;if(e==this.contentDOM)l=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;l=e.nextSibling}for(;l&&(!(h=l.pmViewDesc)||h.parent!=this);)l=l.nextSibling;return l?this.posBeforeChild(h):this.posAtEnd}}let o;if(e==this.dom&&this.contentDOM)o=n>Z(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(let l=e;;l=l.parentNode){if(l==this.dom){o=!1;break}if(l.previousSibling)break}if(null==o&&n==e.childNodes.length)for(let l=e;;l=l.parentNode){if(l==this.dom){o=!0;break}if(l.nextSibling)break}}return(null==o?r>0:o)?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,o=e;o;o=o.parentNode){let h,l=this.getDesc(o);if(l&&(!n||l.node)){if(!r||!(h=l.nodeDOM)||(1==h.nodeType?h.contains(1==e.nodeType?e:e.parentNode):h==e))return l;r=!1}}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let o=e;o;o=o.parentNode){let l=this.getDesc(o);if(l)return l.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],l=r+o.size;if(r==e&&l!=r){for(;!o.border&&o.children.length;)o=o.children[0];return o}if(e<l)return o.descAt(e-r-o.border);r=l}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let l,r=0,o=0;for(let l=0;r<this.children.length;r++){let h=this.children[r],u=l+h.size;if(u>e||h instanceof s){o=e-l;break}l=u}if(o)return this.children[r].domFromPos(o-this.children[r].border,n);for(;r&&!(l=this.children[r-1]).size&&l instanceof U&&l.side>=0;r--);if(n<=0){let l,h=!0;for(;l=r?this.children[r-1]:null,l&&l.dom.parentNode!=this.contentDOM;r--,h=!1);return l&&n&&h&&!l.border&&!l.domAtom?l.domFromPos(l.size,n):{node:this.contentDOM,offset:l?Z(l.dom)+1:0}}{let l,h=!0;for(;l=r<this.children.length?this.children[r]:null,l&&l.dom.parentNode!=this.contentDOM;r++,h=!1);return l&&h&&!l.border&&!l.domAtom?l.domFromPos(0,n):{node:this.contentDOM,offset:l?Z(l.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,l=-1;for(let h=r,u=0;;u++){let g=this.children[u],O=h+g.size;if(-1==o&&e<=O){let _=h+g.border;if(e>=_&&n<=O-g.border&&g.node&&g.contentDOM&&this.contentDOM.contains(g.contentDOM))return g.parseRange(e,n,_);e=h;for(let B=u;B>0;B--){let R=this.children[B-1];if(R.size&&R.dom.parentNode==this.contentDOM&&!R.emptyChildAt(1)){o=Z(R.dom)+1;break}e-=R.size}-1==o&&(o=0)}if(o>-1&&(O>n||u==this.children.length-1)){n=O;for(let _=u+1;_<this.children.length;_++){let B=this.children[_];if(B.size&&B.dom.parentNode==this.contentDOM&&!B.emptyChildAt(-1)){l=Z(B.dom);break}n+=B.size}-1==l&&(l=this.contentDOM.childNodes.length);break}h=O}return{node:this.contentDOM,from:e,to:n,fromOffset:o,toOffset:l}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,o=!1){let l=Math.min(e,n),h=Math.max(e,n);for(let R=0,A=0;R<this.children.length;R++){let Q=this.children[R],Me=A+Q.size;if(l>A&&h<Me)return Q.setSelection(e-A-Q.border,n-A-Q.border,r,o);A=Me}let u=this.domFromPos(e,e?-1:1),g=n==e?u:this.domFromPos(n,n?-1:1),O=r.getSelection(),_=!1;if((V||ie)&&e==n){let{node:R,offset:A}=u;if(3==R.nodeType){if(_=!(!A||"\n"!=R.nodeValue[A-1]),_&&A==R.nodeValue.length)for(let Me,Q=R;Q;Q=Q.parentNode){if(Me=Q.nextSibling){"BR"==Me.nodeName&&(u=g={node:Me.parentNode,offset:Z(Me)+1});break}let be=Q.pmViewDesc;if(be&&be.node&&be.node.isBlock)break}}else{let Q=R.childNodes[A-1];_=Q&&("BR"==Q.nodeName||"false"==Q.contentEditable)}}if(V&&O.focusNode&&O.focusNode!=g.node&&1==O.focusNode.nodeType){let R=O.focusNode.childNodes[O.focusOffset];R&&"false"==R.contentEditable&&(o=!0)}if(!(o||_&&ie)&&ne(u.node,u.offset,O.anchorNode,O.anchorOffset)&&ne(g.node,g.offset,O.focusNode,O.focusOffset))return;let B=!1;if((O.extend||e==n)&&!_){O.collapse(u.node,u.offset);try{e!=n&&O.extend(g.node,g.offset),B=!0}catch(R){if(!(R instanceof DOMException))throw R}}if(!B){if(e>n){let A=u;u=g,g=A}let R=document.createRange();R.setEnd(g.node,g.offset),R.setStart(u.node,u.offset),O.removeAllRanges(),O.addRange(R)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,o=0;o<this.children.length;o++){let l=this.children[o],h=r+l.size;if(r==h?e<=h&&n>=r:e<h&&n>r){let u=r+l.border,g=h-l.border;if(e>=u&&n<=g)return this.dirty=e==r||n==h?2:1,void(e!=u||n!=g||!l.contentLost&&l.dom.parentNode==this.contentDOM?l.markDirty(e-u,n-u):l.dirty=3);l.dirty=l.dom!=l.contentDOM||l.dom.parentNode!=this.contentDOM||l.children.length?3:2}r=h}this.dirty=2}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=1==e?2:1;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class U extends I{constructor(e,n,r,o){let l,h=n.type.toDOM;if("function"==typeof h&&(h=h(r,()=>l?l.parent?l.parent.posBeforeChild(l):void 0:o)),!n.type.spec.raw){if(1!=h.nodeType){let u=document.createElement("span");u.appendChild(h),h=u}h.contentEditable="false",h.classList.add("ProseMirror-widget")}super(e,[],h,null),this.widget=n,this.widget=n,l=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return!!n&&n(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class X extends I{constructor(e,n,r,o){super(e,[],n,null),this.textDOM=r,this.text=o}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class re extends I{constructor(e,n,r,o){super(e,[],r,o),this.mark=n}static create(e,n,r,o){let l=o.nodeViews[n.type.name],h=l&&l(n,o,r);return(!h||!h.dom)&&(h=L.PW.renderSpec(document,n.type.spec.toDOM(n,r))),new re(e,n,h.dom,h.contentDOM||h.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),0!=this.dirty){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}}slice(e,n,r){let o=re.create(this.parent,this.mark,!0,r),l=this.children,h=this.size;n<h&&(l=Dt(l,n,h,r)),e>0&&(l=Dt(l,0,e,r));for(let u=0;u<l.length;u++)l[u].parent=o;return o.children=l,o}}class fe extends I{constructor(e,n,r,o,l,h,u,g,O){super(e,[],l,h),this.node=n,this.outerDeco=r,this.innerDeco=o,this.nodeDOM=u,h&&this.updateChildren(g,O)}static create(e,n,r,o,l,h){let g,u=l.nodeViews[n.type.name],O=u&&u(n,l,()=>g?g.parent?g.parent.posBeforeChild(g):void 0:h,r,o),_=O&&O.dom,B=O&&O.contentDOM;if(n.isText)if(_){if(3!=_.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else _=document.createTextNode(n.text);else _||({dom:_,contentDOM:B}=L.PW.renderSpec(document,n.type.spec.toDOM(n)));!B&&!n.isText&&"BR"!=_.nodeName&&(_.hasAttribute("contenteditable")||(_.contentEditable="false"),n.type.spec.draggable&&(_.draggable=!0));let R=_;return _=pe(_,r,n),O?g=new a(e,n,r,o,_,B||null,R,O,l,h+1):n.isText?new i(e,n,r,o,_,R,l):new fe(e,n,r,o,_,B||null,R,l,h+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>L.HY.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,n,r){return 0==this.dirty&&e.eq(this.node)&&Re(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,o=n,l=e.composing?this.localCompositionInfo(e,n):null,h=l&&l.pos>-1?l:null,u=l&&l.pos<0,g=new Ot(this,h&&h.node);(function zn(t,e,n,r){let o=e.locals(t),l=0;if(0==o.length){for(let O=0;O<t.childCount;O++){let _=t.child(O);r(_,o,e.forChild(l,_),O),l+=_.nodeSize}return}let h=0,u=[],g=null;for(let O=0;;){if(h<o.length&&o[h].to==l){let Me,Q=o[h++];for(;h<o.length&&o[h].to==l;)(Me||(Me=[Q])).push(o[h++]);if(Me){Me.sort(Rn);for(let be=0;be<Me.length;be++)n(Me[be],O,!!g)}else n(Q,O,!!g)}let _,B;if(g)B=-1,_=g,g=null;else{if(!(O<t.childCount))break;B=O,_=t.child(O++)}for(let Q=0;Q<u.length;Q++)u[Q].to<=l&&u.splice(Q--,1);for(;h<o.length&&o[h].from<=l&&o[h].to>l;)u.push(o[h++]);let R=l+_.nodeSize;if(_.isText){let Q=R;h<o.length&&o[h].from<Q&&(Q=o[h].from);for(let Me=0;Me<u.length;Me++)u[Me].to<Q&&(Q=u[Me].to);Q<R&&(g=_.cut(Q-l),_=_.cut(0,Q-l),R=Q,B=-1)}r(_,_.isInline&&!_.isLeaf?u.filter(Q=>!Q.inline):u.slice(),e.forChild(l,_),B),l=R}})(this.node,this.innerDeco,(O,_,B)=>{O.spec.marks?g.syncToMarks(O.spec.marks,r,e):O.type.side>=0&&!B&&g.syncToMarks(_==this.node.childCount?L.vc.none:this.node.child(_).marks,r,e),g.placeWidget(O,e,o)},(O,_,B,R)=>{let A;g.syncToMarks(O.marks,r,e),g.findNodeMatch(O,_,B,R)||u&&e.state.selection.from>o&&e.state.selection.to<o+O.nodeSize&&(A=g.findIndexWithChild(l.node))>-1&&g.updateNodeAt(O,_,B,A,e)||g.updateNextNode(O,_,B,e,R)||g.addNode(O,_,B,e,o),o+=O.nodeSize}),g.syncToMarks([],r,e),this.node.isTextblock&&g.addTextblockHacks(),g.destroyRest(),(g.changed||2==this.dirty)&&(h&&this.protectLocalComposition(e,h),f(this.contentDOM,this.children,e),ce&&function Bn(t){if("UL"==t.nodeName||"OL"==t.nodeName){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t),t.style.cssText=e}}(this.dom))}localCompositionInfo(e,n){let{from:r,to:o}=e.state.selection;if(!(e.state.selection instanceof c.Bs)||r<n||o>n+this.node.content.size)return null;let l=e.domSelection(),h=function Fn(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=Se(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(l.focusNode,l.focusOffset);if(!h||!this.dom.contains(h.parentNode))return null;if(this.node.inlineContent){let u=h.nodeValue,g=function Ln(t,e,n,r){for(let o=0,l=0;o<t.childCount&&l<=r;){let h=t.child(o++),u=l;if(l+=h.nodeSize,!h.isText)continue;let g=h.text;for(;o<t.childCount;){let O=t.child(o++);if(l+=O.nodeSize,!O.isText)break;g+=O.text}if(l>=n){let O=u<r?g.lastIndexOf(e,r-u-1):-1;if(O>=0&&O+e.length+u>=n)return u+O;if(n==r&&g.length>=r+e.length-u&&g.slice(r-u,r-u+e.length)==e)return r}}return-1}(this.node.content,u,r-n,o-n);return g<0?null:{node:h,pos:g,text:u}}return{node:h,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:o}){if(this.getDesc(n))return;let l=n;for(;l.parentNode!=this.contentDOM;l=l.parentNode){for(;l.previousSibling;)l.parentNode.removeChild(l.previousSibling);for(;l.nextSibling;)l.parentNode.removeChild(l.nextSibling);l.pmViewDesc&&(l.pmViewDesc=void 0)}let h=new X(this,l,n,o);e.input.compositionNodes.push(h),this.children=Dt(this.children,r,r+o.length,e,h)}update(e,n,r,o){return!(3==this.dirty||!e.sameMarkup(this.node)||(this.updateInner(e,n,r,o),0))}updateInner(e,n,r,o){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(Re(e,this.outerDeco))return;let n=1!=this.nodeDOM.nodeType,r=this.dom;this.dom=w(this.dom,this.nodeDOM,D(this.outerDeco,this.node,n),D(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function x(t,e,n,r,o){return pe(r,e,t),new fe(void 0,t,e,n,r,r,r,o,0)}class i extends fe{constructor(e,n,r,o,l,h,u){super(e,n,r,o,l,null,h,u,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,o){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node)||(this.updateOuterDeco(n),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=0,0))}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,n,r){let o=this.node.cut(e,n),l=document.createTextNode(o.text);return new i(this.parent,o,this.outerDeco,this.innerDeco,l,l,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(0==e||n==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class s extends I{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class a extends fe{constructor(e,n,r,o,l,h,u,g,O,_){super(e,n,r,o,l,h,u,O,_),this.spec=g}update(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){let l=this.spec.update(e,n,r);return l&&this.updateInner(e,n,r,o),l}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,n,r,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):super.setSelection(e,n,r,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function f(t,e,n){let r=t.firstChild,o=!1;for(let l=0;l<e.length;l++){let h=e[l],u=h.dom;if(u.parentNode==t){for(;u!=r;)r=rt(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(u,r);if(h instanceof re){let g=r?r.previousSibling:t.lastChild;f(h.contentDOM,h.children,n),r=g?g.nextSibling:t.firstChild}}for(;r;)r=rt(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const m=function(t){t&&(this.nodeName=t)};m.prototype=Object.create(null);const k=[new m];function D(t,e,n){if(0==t.length)return k;let r=n?k[0]:new m,o=[r];for(let l=0;l<t.length;l++){let h=t[l].type.attrs;if(h){h.nodeName&&o.push(r=new m(h.nodeName));for(let u in h){let g=h[u];null!=g&&(n&&1==o.length&&o.push(r=new m(e.isInline?"span":"div")),"class"==u?r.class=(r.class?r.class+" ":"")+g:"style"==u?r.style=(r.style?r.style+";":"")+g:"nodeName"!=u&&(r[u]=g))}}}return o}function w(t,e,n,r){if(n==k&&r==k)return e;let o=e;for(let l=0;l<r.length;l++){let h=r[l],u=n[l];if(l){let g;u&&u.nodeName==h.nodeName&&o!=t&&(g=o.parentNode)&&g.nodeName.toLowerCase()==h.nodeName||(g=document.createElement(h.nodeName),g.pmIsDeco=!0,g.appendChild(o),u=k[0]),o=g}le(o,u||k[0],h)}return o}function le(t,e,n){for(let r in e)"class"!=r&&"style"!=r&&"nodeName"!=r&&!(r in n)&&t.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let l=0;l<r.length;l++)-1==o.indexOf(r[l])&&t.classList.remove(r[l]);for(let l=0;l<o.length;l++)-1==r.indexOf(o[l])&&t.classList.add(o[l]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let o,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;o=r.exec(e.style);)t.style.removeProperty(o[1])}n.style&&(t.style.cssText+=n.style)}}function pe(t,e,n){return w(t,t,k,D(e,n,1!=t.nodeType))}function Re(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function rt(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Ot{constructor(e,n){this.lock=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function In(t,e){let n=e,r=n.children.length,o=t.childCount,l=new Map,h=[];e:for(;o>0;){let u;for(;;)if(r){let O=n.children[r-1];if(!(O instanceof re)){u=O,r--;break}n=O,r=O.children.length}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let g=u.node;if(g){if(g!=t.child(o-1))break;--o,l.set(u,o),h.push(u)}}return{index:o,matched:l,matches:h.reverse()}}(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let o=0,l=this.stack.length>>1,h=Math.min(l,e.length);for(;o<h&&(o==l-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&!1!==e[o].type.spec.spanning;)o++;for(;o<l;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),l--;for(;l<e.length;){this.stack.push(this.top,this.index+1);let u=-1;for(let g=this.index;g<Math.min(this.index+3,this.top.children.length);g++)if(this.top.children[g].matchesMark(e[l])){u=g;break}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let g=re.create(this.top,e[l],n,r);this.top.children.splice(this.index,0,g),this.top=g,this.changed=!0}this.index=0,l++}}findNodeMatch(e,n,r,o){let h,l=-1;if(o>=this.preMatch.index&&(h=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&h.matchesNode(e,n,r))l=this.top.children.indexOf(h,this.index);else for(let u=this.index,g=Math.min(this.top.children.length,u+5);u<g;u++){let O=this.top.children[u];if(O.matchesNode(e,n,r)&&!this.preMatch.matched.has(O)){l=u;break}}return!(l<0||(this.destroyBetween(this.index,l),this.index++,0))}updateNodeAt(e,n,r,o,l){let h=this.top.children[o];return 3==h.dirty&&h.dom==h.contentDOM&&(h.dirty=2),!!h.update(e,n,r,l)&&(this.destroyBetween(this.index,o),this.index++,!0)}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r)for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o;return-1}e=n}}updateNextNode(e,n,r,o,l){for(let h=this.index;h<this.top.children.length;h++){let u=this.top.children[h];if(u instanceof fe){let g=this.preMatch.matched.get(u);if(null!=g&&g!=l)return!1;let O=u.dom;if((!this.lock||!(O==this.lock||1==O.nodeType&&O.contains(this.lock.parentNode))||e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&3!=u.dirty&&Re(n,u.outerDeco))&&u.update(e,n,r,o))return this.destroyBetween(this.index,h),u.dom!=O&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(e,n,r,o,l){this.top.children.splice(this.index++,0,fe.create(this.top,e,n,r,o,l)),this.changed=!0}placeWidget(e,n,r){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(!o||!o.matchesWidget(e)||e!=o.widget&&o.widget.type.toDOM.parentNode){let l=new U(this.top,e,n,r);this.top.children.splice(this.index++,0,l),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof re;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof i)||/\n$/.test(e.node.text))&&((ie||te)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);"IMG"==e&&(r.className="ProseMirror-separator",r.alt=""),"BR"==e&&(r.className="ProseMirror-trailingBreak");let o=new s(this.top,[],r,null);n!=this.top?n.children.push(o):n.children.splice(this.index++,0,o),this.changed=!0}}}function Rn(t,e){return t.type.side-e.type.side}function Dt(t,e,n,r,o){let l=[];for(let h=0,u=0;h<t.length;h++){let g=t[h],O=u,_=u+=g.size;O>=n||_<=e?l.push(g):(O<e&&l.push(g.slice(0,e-O,r)),o&&(l.push(o),o=void 0),_>n&&l.push(g.slice(n-O,g.size,r)))}return l}function Ht(t,e=null){let n=t.domSelection(),r=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),l=o&&0==o.size,h=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(h<0)return null;let g,O,u=r.resolve(h);if(E(n)){for(g=u;o&&!o.node;)o=o.parent;let _=o.node;if(o&&_.isAtom&&c.qv.isSelectable(_)&&o.parent&&(!_.isInline||!function G(t,e,n){for(let r=0==e,o=e==Se(t);r||o;){if(t==n)return!0;let l=Z(t);if(!(t=t.parentNode))return!1;r=r&&0==l,o=o&&l==Se(t)}}(n.focusNode,n.focusOffset,o.dom))){let B=o.posBefore;O=new c.qv(h==B?u:r.resolve(B))}}else{let _=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(_<0)return null;g=r.resolve(_)}return O||(O=Pt(t,g,u,"pointer"==e||t.state.selection.head<u.pos&&!l?1:-1)),O}function Qt(t){return t.editable?t.hasFocus():nn(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function $e(t,e=!1){let n=t.state.selection;if(Xt(t,n),Qt(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&te){let r=t.domSelection(),o=t.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&ne(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function Un(t){let e=t.domSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,Z(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&ue&&ge<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{let l,h,{anchor:r,head:o}=n;jt&&!(n instanceof c.Bs)&&(n.$from.parent.inlineContent||(l=$t(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(h=$t(t,n.to))),t.docView.setSelection(r,o,t.root,e),jt&&(l&&Gt(l),h&&Gt(h)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function Wn(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=o)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Qt(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const jt=ie||te&&ae<63;function $t(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),o=r<n.childNodes.length?n.childNodes[r]:null,l=r?n.childNodes[r-1]:null;if(ie&&o&&"false"==o.contentEditable)return vt(o);if(!(o&&"false"!=o.contentEditable||l&&"false"!=l.contentEditable)){if(o)return vt(o);if(l)return vt(l)}}function vt(t){return t.contentEditable="true",ie&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Gt(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Xt(t,e){if(e instanceof c.qv){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(en(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else en(t)}function en(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Pt(t,e,n,r){return t.someProp("createSelectionBetween",o=>o(t,e,n))||c.Bs.between(e,n,r)}function tn(t){return(!t.editable||t.root.activeElement==t.dom)&&nn(t)}function nn(t){let e=t.domSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function Nt(t,e){let{$anchor:n,$head:r}=t.selection,o=e>0?n.max(r):n.min(r),l=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return l&&c.Y1.findFrom(l,e)}function st(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function rn(t,e,n){let r=t.state.selection;if(!(r instanceof c.Bs)){if(r instanceof c.qv&&r.node.isInline)return st(t,new c.Bs(e>0?r.$to:r.$from));{let o=Nt(t.state,e);return!!o&&st(t,o)}}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){let o=Nt(t.state,e);return!!(o&&o instanceof c.qv)&&st(t,o)}if(!(de&&n.indexOf("m")>-1)){let h,o=r.$head,l=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!l||l.isText)return!1;let u=e<0?o.pos-l.nodeSize:o.pos;return!!(l.isAtom||(h=t.docView.descAt(u))&&!h.contentDOM)&&(c.qv.isSelectable(l)?st(t,new c.qv(e<0?t.state.doc.resolve(o.pos-l.nodeSize):o)):!!$&&st(t,new c.Bs(t.state.doc.resolve(e<0?u:u+l.nodeSize))))}}function _t(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Ct(t){let e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function wt(t){let e=t.domSelection(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,l,h=!1;for(V&&1==n.nodeType&&r<_t(n)&&Ct(n.childNodes[r])&&(h=!0);;)if(r>0){if(1!=n.nodeType)break;{let u=n.childNodes[r-1];if(Ct(u))o=n,l=--r;else{if(3!=u.nodeType)break;n=u,r=n.nodeValue.length}}}else{if(sn(n))break;{let u=n.previousSibling;for(;u&&Ct(u);)o=n.parentNode,l=Z(u),u=u.previousSibling;if(u)n=u,r=_t(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}h?It(t,e,n,r):o&&It(t,e,o,l)}function At(t){let e=t.domSelection(),n=e.focusNode,r=e.focusOffset;if(!n)return;let l,h,o=_t(n);for(;;)if(r<o){if(1!=n.nodeType)break;if(!Ct(n.childNodes[r]))break;l=n,h=++r}else{if(sn(n))break;{let u=n.nextSibling;for(;u&&Ct(u);)l=u.parentNode,h=Z(u)+1,u=u.nextSibling;if(u)n=u,r=0,o=_t(n);else{if(n=n.parentNode,n==t.dom)break;r=o=0}}}l&&It(t,e,l,h)}function sn(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function It(t,e,n,r){if(E(e)){let l=document.createRange();l.setEnd(n,r),l.setStart(n,r),e.removeAllRanges(),e.addRange(l)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&$e(t)},50)}function on(t,e,n){let r=t.state.selection;if(r instanceof c.Bs&&!r.empty||n.indexOf("s")>-1||de&&n.indexOf("m")>-1)return!1;let{$from:o,$to:l}=r;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let h=Nt(t.state,e);if(h&&h instanceof c.qv)return st(t,h)}if(!o.parent.inlineContent){let h=e<0?o:l,u=r instanceof c.C1?c.Y1.near(h,e):c.Y1.findFrom(h,e);return!!u&&st(t,u)}return!1}function ln(t,e){if(!(t.state.selection instanceof c.Bs))return!0;let{$head:n,$anchor:r,empty:o}=t.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let l=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(l&&!l.isText){let h=t.state.tr;return e<0?h.delete(n.pos-l.nodeSize,n.pos):h.delete(n.pos,n.pos+l.nodeSize),t.dispatch(h),!0}return!1}function an(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function cn(t,e){let n=[],{content:r,openStart:o,openEnd:l}=e;for(;o>1&&l>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,l--;let A=r.firstChild;n.push(A.type.name,A.attrs!=A.type.defaultAttrs?A.attrs:null),r=A.content}let h=t.someProp("clipboardSerializer")||L.PW.fromSchema(t.state.schema),u=yn(),g=u.createElement("div");g.appendChild(h.serializeFragment(r,{document:u}));let _,O=g.firstChild,B=0;for(;O&&1==O.nodeType&&(_=mn[O.nodeName.toLowerCase()]);){for(let A=_.length-1;A>=0;A--){let Q=u.createElement(_[A]);for(;g.firstChild;)Q.appendChild(g.firstChild);g.appendChild(Q),B++}O=g.firstChild}return O&&1==O.nodeType&&O.setAttribute("data-pm-slice",`${o} ${l}${B?` -${B}`:""} ${JSON.stringify(n)}`),{dom:g,text:t.someProp("clipboardTextSerializer",A=>A(e))||e.content.textBetween(0,e.content.size,"\n\n")}}function hn(t,e,n,r,o){let h,u,l=o.parent.type.spec.code;if(!n&&!e)return null;let g=e&&(r||l||!n);if(g){if(t.someProp("transformPastedText",R=>{e=R(e,l||r)}),l)return e?new L.p2(L.HY.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):L.p2.empty;let B=t.someProp("clipboardTextParser",R=>R(e,o,r));if(B)u=B;else{let R=o.marks(),{schema:A}=t.state,Q=L.PW.fromSchema(A);h=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(Me=>{let be=h.appendChild(document.createElement("p"));Me&&be.appendChild(Q.serializeNode(A.text(Me,R)))})}}else t.someProp("transformPastedHTML",B=>{n=B(n)}),h=function Hn(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let o,n=yn().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t);if((o=r&&mn[r[1].toLowerCase()])&&(t=o.map(l=>"<"+l+">").join("")+t+o.map(l=>"</"+l+">").reverse().join("")),n.innerHTML=t,o)for(let l=0;l<o.length;l++)n=n.querySelector(o[l])||n;return n}(n),$&&function Qn(t){let e=t.querySelectorAll(te?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(h);let O=h&&h.querySelector("[data-pm-slice]"),_=O&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(O.getAttribute("data-pm-slice")||"");if(_&&_[3])for(let B=+_[3];B>0&&h.firstChild;B--)h=h.firstChild;if(u||(u=(t.someProp("clipboardParser")||t.someProp("domParser")||L.aw.fromSchema(t.state.schema)).parseSlice(h,{preserveWhitespace:!(!g&&!_),context:o,ruleFromNode:R=>"BR"!=R.nodeName||R.nextSibling||!R.parentNode||Yn.test(R.parentNode.nodeName)?null:{ignore:!0}})),_)u=function jn(t,e){if(!t.size)return t;let r,n=t.content.firstChild.type.schema;try{r=JSON.parse(e)}catch(u){return t}let{content:o,openStart:l,openEnd:h}=t;for(let u=r.length-2;u>=0;u-=2){let g=n.nodes[r[u]];if(!g||g.hasRequiredAttrs())break;o=L.HY.from(g.create(r[u+1],o)),l++,h++}return new L.p2(o,l,h)}(pn(u,+_[1],+_[2]),_[4]);else if(u=L.p2.maxOpen(function Zn(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let l,o=e.node(n).contentMatchAt(e.index(n)),h=[];if(t.forEach(u=>{if(!h)return;let O,g=o.findWrapping(u.type);if(!g)return h=null;if(O=h.length&&l.length&&un(g,l,u,h[h.length-1],0))h[h.length-1]=O;else{h.length&&(h[h.length-1]=fn(h[h.length-1],l.length));let _=dn(u,g);h.push(_),o=o.matchType(_.type),l=g}}),h)return L.HY.from(h)}return t}(u.content,o),!0),u.openStart||u.openEnd){let B=0,R=0;for(let A=u.content.firstChild;B<u.openStart&&!A.type.spec.isolating;B++,A=A.firstChild);for(let A=u.content.lastChild;R<u.openEnd&&!A.type.spec.isolating;R++,A=A.lastChild);u=pn(u,B,R)}return t.someProp("transformPasted",B=>{u=B(u)}),u}const Yn=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function dn(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,L.HY.from(t));return t}function un(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let l=un(t,e,n,r.lastChild,o+1);if(l)return r.copy(r.content.replaceChild(r.childCount-1,l));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(L.HY.from(dn(n,t,o+1))))}}function fn(t,e){if(0==e)return t;let n=t.content.replaceChild(t.childCount-1,fn(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(L.HY.empty,!0);return t.copy(n.append(r))}function Rt(t,e,n,r,o,l){let h=e<0?t.firstChild:t.lastChild,u=h.content;return o<r-1&&(u=Rt(u,e,n,r,o+1,l)),o>=n&&(u=e<0?h.contentMatchAt(0).fillBefore(u,t.childCount>1||l<=o).append(u):u.append(h.contentMatchAt(h.childCount).fillBefore(L.HY.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,h.copy(u))}function pn(t,e,n){return e<t.openStart&&(t=new L.p2(Rt(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new L.p2(Rt(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const mn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let gn=null;function yn(){return gn||(gn=document.implementation.createHTMLDocument("title"))}const ze={};let Ie={};class $n{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ot(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function zt(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Bt(t,r))})}function Bt(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)})}function ei(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function bt(t){return{left:t.clientX,top:t.clientY}}function Ft(t,e,n,r,o){if(-1==r)return!1;let l=t.state.doc.resolve(r);for(let h=l.depth+1;h>0;h--)if(t.someProp(e,u=>h>l.depth?u(t,n,l.nodeAfter,l.before(h),o,!0):u(t,n,l.node(h),l.before(h),o,!1)))return!0;return!1}function gt(t,e,n){t.focused||t.focus();let r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function oi(t,e,n,r){return Ft(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",o=>o(t,e,r))}function li(t,e,n,r){return Ft(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",o=>o(t,e,r))||function ai(t,e,n){if(0!=n.button)return!1;let r=t.state.doc;if(-1==e)return!!r.inlineContent&&(gt(t,c.Bs.create(r,0,r.content.size),"pointer"),!0);let o=r.resolve(e);for(let l=o.depth+1;l>0;l--){let h=l>o.depth?o.nodeAfter:o.node(l),u=o.before(l);if(h.inlineContent)gt(t,c.Bs.create(r,u+1,u+1+h.content.size),"pointer");else{if(!c.qv.isSelectable(h))continue;gt(t,c.qv.create(r,u),"pointer")}return!0}}(t,n,r)}function Lt(t){return St(t)}Ie.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!Mn(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!J||!te||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!ce||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",r=>r(t,n))||function Kn(t,e){let n=e.keyCode,r=function Jn(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||de&&72==n&&"c"==r?ln(t,-1)||wt(t):46==n||de&&68==n&&"c"==r?ln(t,1)||At(t):13==n||27==n||(37==n||de&&66==n&&"c"==r?rn(t,-1,r)||wt(t):39==n||de&&70==n&&"c"==r?rn(t,1,r)||At(t):38==n||de&&80==n&&"c"==r?on(t,-1,r)||wt(t):40==n||de&&78==n&&"c"==r?function qn(t){if(!ie||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelection();if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){let r=e.firstChild;an(t,r,"true"),setTimeout(()=>an(t,r,"false"),20)}return!1}(t)||on(t,1,r)||At(t):r==(de?"m":"c")&&(66==n||73==n||89==n||90==n))}(t,n)?n.preventDefault():ot(t,"key");else{let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",o=>o(t,P(13,"Enter"))),t.input.lastIOSEnter=0)},200)}},Ie.keyup=(t,e)=>{16==e.keyCode&&(t.input.shiftKey=!1)},Ie.keypress=(t,e)=>{let n=e;if(Mn(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||de&&n.metaKey)return;if(t.someProp("handleKeyPress",o=>o(t,n)))return void n.preventDefault();let r=t.state.selection;if(!(r instanceof c.Bs&&r.$from.sameParent(r.$to))){let o=String.fromCharCode(n.charCode);t.someProp("handleTextInput",l=>l(t,r.$from.pos,r.$to.pos,o))||t.dispatch(t.state.tr.insertText(o).scrollIntoView()),n.preventDefault()}};const xn=de?"metaKey":"ctrlKey";ze.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Lt(t),o=Date.now(),l="singleClick";o-t.input.lastClick.time<500&&function ni(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(n,t.input.lastClick)&&!n[xn]&&("singleClick"==t.input.lastClick.type?l="doubleClick":"doubleClick"==t.input.lastClick.type&&(l="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:l};let h=t.posAtCoords(bt(n));!h||("singleClick"==l?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new ci(t,h,n,!!r)):("doubleClick"==l?oi:li)(t,h.pos,h.inside,n)?n.preventDefault():ot(t,"pointer"))};class ci{constructor(e,n,r,o){let l,h;if(this.view=e,this.pos=n,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[xn],this.allowDefault=r.shiftKey,n.inside>-1)l=e.state.doc.nodeAt(n.inside),h=n.inside;else{let _=e.state.doc.resolve(n.pos);l=_.parent,h=_.depth?_.before():0}const u=o?null:r.target,g=u?e.docView.nearestDesc(u,!0):null;this.target=g?g.dom:null;let{selection:O}=e.state;(0==r.button&&l.type.spec.draggable&&!1!==l.type.spec.selectable||O instanceof c.qv&&O.from<=h&&O.to>h)&&(this.mightDrag={node:l,pos:h,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!V||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ot(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>$e(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(bt(e))),this.allowDefault||!n?ot(this.view,"pointer"):function si(t,e,n,r,o){return Ft(t,"handleClickOn",e,n,r)||t.someProp("handleClick",l=>l(t,e,r))||(o?function ri(t,e){if(-1==e)return!1;let r,o,n=t.state.selection;n instanceof c.qv&&(r=n.node);let l=t.state.doc.resolve(e);for(let h=l.depth+1;h>0;h--){let u=h>l.depth?l.nodeAfter:l.node(h);if(c.qv.isSelectable(u)){o=r&&n.$from.depth>0&&h>=n.$from.depth&&l.before(n.$from.depth+1)==n.$from.pos?l.before(n.$from.depth):l.before(h);break}}return null!=o&&(gt(t,c.qv.create(t.state.doc,o),"pointer"),!0)}(t,n):function ii(t,e){if(-1==e)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&c.qv.isSelectable(r))&&(gt(t,new c.qv(n),"pointer"),!0)}(t,n))}(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||ie&&this.mightDrag&&!this.mightDrag.node.isAtom||te&&!(this.view.state.selection instanceof c.Bs)&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(gt(this.view,c.Y1.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):ot(this.view,"pointer")}move(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),ot(this.view,"pointer"),0==e.buttons&&this.done()}}function Mn(t,e){return!!t.composing||!!(ie&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}ze.touchdown=t=>{Lt(t),ot(t,"pointer")},ze.contextmenu=t=>Lt(t);const hi=J?5e3:-1;function Cn(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>St(t),e))}function kn(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=function di(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function St(t,e=!1){if(!(J&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),kn(t),e||t.docView&&t.docView.dirty){let n=Ht(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}Ie.compositionstart=Ie.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>!1===r.type.spec.inclusive)))t.markCursor=t.state.storedMarks||n.marks(),St(t,!0),t.markCursor=null;else if(St(t),V&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelection();for(let o=r.focusNode,l=r.focusOffset;o&&1==o.nodeType&&0!=l;){let h=l<0?o.lastChild:o.childNodes[l-1];if(!h)break;if(3==h.nodeType){r.collapse(h,h.nodeValue.length);break}o=h,l=-1}}t.input.composing=!0}Cn(t,hi)},Ie.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,Cn(t,20))};const yt=ue&&ge<15||ce&&K<604;function Wt(t,e,n,r){let o=hn(t,e,n,t.input.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",u=>u(t,r,o||L.p2.empty)))return!0;if(!o)return!1;let l=function fi(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),h=l?t.state.tr.replaceSelectionWith(l,t.input.shiftKey):t.state.tr.replaceSelection(o);return t.dispatch(h.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}ze.copy=Ie.cut=(t,e)=>{let n=e,r=t.state.selection,o="cut"==n.type;if(r.empty)return;let l=yt?null:n.clipboardData,h=r.content(),{dom:u,text:g}=cn(t,h);l?(n.preventDefault(),l.clearData(),l.setData("text/html",u.innerHTML),l.setData("text/plain",g)):function ui(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}(t,u),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Ie.paste=(t,e)=>{let n=e;if(t.composing&&!J)return;let r=yt?null:n.clipboardData;r&&Wt(t,r.getData("text/plain"),r.getData("text/html"),n)?n.preventDefault():function pi(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Wt(t,r.value,null,e):Wt(t,r.textContent,r.innerHTML,e)},50)}(t,n)};class mi{constructor(e,n){this.slice=e,this.move=n}}const On=de?"altKey":"ctrlKey";ze.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o=t.state.selection,l=o.empty?null:t.posAtCoords(bt(n));if(!(l&&l.pos>=o.from&&l.pos<=(o instanceof c.qv?o.to-1:o.to)))if(r&&r.mightDrag)t.dispatch(t.state.tr.setSelection(c.qv.create(t.state.doc,r.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let O=t.docView.nearestDesc(n.target,!0);O&&O.node.type.spec.draggable&&O!=t.docView&&t.dispatch(t.state.tr.setSelection(c.qv.create(t.state.doc,O.posBefore)))}let h=t.state.selection.content(),{dom:u,text:g}=cn(t,h);n.dataTransfer.clearData(),n.dataTransfer.setData(yt?"Text":"text/html",u.innerHTML),n.dataTransfer.effectAllowed="copyMove",yt||n.dataTransfer.setData("text/plain",g),t.dragging=new mi(h,!n[On])},ze.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)},Ie.dragover=Ie.dragenter=(t,e)=>e.preventDefault(),Ie.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let o=t.posAtCoords(bt(n));if(!o)return;let l=t.state.doc.resolve(o.pos);if(!l)return;let h=r&&r.slice;h?t.someProp("transformPasted",Q=>{h=Q(h)}):h=hn(t,n.dataTransfer.getData(yt?"Text":"text/plain"),yt?null:n.dataTransfer.getData("text/html"),!1,l);let u=!(!r||n[On]);if(t.someProp("handleDrop",Q=>Q(t,n,h||L.p2.empty,u)))return void n.preventDefault();if(!h)return;n.preventDefault();let g=h?(0,se.nj)(t.state.doc,l.pos,h):l.pos;null==g&&(g=l.pos);let O=t.state.tr;u&&O.deleteSelection();let _=O.mapping.map(g),B=0==h.openStart&&0==h.openEnd&&1==h.content.childCount,R=O.doc;if(B?O.replaceRangeWith(_,_,h.content.firstChild):O.replaceRange(_,_,h),O.doc.eq(R))return;let A=O.doc.resolve(_);if(B&&c.qv.isSelectable(h.content.firstChild)&&A.nodeAfter&&A.nodeAfter.sameMarkup(h.content.firstChild))O.setSelection(new c.qv(A));else{let Q=O.mapping.map(g);O.mapping.maps[O.mapping.maps.length-1].forEach((Me,be,ve,Ve)=>Q=Ve),O.setSelection(Pt(t,A,O.doc.resolve(Q)))}t.focus(),t.dispatch(O.setMeta("uiEvent","drop"))},ze.focus=t=>{t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelection())&&$e(t)},20))},ze.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},ze.beforeinput=(t,e)=>{if(te&&J&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",l=>l(t,P(8,"Backspace")))))return;let{$cursor:o}=t.state.selection;o&&o.pos>0&&t.dispatch(t.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let t in Ie)ze[t]=Ie[t];function kt(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Ut{constructor(e,n){this.toDOM=e,this.spec=n||lt,this.side=this.spec.side||0}map(e,n,r,o){let{pos:l,deleted:h}=e.mapResult(n.from+o,this.side<0?-1:1);return h?null:new Le(l-r,l-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Ut&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&kt(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ge{constructor(e,n){this.attrs=e,this.spec=n||lt}map(e,n,r,o){let l=e.map(n.from+o,this.spec.inclusiveStart?-1:1)-r,h=e.map(n.to+o,this.spec.inclusiveEnd?1:-1)-r;return l>=h?null:new Le(l,h,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Ge&&kt(this.attrs,e.attrs)&&kt(this.spec,e.spec)}static is(e){return e.type instanceof Ge}destroy(){}}class Vt{constructor(e,n){this.attrs=e,this.spec=n||lt}map(e,n,r,o){let l=e.mapResult(n.from+o,1);if(l.deleted)return null;let h=e.mapResult(n.to+o,-1);return h.deleted||h.pos<=l.pos?null:new Le(l.pos-r,h.pos-r,this)}valid(e,n){let l,{index:r,offset:o}=e.content.findIndex(n.from);return o==n.from&&!(l=e.child(r)).isText&&o+l.nodeSize==n.to}eq(e){return this==e||e instanceof Vt&&kt(this.attrs,e.attrs)&&kt(this.spec,e.spec)}destroy(){}}class Le{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Le(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Le(e,e,new Ut(n,r))}static inline(e,n,r,o){return new Le(e,n,new Ge(r,o))}static node(e,n,r,o){return new Le(e,n,new Vt(r,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ge}}const xt=[],lt={};class we{constructor(e,n){this.local=e.length?e:xt,this.children=n.length?n:xt}static create(e,n){return n.length?Tt(n,e,0,lt):Ae}find(e,n,r){let o=[];return this.findInner(null==e?0:e,null==n?1e9:n,o,0,r),o}findInner(e,n,r,o,l){for(let h=0;h<this.local.length;h++){let u=this.local[h];u.from<=n&&u.to>=e&&(!l||l(u.spec))&&r.push(u.copy(u.from+o,u.to+o))}for(let h=0;h<this.children.length;h+=3)if(this.children[h]<n&&this.children[h+1]>e){let u=this.children[h]+1;this.children[h+2].findInner(e-u,n-u,r,o+u,l)}}map(e,n,r){return this==Ae||0==e.maps.length?this:this.mapInner(e,n,0,0,r||lt)}mapInner(e,n,r,o,l){let h;for(let u=0;u<this.local.length;u++){let g=this.local[u].map(e,r,o);g&&g.type.valid(n,g)?(h||(h=[])).push(g):l.onRemove&&l.onRemove(this.local[u].spec)}return this.children.length?function gi(t,e,n,r,o,l,h){let u=t.slice(),g=(_,B,R,A)=>{for(let Q=0;Q<u.length;Q+=3){let be,Me=u[Q+1];if(Me<0||_>Me+l)continue;let ve=u[Q]+l;B>=ve?u[Q+1]=_<=ve?-2:-1:R>=o&&(be=A-R-(B-_))&&(u[Q]+=be,u[Q+1]+=be)}};for(let _=0;_<n.maps.length;_++)n.maps[_].forEach(g);let O=!1;for(let _=0;_<u.length;_+=3)if(u[_+1]<0){if(-2==u[_+1]){O=!0,u[_+1]=-1;continue}let B=n.map(t[_]+l),R=B-o;if(R<0||R>=r.content.size){O=!0;continue}let Q=n.map(t[_+1]+l,-1)-o,{index:Me,offset:be}=r.content.findIndex(R),ve=r.maybeChild(Me);if(ve&&be==R&&be+ve.nodeSize==Q){let Ve=u[_+2].mapInner(n,ve,B+1,t[_]+l+1,h);Ve!=Ae?(u[_]=R,u[_+1]=Q,u[_+2]=Ve):(u[_+1]=-2,O=!0)}else O=!0}if(O){let _=function yi(t,e,n,r,o,l,h){function u(g,O){for(let _=0;_<g.local.length;_++){let B=g.local[_].map(r,o,O);B?n.push(B):h.onRemove&&h.onRemove(g.local[_].spec)}for(let _=0;_<g.children.length;_+=3)u(g.children[_+2],g.children[_]+O+1)}for(let g=0;g<t.length;g+=3)-1==t[g+1]&&u(t[g+2],e[g]+l+1);return n}(u,t,e,n,o,l,h),B=Tt(_,r,0,h);e=B.local;for(let R=0;R<u.length;R+=3)u[R+1]<0&&(u.splice(R,3),R-=3);for(let R=0,A=0;R<B.children.length;R+=3){let Q=B.children[R];for(;A<u.length&&u[A]<Q;)A+=3;u.splice(A,0,B.children[R],B.children[R+1],B.children[R+2])}}return new we(e.sort(at),u)}(this.children,h||[],e,n,r,o,l):h?new we(h.sort(at),xt):Ae}add(e,n){return n.length?this==Ae?we.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let o,l=0;e.forEach((u,g)=>{let _,O=g+r;if(_=bn(n,u,O)){for(o||(o=this.children.slice());l<o.length&&o[l]<g;)l+=3;o[l]==g?o[l+2]=o[l+2].addInner(u,_,O+1):o.splice(l,0,g,g+u.nodeSize,Tt(_,u,O+1,lt)),l+=3}});let h=_n(l?Sn(n):n,-r);for(let u=0;u<h.length;u++)h[u].type.valid(e,h[u])||h.splice(u--,1);return new we(h.length?this.local.concat(h).sort(at):this.local,o||this.children)}remove(e){return 0==e.length||this==Ae?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,o=this.local;for(let l=0;l<r.length;l+=3){let h,u=r[l]+n,g=r[l+1]+n;for(let B,_=0;_<e.length;_++)(B=e[_])&&B.from>u&&B.to<g&&(e[_]=null,(h||(h=[])).push(B));if(!h)continue;r==this.children&&(r=this.children.slice());let O=r[l+2].removeInner(h,u+1);O!=Ae?r[l+2]=O:(r.splice(l,3),l-=3)}if(o.length)for(let h,l=0;l<e.length;l++)if(h=e[l])for(let u=0;u<o.length;u++)o[u].eq(h,n)&&(o==this.local&&(o=this.local.slice()),o.splice(u--,1));return r==this.children&&o==this.local?this:o.length||r.length?new we(o,r):Ae}forChild(e,n){if(this==Ae)return this;if(n.isLeaf)return we.empty;let r,o;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=e){this.children[u]==e&&(r=this.children[u+2]);break}let l=e+1,h=l+n.content.size;for(let u=0;u<this.local.length;u++){let g=this.local[u];if(g.from<h&&g.to>l&&g.type instanceof Ge){let O=Math.max(l,g.from)-l,_=Math.min(h,g.to)-l;O<_&&(o||(o=[])).push(g.copy(O,_))}}if(o){let u=new we(o.sort(at),xt);return r?new Xe([u,r]):u}return r||Ae}eq(e){if(this==e)return!0;if(!(e instanceof we)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return qt(this.localsInner(e))}localsInner(e){if(this==Ae)return xt;if(e.inlineContent||!this.local.some(Ge.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ge||n.push(this.local[r]);return n}}we.empty=new we([],[]),we.removeOverlap=qt;const Ae=we.empty;class Xe{constructor(e){this.members=e}map(e,n){const r=this.members.map(o=>o.map(e,n,lt));return Xe.from(r)}forChild(e,n){if(n.isLeaf)return we.empty;let r=[];for(let o=0;o<this.members.length;o++){let l=this.members[o].forChild(e,n);l!=Ae&&(l instanceof Xe?r=r.concat(l.members):r.push(l))}return Xe.from(r)}eq(e){if(!(e instanceof Xe)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let o=0;o<this.members.length;o++){let l=this.members[o].localsInner(e);if(l.length)if(n){r&&(n=n.slice(),r=!1);for(let h=0;h<l.length;h++)n.push(l[h])}else n=l}return n?qt(r?n:n.sort(at)):xt}static from(e){switch(e.length){case 0:return Ae;case 1:return e[0];default:return new Xe(e)}}}function _n(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let o=t[r];n.push(new Le(o.from+e,o.to+e,o.type))}return n}function bn(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,o=null;for(let h,l=0;l<t.length;l++)(h=t[l])&&h.from>n&&h.to<r&&((o||(o=[])).push(h),t[l]=null);return o}function Sn(t){let e=[];for(let n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Tt(t,e,n,r){let o=[],l=!1;e.forEach((u,g)=>{let O=bn(t,u,g+n);if(O){l=!0;let _=Tt(O,u,n+g+1,r);_!=Ae&&o.push(g,g+u.nodeSize,_)}});let h=_n(l?Sn(t):t,-n).sort(at);for(let u=0;u<h.length;u++)h[u].type.valid(e,h[u])||(r.onRemove&&r.onRemove(h[u].spec),h.splice(u--,1));return h.length||o.length?new we(h,o):Ae}function at(t,e){return t.from-e.from||t.to-e.to}function qt(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let o=n+1;o<e.length;o++){let l=e[o];if(l.from!=r.from){l.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,l.from),Tn(e,o,r.copy(l.from,r.to)));break}l.to!=r.to&&(e==t&&(e=t.slice()),e[o]=l.copy(l.from,r.to),Tn(e,o+1,l.copy(r.to,l.to)))}}return e}function Tn(t,e,n){for(;e<t.length&&at(n,t[e])>0;)e++;t.splice(e,0,n)}function Jt(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Ae&&e.push(r)}),t.cursorWrapper&&e.push(we.create(t.state.doc,[t.cursorWrapper.deco])),Xe.from(e)}const xi={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Mi=ue&&ge<=11;class Ci{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class ki{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Ci,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let o=0;o<r.length;o++)this.queue.push(r[o]);ue&&ge<=11&&r.some(o=>"childList"==o.type&&o.removedNodes.length||"characterData"==o.type&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),Mi&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,xi)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(tn(this.view)){if(this.suppressingSelectionUpdates)return $e(this.view);if(ue&&ge<=11&&!this.view.state.selection.empty){let e=this.view.domSelection();if(e.focusNode&&ne(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(e){if(0==e.rangeCount)return!0;let n=e.getRangeAt(0).commonAncestorContainer,r=this.view.docView.nearestDesc(n);return r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);let n=this.view.domSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&tn(this.view)&&!this.ignoreSelectionChange(n),o=-1,l=-1,h=!1,u=[];if(this.view.editable)for(let g=0;g<e.length;g++){let O=this.registerMutation(e[g],u);O&&(o=o<0?O.from:Math.min(O.from,o),l=l<0?O.to:Math.max(O.to,l),O.typeOver&&(h=!0))}if(V&&u.length>1){let g=u.filter(O=>"BR"==O.nodeName);if(2==g.length){let O=g[0],_=g[1];O.parentNode&&O.parentNode.parentNode==_.parentNode?_.remove():O.remove()}}(o>-1||r)&&(o>-1&&(this.view.docView.markDirty(o,l),function Oi(t){En||(En=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}(this.view)),this.handleDOMChange(o,l,h,u),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(n)||$e(this.view),this.currentSelection.set(n))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(r==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if("childList"==e.type){for(let _=0;_<e.addedNodes.length;_++)n.push(e.addedNodes[_]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let o=e.previousSibling,l=e.nextSibling;if(ue&&ge<=11&&e.addedNodes.length)for(let _=0;_<e.addedNodes.length;_++){let{previousSibling:B,nextSibling:R}=e.addedNodes[_];(!B||Array.prototype.indexOf.call(e.addedNodes,B)<0)&&(o=B),(!R||Array.prototype.indexOf.call(e.addedNodes,R)<0)&&(l=R)}let h=o&&o.parentNode==e.target?Z(o)+1:0,u=r.localPosFromDOM(e.target,h,-1),g=l&&l.parentNode==e.target?Z(l):e.target.childNodes.length;return{from:u,to:r.localPosFromDOM(e.target,g,1)}}return"attributes"==e.type?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let En=!1;function bi(t){let e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(ie&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||ie&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Dn(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Pt(t,e.resolve(n.anchor),e.resolve(n.head))}function Kt(t,e,n){let r=t.depth,o=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n){let l=t.node(r).maybeChild(t.indexAfter(r));for(;l&&!l.isLeaf;)l=l.firstChild,o++}return o}class vi{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new $n,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(An),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Nn(this),Pn(this),this.nodeViews=wn(this),this.docView=x(this.state.doc,vn(this),Jt(this),this.dom,this),this.domObserver=new ki(this,(r,o,l,h)=>function Si(t,e,n,r,o){if(e<0){let ke=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,tt=Ht(t,ke);if(tt&&!t.state.selection.eq(tt)){let Zt=t.state.tr.setSelection(tt);"pointer"==ke?Zt.setMeta("pointer",!0):"key"==ke&&Zt.scrollIntoView(),t.dispatch(Zt)}return}let l=t.state.doc.resolve(e),h=l.sharedDepth(n);e=l.before(h+1),n=t.state.doc.resolve(n).after(h+1);let u=t.state.selection,g=function _i(t,e,n){let O,{node:r,fromOffset:o,toOffset:l,from:h,to:u}=t.docView.parseRange(e,n),g=t.domSelection(),_=g.anchorNode;if(_&&t.dom.contains(1==_.nodeType?_:_.parentNode)&&(O=[{node:_,offset:g.anchorOffset}],E(g)||O.push({node:g.focusNode,offset:g.focusOffset})),te&&8===t.input.lastKeyCode)for(let be=l;be>o;be--){let ve=r.childNodes[be-1],Ve=ve.pmViewDesc;if("BR"==ve.nodeName&&!Ve){l=be;break}if(!Ve||Ve.size)break}let B=t.state.doc,R=t.someProp("domParser")||L.aw.fromSchema(t.state.schema),A=B.resolve(h),Q=null,Me=R.parse(r,{topNode:A.parent,topMatch:A.parent.contentMatchAt(A.index()),topOpen:!0,from:o,to:l,preserveWhitespace:"pre"!=A.parent.type.whitespace||"full",findPositions:O,ruleFromNode:bi,context:A});if(O&&null!=O[0].pos){let be=O[0].pos,ve=O[1]&&O[1].pos;null==ve&&(ve=be),Q={anchor:be+h,head:ve+h}}return{doc:Me,sel:Q,from:h,to:u}}(t,e,n);if(te&&t.cursorWrapper&&g.sel&&g.sel.anchor==t.cursorWrapper.deco.from&&g.sel.head==g.sel.anchor){let ke=t.cursorWrapper.deco.type.toDOM.nextSibling,tt=ke&&ke.nodeValue?ke.nodeValue.length:1;g.sel={anchor:g.sel.anchor+tt,head:g.sel.anchor+tt}}let B,R,O=t.state.doc,_=O.slice(g.from,g.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(B=t.state.selection.to,R="end"):(B=t.state.selection.from,R="start"),t.input.lastKeyCode=null;let A=function Di(t,e,n,r,o){let l=t.findDiffStart(e,n);if(null==l)return null;let{a:h,b:u}=t.findDiffEnd(e,n+t.size,n+e.size);return"end"==o&&(r-=h+Math.max(0,l-Math.min(h,u))-l),h<l&&t.size<e.size?(l-=r<=l&&r>=h?l-r:0,u=l+(u-h),h=l):u<l&&(l-=r<=l&&r>=u?l-r:0,h=l+(h-u),u=l),{start:l,endA:h,endB:u}}(_.content,g.doc.content,g.from,B,R);if((ce&&t.input.lastIOSEnter>Date.now()-225||J)&&o.some(ke=>"DIV"==ke.nodeName||"P"==ke.nodeName)&&(!A||A.endA>=A.endB)&&t.someProp("handleKeyDown",ke=>ke(t,P(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(!A){if(!(r&&u instanceof c.Bs&&!u.empty&&u.$head.sameParent(u.$anchor))||t.composing||g.sel&&g.sel.anchor!=g.sel.head){if(g.sel){let ke=Dn(t,t.state.doc,g.sel);ke&&!ke.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(ke))}return}A={start:u.from,endA:u.to,endB:u.to}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&A.start==A.endB&&t.state.selection instanceof c.Bs&&(A.start>t.state.selection.from&&A.start<=t.state.selection.from+2&&t.state.selection.from>=g.from?A.start=t.state.selection.from:A.endA<t.state.selection.to&&A.endA>=t.state.selection.to-2&&t.state.selection.to<=g.to&&(A.endB+=t.state.selection.to-A.endA,A.endA=t.state.selection.to)),ue&&ge<=11&&A.endB==A.start+1&&A.endA==A.start&&A.start>g.from&&" \xa0"==g.doc.textBetween(A.start-g.from-1,A.start-g.from+1)&&(A.start--,A.endA--,A.endB--);let Ve,Q=g.doc.resolveNoCache(A.start-g.from),Me=g.doc.resolveNoCache(A.endB-g.from),be=O.resolve(A.start),ve=Q.sameParent(Me)&&Q.parent.inlineContent&&be.end()>=A.endA;if((ce&&t.input.lastIOSEnter>Date.now()-225&&(!ve||o.some(ke=>"DIV"==ke.nodeName||"P"==ke.nodeName))||!ve&&Q.pos<g.doc.content.size&&(Ve=c.Y1.findFrom(g.doc.resolve(Q.pos+1),1,!0))&&Ve.head==Me.pos)&&t.someProp("handleKeyDown",ke=>ke(t,P(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(t.state.selection.anchor>A.start&&function Ei(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||Kt(r,!0,!1)<o.pos)return!1;let l=t.resolve(e);if(l.parentOffset<l.parent.content.size||!l.parent.isTextblock)return!1;let h=t.resolve(Kt(l,!0,!0));return!(!h.parent.isTextblock||h.pos>n||Kt(h,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(h.parent.content)}(O,A.start,A.endA,Q,Me)&&t.someProp("handleKeyDown",ke=>ke(t,P(8,"Backspace"))))return void(J&&te&&t.domObserver.suppressSelectionUpdates());te&&J&&A.endB==A.start&&(t.input.lastAndroidDelete=Date.now()),J&&!ve&&Q.start()!=Me.start()&&0==Me.parentOffset&&Q.depth==Me.depth&&g.sel&&g.sel.anchor==g.sel.head&&g.sel.head==A.endA&&(A.endB-=2,Me=g.doc.resolveNoCache(A.endB-g.from),setTimeout(()=>{t.someProp("handleKeyDown",function(ke){return ke(t,P(13,"Enter"))})},20));let We,Yt,Et,et=A.start,ct=A.endA;if(ve)if(Q.pos==Me.pos)ue&&ge<=11&&0==Q.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>$e(t),20)),We=t.state.tr.delete(et,ct),Yt=O.resolve(A.start).marksAcross(O.resolve(A.endA));else if(A.endA==A.endB&&(Et=function Ti(t,e){let h,u,g,n=t.firstChild.marks,r=e.firstChild.marks,o=n,l=r;for(let _=0;_<r.length;_++)o=r[_].removeFromSet(o);for(let _=0;_<n.length;_++)l=n[_].removeFromSet(l);if(1==o.length&&0==l.length)u=o[0],h="add",g=_=>_.mark(u.addToSet(_.marks));else{if(0!=o.length||1!=l.length)return null;u=l[0],h="remove",g=_=>_.mark(u.removeFromSet(_.marks))}let O=[];for(let _=0;_<e.childCount;_++)O.push(g(e.child(_)));if(L.HY.from(O).eq(t))return{mark:u,type:h}}(Q.parent.content.cut(Q.parentOffset,Me.parentOffset),be.parent.content.cut(be.parentOffset,A.endA-be.start()))))We=t.state.tr,"add"==Et.type?We.addMark(et,ct,Et.mark):We.removeMark(et,ct,Et.mark);else if(Q.parent.child(Q.index()).isText&&Q.index()==Me.index()-(Me.textOffset?0:1)){let ke=Q.parent.textBetween(Q.parentOffset,Me.parentOffset);if(t.someProp("handleTextInput",tt=>tt(t,et,ct,ke)))return;We=t.state.tr.insertText(ke,et,ct)}if(We||(We=t.state.tr.replace(et,ct,g.doc.slice(A.start-g.from,A.endB-g.from))),g.sel){let ke=Dn(t,We.doc,g.sel);ke&&!(te&&J&&t.composing&&ke.empty&&(A.start!=A.endB||t.input.lastAndroidDelete<Date.now()-100)&&(ke.head==et||ke.head==We.mapping.map(ct)-1)||ue&&ke.empty&&ke.head==et)&&We.setSelection(ke)}Yt&&We.ensureMarks(Yt),t.dispatch(We.scrollIntoView())}(this,r,o,l,h)),this.domObserver.start(),function Gn(t){for(let e in ze){let n=ze[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{ei(t,r)&&!Bt(t,r)&&(t.editable||!(r.type in Ie))&&n(t,r)})}ie&&t.dom.addEventListener("input",()=>null),zt(t)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&zt(this),this._props=e,e.plugins&&(e.plugins.forEach(An),this.directPlugins=e.plugins),this.updateStateInner(e.state,!0)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this.state.plugins!=e.plugins)}updateStateInner(e,n){let r=this.state,o=!1,l=!1;if(e.storedMarks&&this.composing&&(kn(this),l=!0),this.state=e,n){let B=wn(this);(function Ni(t,e){let n=0,r=0;for(let o in t){if(t[o]!=e[o])return!0;n++}for(let o in e)r++;return n!=r})(B,this.nodeViews)&&(this.nodeViews=B,o=!0),zt(this)}this.editable=Nn(this),Pn(this);let h=Jt(this),u=vn(this),g=n?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",O=o||!this.docView.matchesNode(e.doc,u,h);(O||!e.selection.eq(r.selection))&&(l=!0);let _="preserve"==g&&l&&null==this.dom.style.overflowAnchor&&function Ee(t){let r,o,e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top);for(let l=(e.left+e.right)/2,h=n+1;h<Math.min(innerHeight,e.bottom);h+=5){let u=t.root.elementFromPoint(l,h);if(!u||u==t.dom||!t.dom.contains(u))continue;let g=u.getBoundingClientRect();if(g.top>=n-20){r=u,o=g.top;break}}return{refDOM:r,refTop:o,stack:Pe(t.dom)}}(this);if(l){this.domObserver.stop();let B=O&&(ue||te)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function Pi(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,e.selection);if(O){let R=te?this.trackWrites=this.domSelection().focusNode:null;(o||!this.docView.update(e.doc,u,h,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=x(e.doc,u,h,this.dom,this)),R&&!this.trackWrites&&(B=!0)}B||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function Vn(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelection();return ne(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?$e(this,B):(Xt(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==g)this.dom.scrollTop=0;else if("to selection"==g){let B=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",R=>R(this)))if(e.selection instanceof c.qv){let R=this.docView.domAfterPos(e.selection.from);1==R.nodeType&&_e(this,R.getBoundingClientRect(),B)}else _e(this,this.coordsAtPos(e.selection.head,1),B)}else _&&function De({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;qe(n,0==r?0:r-e)}(_)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}}someProp(e,n){let o,r=this._props&&this._props[e];if(null!=r&&(o=n?n(r):r))return o;for(let h=0;h<this.directPlugins.length;h++){let u=this.directPlugins[h].props[e];if(null!=u&&(o=n?n(u):u))return o}let l=this.state.plugins;if(l)for(let h=0;h<l.length;h++){let u=l[h].props[e];if(null!=u&&(o=n?n(u):u))return o}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function ht(t){if(t.setActive)return t.setActive();if(Je)return t.focus(Je);let e=Pe(t);t.focus(null==Je?{get preventScroll(){return Je={preventScroll:!0},!0}}:void 0),Je||(Je=!1,qe(e,0))}(this.dom),$e(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n;return e||document}posAtCoords(e){return ft(this,e)}coordsAtPos(e,n=1){return it(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let o=this.docView.posFromDOM(e,n,r);if(null==o)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,n){return function p(t,e,n){return Ze==e&&S==n?d:(Ze=e,S=n,d="up"==n||"down"==n?function mt(t,e,n){let r=e.selection,o="up"==n?r.$from:r.$to;return pt(t,e,()=>{let{node:l}=t.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let u=t.docView.nearestDesc(l,!0);if(!u)break;if(u.node.isBlock){l=u.dom;break}l=u.dom.parentNode}let h=it(t,o.pos,1);for(let u=l.firstChild;u;u=u.nextSibling){let g;if(1==u.nodeType)g=u.getClientRects();else{if(3!=u.nodeType)continue;g=he(u,0,u.nodeValue.length).getClientRects()}for(let O=0;O<g.length;O++){let _=g[O];if(_.bottom>_.top+1&&("up"==n?h.top-_.top>2*(_.bottom-h.top):_.bottom-h.bottom>2*(h.bottom-_.top)))return!1}}return!0})}(t,e,n):function Be(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,l=!o,h=o==r.parent.content.size,u=t.domSelection();return Qe.test(r.parent.textContent)&&u.modify?pt(t,e,()=>{let g=u.getRangeAt(0),O=u.focusNode,_=u.focusOffset,B=u.caretBidiLevel;u.modify("move",n,"character");let A=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==u.focusNode.nodeType?u.focusNode:u.focusNode.parentNode)||O==u.focusNode&&_==u.focusOffset;return u.removeAllRanges(),u.addRange(g),null!=B&&(u.caretBidiLevel=B),A}):"left"==n||"backward"==n?l:h}(t,e,n))}(this,n||this.state,e)}destroy(){!this.docView||(function Xn(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Jt(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function ti(t,e){!Bt(t,e)&&ze[e.type]&&(t.editable||!(e.type in Ie))&&ze[e.type](t,e)}(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelection(){return this.root.getSelection()}}function vn(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),e.translate="no",t.someProp("attributes",n=>{if("function"==typeof n&&(n=n(t.state)),n)for(let r in n)"class"==r&&(e.class+=" "+n[r]),"style"==r?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&"contenteditable"!=r&&"nodeName"!=r&&(e[r]=String(n[r]))}),[Le.node(0,t.state.doc.content.size,e)]}function Pn(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Le.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Nn(t){return!t.someProp("editable",e=>!1===e(t.state))}function wn(t){let e=Object.create(null);function n(r){for(let o in r)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=r[o])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function An(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);