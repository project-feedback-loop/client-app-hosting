"use strict";(self.webpackChunkfeedback_loop_client=self.webpackChunkfeedback_loop_client||[]).push([[262],{7262:(ct,_,r)=>{r.r(_),r.d(_,{NewEntityModule:()=>X});var d=r(914),m=r(9646),t=r(5e3),f=r(7465),l=r(9826),y=r(8793),g=r(6335),h=r(6101),C=r(9033),w=r(6832),k=r(4419),v=r(3455),x=r(9565),p=r(3616),u=r(9352),T=r(4817),c=r(9808),M=r(7797),N=r(4933),q=r(6762),E=r(5405),Z=r(5499);function A(n,a){1&n&&(t.TgZ(0,"span",18),t._uU(1," arrow_back "),t.qZA())}const b=function(n){return{opacity:n}};function Q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().postEntity()}),t._uU(1,"Post"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("type","primary")("disabled",e.canPostEntity())("ngStyle",t.VKq(5,b,e.canPostEntity()?1:.5))("inline",!0)("size","small")}}function J(n,a){if(1&n&&t._UZ(0,"img",20),2&n){const e=t.oxw();t.Q6J("src",e.user.picture,t.LSH)}}function P(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"markdown-editor",21),t.NdJ("selectedMention",function(i){return t.CHM(e),t.oxw().getMention(i)})("jsonContentChange",function(i){return t.CHM(e),t.oxw().request.content=i})("content",function(i){return t.CHM(e),t.oxw().request.rawContent=i.raw})("selectedTag",function(i){return t.CHM(e),t.oxw().getTag(i)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("tagArray",e.global.requestTagArray)("mentionArray",e.global.mentionArray)("enableMenu",!1)("jsonContent",e.request.content)}}function S(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"markdown-editor",21),t.NdJ("selectedMention",function(i){return t.CHM(e),t.oxw().getMention(i)})("jsonContentChange",function(i){return t.CHM(e),t.oxw().task.content=i})("content",function(i){return t.CHM(e),t.oxw().task.rawContent=i.raw})("selectedTag",function(i){return t.CHM(e),t.oxw().getTag(i)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("tagArray",e.global.taskTagArray)("mentionArray",e.global.mentionArray)("enableMenu",!1)("jsonContent",e.task.content)}}function V(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"markdown-editor",21),t.NdJ("selectedMention",function(i){return t.CHM(e),t.oxw().getMention(i)})("jsonContentChange",function(i){return t.CHM(e),t.oxw().milestone.content=i})("content",function(i){return t.CHM(e),t.oxw().milestone.rawContent=i.raw})("selectedTag",function(i){return t.CHM(e),t.oxw().getTag(i)}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("tagArray",e.global.milestoneTagArray)("mentionArray",e.global.mentionArray)("enableMenu",!1)("jsonContent",e.milestone.content)}}function Y(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"app-field-select",23),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().request.category=i}),t.qZA(),t.TgZ(2,"app-field-select",24),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().request.severity=i}),t.qZA(),t.TgZ(3,"app-field-select",25),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().request.module=i}),t.qZA(),t.TgZ(4,"app-field-select",26),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().request.status=i}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("options",e.fields.categories)("defaultValue",e.request.category),t.xp6(1),t.Q6J("options",e.fields.severities)("defaultValue",e.request.severity),t.xp6(1),t.Q6J("options",e.fields.modules)("defaultValue",e.request.module),t.xp6(1),t.Q6J("options",e.fields.requestStatus)("defaultValue",e.request.status)}}function O(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"app-field-select",27),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().task.priority=i}),t.qZA(),t.TgZ(2,"app-field-select",26),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().task.status=i}),t.qZA(),t.TgZ(3,"app-field-select",25),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().task.module=i}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("options",e.fields.taskPriorites)("defaultValue",e.task.priority),t.xp6(1),t.Q6J("options",e.fields.taskStatus)("defaultValue",e.task.status),t.xp6(1),t.Q6J("options",e.fields.modules)("defaultValue",e.task.module)}}function F(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"app-field-select",26),t.NdJ("defaultValueChange",function(i){return t.CHM(e),t.oxw().milestone.status=i}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("options",e.fields.milestoneStatus)("defaultValue",e.milestone.status)}}function U(n,a){if(1&n&&t._UZ(0,"app-task-list-item",35),2&n){const e=a.$implicit;t.Q6J("size","min")("flTask",e)}}function I(n,a){if(1&n&&(t.TgZ(0,"div",30)(1,"div",31)(2,"span",32),t._uU(3,"Associsted Task"),t.qZA(),t.TgZ(4,"span",33),t._uU(5),t.qZA()(),t.YNc(6,U,1,2,"app-task-list-item",34),t.ALo(7,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(5),t.Oqu(e.request.associatedTasks.length),t.xp6(1),t.Q6J("ngForOf",t.lcZ(7,2,e.taskQuery.selectMany(e.request.associatedTasks)))}}function H(n,a){if(1&n&&t._UZ(0,"app-req-list-item",37),2&n){const e=a.$implicit;t.Q6J("size","min")("request",e)}}function z(n,a){if(1&n&&(t.TgZ(0,"div",30)(1,"div",31)(2,"span",32),t._uU(3,"Associsted Requests"),t.qZA(),t.TgZ(4,"span",33),t._uU(5),t.qZA()(),t.YNc(6,H,1,2,"app-req-list-item",36),t.ALo(7,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(5),t.Oqu(e.task.requests.length),t.xp6(1),t.Q6J("ngForOf",t.lcZ(7,2,e.requestQuery.selectMany(e.task.requests)))}}function L(n,a){if(1&n&&t._UZ(0,"app-milestone-card",39),2&n){const e=a.$implicit;t.Q6J("size","min")("flMilestone",e)}}const j=function(n){return[n]};function R(n,a){if(1&n&&(t.TgZ(0,"div",30)(1,"div",31)(2,"span",32),t._uU(3,"Associsted Milestone"),t.qZA()(),t.YNc(4,L,1,2,"app-milestone-card",38),t.ALo(5,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,1,e.milestoneQuery.selectMany(t.VKq(3,j,e.task.associatedMilestone))))}}function $(n,a){if(1&n&&t._UZ(0,"app-task-list-item",35),2&n){const e=a.$implicit;t.Q6J("size","min")("flTask",e)}}function G(n,a){if(1&n&&(t.TgZ(0,"div",30)(1,"div",31)(2,"span",32),t._uU(3,"Associsted Tasks"),t.qZA(),t.TgZ(4,"span",33),t._uU(5),t.qZA()(),t.YNc(6,$,1,2,"app-task-list-item",34),t.ALo(7,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(5),t.Oqu(e.milestone.tasks.length),t.xp6(1),t.Q6J("ngForOf",t.lcZ(7,2,e.taskQuery.selectMany(e.milestone.tasks)))}}function B(n,a){if(1&n&&(t.TgZ(0,"div",28),t.YNc(1,I,8,4,"div",29),t.YNc(2,z,8,4,"div",29),t.YNc(3,R,6,5,"div",29),t.YNc(4,G,8,4,"div",29),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","request"===e.entity&&e.request.associatedTasks),t.xp6(1),t.Q6J("ngIf","task"===e.entity&&e.task.requests),t.xp6(1),t.Q6J("ngIf","task"===e.entity&&e.task.associatedMilestone),t.xp6(1),t.Q6J("ngIf","milestone"===e.entity&&e.milestone.tasks)}}let D=(()=>{class n{constructor(e,s,i,o,tt,et,nt,it,st,ot,at,rt,lt){this.global=e,this.activatedRoute=s,this.fields=i,this.requestService=o,this.taskService=tt,this.milestoneService=et,this.requestQuery=nt,this.taskQuery=it,this.milestoneQuery=st,this.navigationService=ot,this.notifier=at,this.authQuery=rt,this.router=lt,this.entity="",this.entityPlaceholder="Title",this.showModel=!1,this.postResponseReceived=!1,this.disablePost=!1,this.request={},this.task={},this.milestone={},this.showRequestModel=!1,this.showTaskModel=!1,this.showMilestoneModel=!1}ngOnInit(){this.activatedRoute.params.subscribe(e=>{e.entity&&(this.entity=e.entity),this.entityPlaceholder=this.entity+" title"}),this.entityPlaceholder=this.entity+" title",this.user=this.authQuery.user,console.log(this.authQuery.user.id)}ngAfterViewInit(){}postEntity(){this.canPostEntity()&&!this.disablePost&&(this.disablePost=!0,"request"===this.entity?(this.request.createdByUser=this.authQuery.user.id,this.requestService.addRequest(this.request)):"task"===this.entity?(this.task.createdByUser=this.authQuery.user.id,this.taskService.addTask(this.task)):"milestone"===this.entity&&(this.milestone.createdByUser=this.authQuery.user.id,this.milestoneService.addMilestone(this.milestone)),this.notifierSubscription=this.notifier.action$.pipe((0,d.vE)(`${this.entity.toLocaleLowerCase()}s`),(0,d.IY)("POST")).subscribe(e=>{this.postResponseReceived=!0,console.log(e,this.entity.toLocaleLowerCase()),"success"===e.type&&e.payload&&e.payload.id?(console.log(e,this.entity.toLocaleLowerCase(),"inside"),this.router.navigate([`/view/${this.entity.toLocaleLowerCase()}/${e.payload.id}`])):this.navigationService.back()}))}canPostEntity(){return"request"===this.entity?!!this.request.rawContent:"task"===this.entity?!!this.task.rawContent:"milestone"===this.entity&&!!this.milestone.rawContent}getEntityList(){let e=[];return this.fields.entities.forEach(s=>e.push({label:s,value:s})),e}getTag(e){if("request"===this.entity)switch(e.type){case"Category":this.request.category=e.tag;break;case"Severity":this.request.severity=e.tag;break;case"Module":this.request.module=e.tag;break;default:console.log(`Unknown tag type in ${this.entity}: `,e.type)}else if("task"===this.entity)switch(e.type){case"Priority":this.task.priority=e.tag;break;case"Status":this.task.status=e.tag;break;case"Module":this.task.module=e.tag;break;default:console.log(`Unknown tag type in ${this.entity}: `,e.type)}else"milestone"===this.entity&&"Status"===e.type&&(this.milestone.status=e.tag)}getMention(e){console.log(e)}canDeactivate(){if(this.canPostEntity()&&!this.postResponseReceived){const e=window.confirm("There are unsaved changes! Are you sure?");return(0,m.of)(e)}return(0,m.of)(!0)}getSelectedRequest(e){console.log(this.entity,"Selected Request",e),"task"===this.entity&&(this.task.requests=e)}getSelectedTask(e){switch(console.log(this.entity,"Selected Task",e),this.entity){case"request":this.request.associatedTasks=e;break;case"milestone":this.milestone.tasks=e}}getSelectedMilestone(e){console.log(this.entity,"Selected Milestone",e),"task"===this.entity&&(this.task.associatedMilestone=e)}getEntityAssociaties(e){if("request"===this.entity&&this.request){if("task"===e&&this.request.associatedTasks)return[...this.request.associatedTasks]}else if("task"===this.entity&&this.task){if("request"===e&&this.task.requests)return this.task.requests;if("milestone"===e&&this.task.associatedMilestone)return[this.task.associatedMilestone]}else if("milestone"===this.entity&&this.milestone&&"task"===e&&this.milestone.tasks)return this.milestone.tasks;return[]}ngOnDestroy(){console.log("ngOnDestroy called"),this.notifierSubscription&&this.notifierSubscription.unsubscribe(),this.userSubscription&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.U),t.Y36(l.gz),t.Y36(y.$),t.Y36(g.P),t.Y36(h.Y),t.Y36(C.l),t.Y36(w.Z),t.Y36(k.R),t.Y36(v.l),t.Y36(x.f),t.Y36(d.kt),t.Y36(p.i),t.Y36(l.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-new-entity"]],inputs:{entity:"entity"},decls:26,vars:12,consts:[[1,"new-entity-container"],[3,"icon","mode","rightContent"],["nav_bar_arrow",""],["nav_bar_submit",""],[1,"nec-body"],[1,"nec-modal"],["model",""],[1,"nec-modal-header"],[1,"nec-modal-header-left","nec-modal-div"],["class","rlth-time-icon","alt","",3,"src",4,"ngIf"],[1,"arrow-span"],[1,"soft-span-text"],[1,"nec-modal-body"],[1,"nec-editor"],["class","nec-markdown-editor","placeholder","Say Something",3,"tagArray","mentionArray","enableMenu","jsonContent","selectedMention","jsonContentChange","content","selectedTag",4,"ngIf"],[1,"nec-modal-footer"],["class","first-element",4,"ngIf"],["class","associatedDiv",4,"ngIf"],["appBackButton","",1,"material-symbols-rounded","button-icon"],["Button","",1,"button-icon","button-feel-accent",2,"margin-right","4px",3,"type","disabled","ngStyle","inline","size","click"],["alt","",1,"rlth-time-icon",3,"src"],["placeholder","Say Something",1,"nec-markdown-editor",3,"tagArray","mentionArray","enableMenu","jsonContent","selectedMention","jsonContentChange","content","selectedTag"],[1,"first-element"],["name","Category",1,"nec-entity-fields",3,"options","defaultValue","defaultValueChange"],["name","Severity",1,"nec-entity-fields",3,"options","defaultValue","defaultValueChange"],["name","Module",1,"nec-entity-fields",3,"options","defaultValue","defaultValueChange"],["name","Status",1,"nec-entity-fields",3,"options","defaultValue","defaultValueChange"],["name","Priority",1,"nec-entity-fields",3,"options","defaultValue","defaultValueChange"],[1,"associatedDiv"],["class","nec-model-entity",4,"ngIf"],[1,"nec-model-entity"],[1,"nec-model-request"],[1,"nec-req-text"],[1,"nec-req-value"],["class","task-list-item",3,"size","flTask",4,"ngFor","ngForOf"],[1,"task-list-item",3,"size","flTask"],["class","task-list-item",3,"size","request",4,"ngFor","ngForOf"],[1,"task-list-item",3,"size","request"],["class","task-list-item",3,"size","flMilestone",4,"ngFor","ngForOf"],[1,"task-list-item",3,"size","flMilestone"]],template:function(e,s){if(1&e&&(t.TgZ(0,"div",0),t._UZ(1,"Navbar",1),t.YNc(2,A,2,0,"ng-template",null,2,t.W1O),t.YNc(4,Q,2,7,"ng-template",null,3,t.W1O),t.TgZ(6,"div",4)(7,"div",5,6)(9,"div",7)(10,"div",8),t.YNc(11,J,1,1,"img",9),t.TgZ(12,"span",10),t._uU(13,"\u203a"),t.qZA(),t.TgZ(14,"span",11),t._uU(15),t.qZA()()(),t.TgZ(16,"div",12)(17,"div",13),t.YNc(18,P,1,4,"markdown-editor",14),t.YNc(19,S,1,4,"markdown-editor",14),t.YNc(20,V,1,4,"markdown-editor",14),t.qZA()(),t.TgZ(21,"div",15),t.YNc(22,Y,5,8,"div",16),t.YNc(23,O,4,6,"div",16),t.YNc(24,F,2,2,"div",16),t.qZA()(),t.YNc(25,B,5,4,"div",17),t.qZA()()),2&e){const i=t.MAs(3),o=t.MAs(5);t.xp6(1),t.Q6J("icon",i)("mode","light")("rightContent",o),t.xp6(10),t.Q6J("ngIf",s.user),t.xp6(4),t.hij("New ",s.entity,""),t.xp6(3),t.Q6J("ngIf","request"===s.entity),t.xp6(1),t.Q6J("ngIf","task"===s.entity),t.xp6(1),t.Q6J("ngIf","milestone"===s.entity),t.xp6(2),t.Q6J("ngIf","request"===s.entity),t.xp6(1),t.Q6J("ngIf","task"===s.entity),t.xp6(1),t.Q6J("ngIf","milestone"===s.entity),t.xp6(1),t.Q6J("ngIf",s.getEntityAssociaties(s.entity))}},directives:[u.w5,T.z,u.r0,c.PC,c.O5,M.k1,N.I,c.sg,q.T,E.U,Z.T],pipes:[c.Ov],styles:[".new-entity-container[_ngcontent-%COMP%]{width:100%;height:100%;background-color:transparent}.nec-body[_ngcontent-%COMP%]{width:100%;height:calc(100% - 45px);padding:12px;background-color:var(--dim-bg-color)}.nec-loader[_ngcontent-%COMP%]{height:30%}.nec-modal-header[_ngcontent-%COMP%], .second-element[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.nec-modal-body[_ngcontent-%COMP%]{overflow-y:auto}.nec-modal-footer[_ngcontent-%COMP%] > .second-element[_ngcontent-%COMP%]{border-top:1px solid var(--border-bottom)}.nec-modal-div[_ngcontent-%COMP%]{display:flex;align-items:center}.arrow-span[_ngcontent-%COMP%]{margin:0 12px;color:gray}.nec-close-btn[_ngcontent-%COMP%]{color:gray}.nec-post-btn[_ngcontent-%COMP%]{font-size:1rem;padding:8px 12px;border-radius:16px}.first-element[_ngcontent-%COMP%]{display:flex;column-gap:10px}.nec-entity-fields[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-right:12px}.rlth-time-icon[_ngcontent-%COMP%]{width:28px;height:28px;margin:auto;border-radius:50%}"]}),n})();var K=r(5268);const W=[{path:":entity",component:D,canActivate:[(()=>{class n{constructor(e,s,i){this.authQuery=e,this.router=s,this.toast=i}canActivate(e,s){if(this.authQuery.isLoggedIn)return!0;let i=e.params.entity;return i?(this.toast.fail("Please login to create new "+i,4e3,void 0,!1,"middle"),console.log(`/home/${i}s`),this.router.navigateByUrl(`/home/${i}s`),!1):(this.toast.info("Please login to create "+i,4e3,void 0,!1,"bottom"),this.router.navigateByUrl("/"),!1)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(p.i),t.LFG(l.F0),t.LFG(u.kl))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()],canDeactivate:[(()=>{class n{canDeactivate(e,s,i,o){return e.canDeactivate()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()]}];let X=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[K.m,l.Bz.forChild(W)]]}),n})()}}]);