"use strict";(self.webpackChunkfeedback_loop_client=self.webpackChunkfeedback_loop_client||[]).push([[194],{5499:(Me,ne,E)=>{E.d(ne,{T:()=>S});var c=E(5e3),R=E(2626),Z=E(9352),A=E(9808),D=E(4342);function z(w,j){if(1&w){const ee=c.EpF();c.TgZ(0,"div",3),c.NdJ("click",function(){return c.CHM(ee),c.oxw().openmilestone()}),c.TgZ(1,"div",4),c._UZ(2,"nz-progress",5),c.TgZ(3,"div",6)(4,"div",7)(5,"span"),c._uU(6),c.qZA()(),c.TgZ(7,"div",8)(8,"span")(9,"span",9),c._uU(10),c.qZA(),c._uU(11),c.ALo(12,"date"),c.qZA()()(),c.TgZ(13,"div",10)(14,"div",11),c._uU(15),c.qZA(),c.TgZ(16,"span",12),c._uU(17,"more_vert"),c.qZA()()()()}if(2&w){const ee=c.oxw();c.xp6(2),c.Q6J("nzPercent",null==ee.milestone?null:ee.milestone.percentage)("nzWidth",50),c.xp6(4),c.Oqu(null==ee.milestone?null:ee.milestone.title),c.xp6(4),c.Oqu(null==ee.milestone?null:ee.milestone.status),c.xp6(1),c.hij(" . ",c.lcZ(12,6,null==ee.milestone?null:ee.milestone.createdAt),""),c.xp6(4),c.Oqu(null==ee.milestone?null:ee.milestone.taskCount)}}function L(w,j){if(1&w&&(c.TgZ(0,"div",13)(1,"div",14),c._UZ(2,"nz-progress",5),c.TgZ(3,"div")(4,"span",15),c._uU(5),c.qZA(),c.TgZ(6,"span",16),c._uU(7),c.ALo(8,"date"),c.qZA()()()()),2&w){const ee=c.oxw();c.xp6(2),c.Q6J("nzPercent",null==ee.milestone?null:ee.milestone.percentage)("nzWidth",50),c.xp6(3),c.Oqu(null==ee.milestone?null:ee.milestone.title),c.xp6(2),c.Oqu(c.lcZ(8,4,null==ee.milestone?null:ee.milestone.createdAt))}}let S=(()=>{class w{constructor(ee){this.route=ee}ngOnInit(){this.milestone=this.flMilestone}openmilestone(){this.milestone&&this.route.navigate([`/milestone/view/${this.milestone.id}`])}}return w.\u0275fac=function(ee){return new(ee||w)(c.Y36(R.F0))},w.\u0275cmp=c.Xpm({type:w,selectors:[["app-milestone-card"]],inputs:{milestone:"milestone",flMilestone:"flMilestone",size:"size"},decls:3,vars:3,consts:[[3,"size"],["class","card-body",3,"click",4,"ngIf"],["class","rlth-minsize",4,"ngIf"],[1,"card-body",3,"click"],[1,"header"],["nzType","circle",1,"rlth-time-icon","progress-icon",3,"nzPercent","nzWidth"],[1,"title-container"],[1,"title-div"],[1,"status-time-div"],[1,"status"],[1,"task-div"],[1,"task"],[1,"material-symbols-rounded"],[1,"rlth-minsize"],[1,"milestone-content"],[1,"rlth-title"],[1,"rlth-date"]],template:function(ee,q){1&ee&&(c._UZ(0,"WhiteSpace",0),c.YNc(1,z,18,8,"div",1),c.YNc(2,L,9,6,"div",2)),2&ee&&(c.Q6J("size","md"),c.xp6(1),c.Q6J("ngIf",!q.size),c.xp6(1),c.Q6J("ngIf",q.size))},directives:[Z.yG,A.O5,D.M],pipes:[A.uU],styles:[".card-body[_ngcontent-%COMP%]{width:100%;font-size:1rem}.header[_ngcontent-%COMP%]{width:100%;display:flex;align-items:flex-start}.title-container[_ngcontent-%COMP%]{flex:1;overflow:hidden}.title-div[_ngcontent-%COMP%], .status[_ngcontent-%COMP%]{font-weight:500;text-transform:capitalize;overflow:hidden;text-overflow:ellipsis}.status-time-div[_ngcontent-%COMP%]{font-size:.8rem}.task-div[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.task[_ngcontent-%COMP%]{background-color:var(--dim-bg-color);padding:2px 10px;border-radius:25px}.progress-icon[_ngcontent-%COMP%]{background-color:#f5f5f5;border-radius:50%;margin-right:8px;text-align:center}"]}),w})()},5864:(Me,ne,E)=>{E.d(ne,{U:()=>J});var c=E(5e3),R=E(7465),Z=E(2626),A=E(6324),D=E(9808),z=E(9051),L=E(4112),S=E(9830);let w=(()=>{class se{transform(Y){return Y==S.MM.Feedback?"assets/feedback.png":Y==S.MM.FeatureRequest?"assets/feature.png":"assets/warning-sign.png"}}return se.\u0275fac=function(Y){return new(Y||se)},se.\u0275pipe=c.Yjl({name:"categoryImgPath",type:se,pure:!0}),se})();const j=["content"];function ee(se,ce){if(1&se&&(c._UZ(0,"img",14),c.ALo(1,"categoryImgPath")),2&se){const Y=c.oxw(2);c.Q6J("src",c.lcZ(1,1,Y.request.category),c.LSH)}}function q(se,ce){if(1&se&&c._UZ(0,"app-status-tag",15),2&se){const Y=c.oxw(2);c.Q6J("status",Y.request.status)}}function le(se,ce){if(1&se){const Y=c.EpF();c.TgZ(0,"div",2),c.NdJ("click",function(){return c.CHM(Y),c.oxw().openRequest()}),c.TgZ(1,"header",3)(2,"div",4)(3,"span",5),c.YNc(4,ee,2,3,"img",6),c.qZA(),c.TgZ(5,"div",7)(6,"span",8),c._uU(7),c.TgZ(8,"span",9),c._uU(9),c.ALo(10,"date"),c.qZA()(),c.TgZ(11,"span",10)(12,"span"),c._uU(13),c.qZA()()()(),c.TgZ(14,"div",11),c.YNc(15,q,1,1,"app-status-tag",12),c.qZA()(),c._UZ(16,"div",13),c.qZA()}if(2&se){const Y=c.oxw();c.xp6(4),c.Q6J("ngIf",Y.request.category),c.xp6(3),c.hij(" ",Y.request.category," . "),c.xp6(2),c.Oqu(c.lcZ(10,6,Y.request.createdAt)),c.xp6(4),c.Oqu(Y.req.userEmail),c.xp6(2),c.Q6J("ngIf",Y.request.status),c.xp6(1),c.Q6J("MarkdownContentParser",Y.request.content)}}function G(se,ce){if(1&se&&(c._UZ(0,"img",14),c.ALo(1,"categoryImgPath")),2&se){const Y=c.oxw(2);c.Q6J("src",c.lcZ(1,1,Y.request.category),c.LSH)}}function ae(se,ce){if(1&se&&(c.TgZ(0,"div",16)(1,"div",17)(2,"span",18),c.YNc(3,G,2,3,"img",6),c.qZA(),c.TgZ(4,"div"),c._UZ(5,"span",19),c.TgZ(6,"span",20),c._uU(7),c.ALo(8,"date"),c.qZA()()()()),2&se){const Y=c.oxw();c.xp6(3),c.Q6J("ngIf",Y.request.category),c.xp6(2),c.Q6J("MarkdownContentParser",Y.request.content),c.xp6(2),c.Oqu(c.lcZ(8,3,Y.request.createdAt))}}let J=(()=>{class se{constructor(Y,fe,xe){this.global=Y,this.router=fe,this.userQuery=xe,this.req={},this.disabled=!0}ngOnInit(){this.request=this.req}ngAfterViewInit(){}openRequest(){this.request&&!this.disabled&&this.router.navigate([`/request/view/${this.request.id}`])}}return se.\u0275fac=function(Y){return new(Y||se)(c.Y36(R.U),c.Y36(Z.F0),c.Y36(A.o))},se.\u0275cmp=c.Xpm({type:se,selectors:[["app-req-list-item"]],viewQuery:function(Y,fe){if(1&Y&&c.Gf(j,5),2&Y){let xe;c.iGM(xe=c.CRH())&&(fe.content=xe.first)}},inputs:{request:"request",req:"req",disabled:"disabled",size:"size"},decls:2,vars:2,consts:[["class","req-list-item-body",3,"click",4,"ngIf"],["class","rlth-minsize",4,"ngIf"],[1,"req-list-item-body",3,"click"],[1,"req-list-item-header"],[1,"rlth-time"],[1,"material-symbols-rounded","rlth-time-icon"],["alt","",3,"src",4,"ngIf"],[1,"rlth-time-div"],[1,"rlth-time-text"],[1,"rlth-time-value"],[1,"rlth-time-user"],[1,"rlth-status"],[3,"status",4,"ngIf"],[1,"req-list-item-container",3,"MarkdownContentParser"],["alt","",3,"src"],[3,"status"],[1,"rlth-minsize"],[1,"milestone-content"],[1,"material-symbols-rounded","rlth-time-iconlist"],[1,"rlth-title",3,"MarkdownContentParser"],[1,"rlth-date"]],template:function(Y,fe){1&Y&&(c.YNc(0,le,17,8,"div",0),c.YNc(1,ae,9,5,"div",1)),2&Y&&(c.Q6J("ngIf",!fe.size),c.xp6(1),c.Q6J("ngIf",fe.size))},directives:[D.O5,z.G,L.J],pipes:[w,D.uU],styles:[".req-list-item-body[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:column;padding-bottom:6px}.req-list-item-header[_ngcontent-%COMP%]{flex:1;display:flex}.req-list-item-container[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;white-space:break-spaces;font-size:1rem;padding-top:12px}.req-list-item-footer[_ngcontent-%COMP%]{max-height:50px;min-height:50px;flex:1;background-color:#f5f5f5;display:flex}.rlth-time[_ngcontent-%COMP%]{display:flex;flex:3;align-items:flex-start;height:100%}.rlth-time-icon[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#f5f5f5;border-radius:50%;font-size:2rem;margin-right:6px;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;height:28px;margin:auto}.rlth-time-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;max-width:100%;font-size:1rem}.rlth-time-div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.rlth-time-text[_ngcontent-%COMP%]{font-weight:500;font-size:1rem;text-transform:capitalize}.rlth-time-user[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color);overflow:hidden;text-overflow:ellipsis;max-width:calc(90vw - 120px)}.rlth-time-value[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color)}.rlth-status[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;justify-content:flex-end;align-items:flex-start;max-width:50%}.rlth-status-span[_ngcontent-%COMP%]{font-size:1rem;background-color:#efd0dd;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;border-radius:25px;color:#ad1457}.rlth-options-span[_ngcontent-%COMP%]{cursor:pointer}.rli-start[_ngcontent-%COMP%], .rli-end[_ngcontent-%COMP%]{display:flex;flex:1}.rli-start[_ngcontent-%COMP%]{justify-content:flex-start}.rli-end[_ngcontent-%COMP%]{justify-content:flex-end}.rli-end[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{justify-content:flex-end}.rlth-time-iconlist[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#f5f5f5;border-radius:50%;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-iconlist[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;height:18px;margin:auto}.rlth-details-gap[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.rlth-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;font-size:.9rem}.rlth-date[_ngcontent-%COMP%]{font-size:.8rem}"]}),se})()},9051:(Me,ne,E)=>{E.d(ne,{G:()=>R});var c=E(5e3);let R=(()=>{class Z{constructor(){this.status=""}ngOnInit(){}}return Z.\u0275fac=function(D){return new(D||Z)},Z.\u0275cmp=c.Xpm({type:Z,selectors:[["app-status-tag"]],inputs:{status:"status"},decls:2,vars:1,consts:[[1,"rlth-status-span"]],template:function(D,z){1&D&&(c.TgZ(0,"span",0),c._uU(1),c.qZA()),2&D&&(c.xp6(1),c.Oqu(z.status))},styles:["span[_ngcontent-%COMP%]{font-size:1rem;background-color:var(--dim-bg-color);width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;padding:2px 10px;border-radius:25px}"]}),Z})()},7410:(Me,ne,E)=>{E.d(ne,{T:()=>le});var c=E(5e3),R=E(2626),Z=E(6324),A=E(9352),D=E(9808),z=E(4342),L=E(9051),S=E(4112);function w(G,ae){if(1&G&&c._UZ(0,"div",14),2&G){const J=c.oxw(2);c.Q6J("MarkdownContentParser",J.task.content)}}function j(G,ae){if(1&G){const J=c.EpF();c.TgZ(0,"div",3),c.NdJ("click",function(){return c.CHM(J),c.oxw().openTask()}),c.TgZ(1,"header",4)(2,"div",5),c._UZ(3,"nz-progress",6),c.TgZ(4,"div",7)(5,"span",8),c._uU(6),c.TgZ(7,"span",9),c._uU(8),c.ALo(9,"date"),c.qZA()(),c.TgZ(10,"span",9),c._uU(11),c.qZA()()(),c.TgZ(12,"div",10),c._UZ(13,"app-status-tag",11),c.TgZ(14,"span",12),c._uU(15," more_vert "),c.qZA()()(),c.YNc(16,w,1,1,"div",13),c.qZA()}if(2&G){const J=c.oxw();c.xp6(3),c.Q6J("nzPercent",J.task.percentage)("nzWidth",50),c.xp6(3),c.hij(" ",J.task.status,""),c.xp6(2),c.hij(" . ",c.lcZ(9,7,J.task.createdAt),""),c.xp6(3),c.hij(" ",J.flTask.userEmail," "),c.xp6(2),c.Q6J("status",J.task.requestCount?J.task.requestCount.toString():"0"),c.xp6(3),c.Q6J("ngIf",J.task.content)}}function ee(G,ae){if(1&G&&c._UZ(0,"span",19),2&G){const J=c.oxw(2);c.Q6J("MarkdownContentParser",J.task.content)}}function q(G,ae){if(1&G&&(c.TgZ(0,"div",15)(1,"div",16),c._UZ(2,"nz-progress",6),c.TgZ(3,"div"),c.YNc(4,ee,1,1,"span",17),c.TgZ(5,"span",18),c._uU(6),c.ALo(7,"date"),c.qZA()()()()),2&G){const J=c.oxw();c.xp6(2),c.Q6J("nzPercent",J.task.percentage)("nzWidth",50),c.xp6(2),c.Q6J("ngIf",J.task.content),c.xp6(2),c.Oqu(c.lcZ(7,4,J.task.createdAt))}}let le=(()=>{class G{constructor(J,se){this.router=J,this.userQuery=se,this.flTask={},this.disabled=!0}ngOnInit(){this.task=this.flTask}openTask(){this.task&&!this.disabled&&this.router.navigate([`/task/view/${this.task.id}`])}}return G.\u0275fac=function(J){return new(J||G)(c.Y36(R.F0),c.Y36(Z.o))},G.\u0275cmp=c.Xpm({type:G,selectors:[["app-task-list-item"]],inputs:{task:"task",flTask:"flTask",disabled:"disabled",size:"size"},decls:3,vars:3,consts:[[3,"size"],["class","req-list-item-body",3,"click",4,"ngIf"],["class","rlth-minsize",4,"ngIf"],[1,"req-list-item-body",3,"click"],[1,"req-list-item-header"],[1,"rlth-time"],["nzType","circle",1,"rlth-time-icon",3,"nzPercent","nzWidth"],[1,"rlth-time-div"],[1,"rlth-time-text"],[1,"rlth-time-user"],[1,"rlth-status"],[3,"status"],[1,"material-symbols-rounded","rlth-options-span"],["class","req-list-item-container",3,"MarkdownContentParser",4,"ngIf"],[1,"req-list-item-container",3,"MarkdownContentParser"],[1,"rlth-minsize"],[1,"milestone-content"],["class","rlth-title",3,"MarkdownContentParser",4,"ngIf"],[1,"rlth-date"],[1,"rlth-title",3,"MarkdownContentParser"]],template:function(J,se){1&J&&(c._UZ(0,"WhiteSpace",0),c.YNc(1,j,17,9,"div",1),c.YNc(2,q,8,6,"div",2)),2&J&&(c.Q6J("size","md"),c.xp6(1),c.Q6J("ngIf",!se.size),c.xp6(1),c.Q6J("ngIf",se.size))},directives:[A.yG,D.O5,z.M,L.G,S.J],pipes:[D.uU],styles:[".req-list-item-body[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;font-size:1rem}.req-list-item-header[_ngcontent-%COMP%]{flex:1;display:flex}.req-list-item-container[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;white-space:break-spaces;font-size:1rem;padding:12px 0 6px}.req-list-item-footer[_ngcontent-%COMP%]{max-height:60px;flex:1;background-color:#f5f5f5;display:flex}.rlth-time[_ngcontent-%COMP%]{display:flex;flex:3;align-items:flex-start;height:100%}.rlth-time-icon[_ngcontent-%COMP%]{max-width:40px;max-height:40px;background-color:#f5f5f5;border-radius:50%;margin-right:8px;text-align:center;display:flex;justify-content:center;align-items:center}.rlth-time-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;height:28px;margin:auto}.rlth-time-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-self:center;max-width:100%;font-size:1rem}.rlth-time-div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;align-self:flex-start}.rlth-time-text[_ngcontent-%COMP%]{font-weight:500;font-size:1rem;text-transform:capitalize}.rlth-time-user[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color);overflow:hidden;text-overflow:ellipsis;max-width:calc(90vw - 120px)}.rlth-time-value[_ngcontent-%COMP%]{font-size:.8rem;color:var(--dim-text-color)}.rlth-status[_ngcontent-%COMP%]{flex:1;font-size:.9rem;display:flex;justify-content:flex-end;max-width:50%;column-gap:4px}.rlth-status-span[_ngcontent-%COMP%]{font-size:1rem;background-color:#efd0dd;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;border-radius:25px;color:#ad1457}.rli-start[_ngcontent-%COMP%], .rli-end[_ngcontent-%COMP%]{display:flex;flex:1}.rli-start[_ngcontent-%COMP%]{justify-content:flex-start}.rli-end[_ngcontent-%COMP%]{justify-content:flex-end}.rli-end[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{justify-content:flex-end}footer[_ngcontent-%COMP%]{margin-top:6px;display:flex;border-top:1px solid var(--dim-bg-color);font-size:.9rem;justify-content:flex-end;align-content:center;color:var(--dim-text-color)}button[_ngcontent-%COMP%]{border-radius:15px;padding:1px 8px;border:1px solid transparent;align-self:flex-start;position:relative;background-color:var(--dim-bg-color)}button[_ngcontent-%COMP%] > .dot[_ngcontent-%COMP%]{position:absolute;right:-4px;top:-9px;min-width:13px;max-width:25px;height:14px;border-radius:20px;background-color:#108ee9;padding:0 4%;color:#fff;font-size:10px}"]}),G})()},3455:(Me,ne,E)=>{E.d(ne,{l:()=>A});var c=E(1469),R=E(5e3),Z=E(7564);let A=(()=>{class D extends c.Gv{constructor(L){super(L),this.store=L,this.$milestones=this.selectAll(),this.$milestoneCount=this.selectCount()}}return D.\u0275fac=function(L){return new(L||D)(R.LFG(Z.w))},D.\u0275prov=R.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},9033:(Me,ne,E)=>{E.d(ne,{l:()=>D});var c=E(914),R=E(5e3),Z=E(7564),A=E(3616);let D=(()=>{class z extends c.Hb{constructor(S,w){super(S),this.store=S,this.authQuery=w,this.appConfig={headers:{Authorization:`Bearer ${this.authQuery.jwtToken}`}},this.authQuery.$jwtToken.subscribe(j=>this.appConfig={headers:{Authorization:`Bearer ${j}`}})}getall(){return this.get({params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}getOne(S){return this.get(S,{params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}addMilestone(S){return this.add(Object.assign(Object.assign({},S),{data:S}),this.appConfig).subscribe()}updateMilestone(S,w){return this.update(S,{data:w},this.appConfig).subscribe()}}return z.\u0275fac=function(S){return new(S||z)(R.LFG(Z.w),R.LFG(A.i))},z.\u0275prov=R.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},7564:(Me,ne,E)=>{E.d(ne,{w:()=>A});var c=E(655),R=E(1469),Z=E(5e3);let A=class extends R.cf{constructor(){super()}};A.\u0275fac=function(z){return new(z||A)},A.\u0275prov=Z.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A=(0,c.gn)([(0,R.yC)({name:"milestones"})],A)},6832:(Me,ne,E)=>{E.d(ne,{Z:()=>A});var c=E(1469),R=E(5e3),Z=E(6580);let A=(()=>{class D extends c.Gv{constructor(L){super(L),this.store=L,this.$requests=this.selectAll(),this.$requestCount=this.selectCount()}}return D.\u0275fac=function(L){return new(L||D)(R.LFG(Z.y))},D.\u0275prov=R.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},6335:(Me,ne,E)=>{E.d(ne,{P:()=>D});var c=E(914),R=E(5e3),Z=E(6580),A=E(3616);let D=(()=>{class z extends c.Hb{constructor(S,w){super(S),this.store=S,this.authQuery=w,this.appConfig={headers:{Authorization:`Bearer ${this.authQuery.jwtToken}`}},this.authQuery.$jwtToken.subscribe(j=>this.appConfig={headers:{Authorization:`Bearer ${j}`}})}getall(){return this.get({params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}getOne(S){return this.get(S,{params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}addRequest(S){return this.add(Object.assign(Object.assign({},S),{data:S}),this.appConfig).subscribe()}updateRequest(S,w){return this.update(S,{data:{content:w.content,rawContent:w.rawContent,category:w.category,severity:w.severity,status:w.status,associatedTask:w.associatedTask,createdByUser:w.createdByUser}},this.appConfig).subscribe()}}return z.\u0275fac=function(S){return new(S||z)(R.LFG(Z.y),R.LFG(A.i))},z.\u0275prov=R.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},6580:(Me,ne,E)=>{E.d(ne,{y:()=>A});var c=E(655),R=E(1469),Z=E(5e3);let A=class extends R.cf{constructor(){super()}};A.\u0275fac=function(z){return new(z||A)},A.\u0275prov=Z.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A=(0,c.gn)([(0,R.yC)({name:"requests"})],A)},8025:(Me,ne,E)=>{function c(R){return{jwt:"",accessToken:"",user:{}}}E.d(ne,{l:()=>c})},3616:(Me,ne,E)=>{E.d(ne,{i:()=>A});var c=E(1469),R=E(5e3),Z=E(4277);let A=(()=>{class D extends c.Gv{constructor(L){super(L),this.store=L,this.$jwtToken=this.select("jwt"),this.$authUser=this.select("user"),this.$accessToken=this.select("accessToken"),this.jwtToken="",this.$jwtToken.subscribe(S=>{this.jwtToken=S}),this.$authUser.subscribe(S=>this.user=S)}}return D.\u0275fac=function(L){return new(L||D)(R.LFG(Z.C))},D.\u0275prov=R.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},4277:(Me,ne,E)=>{E.d(ne,{C:()=>D});var c=E(655),R=E(1469),Z=E(8025),A=E(5e3);let D=class extends R.cf{constructor(){super((0,Z.l)({}))}};D.\u0275fac=function(L){return new(L||D)},D.\u0275prov=A.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D=(0,c.gn)([(0,R.yC)({name:"auth"})],D)},4419:(Me,ne,E)=>{E.d(ne,{R:()=>A});var c=E(1469),R=E(5e3),Z=E(1790);let A=(()=>{class D extends c.Gv{constructor(L){super(L),this.store=L,this.$tasks=this.selectAll(),this.$taskCount=this.selectCount()}}return D.\u0275fac=function(L){return new(L||D)(R.LFG(Z.N))},D.\u0275prov=R.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},6101:(Me,ne,E)=>{E.d(ne,{Y:()=>D});var c=E(914),R=E(5e3),Z=E(1790),A=E(3616);let D=(()=>{class z extends c.Hb{constructor(S,w){super(S),this.store=S,this.authQuery=w,this.appConfig={headers:{Authorization:`Bearer ${this.authQuery.jwtToken}`}},this.authQuery.$jwtToken.subscribe(j=>this.appConfig={headers:{Authorization:`Bearer ${j}`}})}getall(){return console.log("Called get in FlTaskService"),this.get({params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}getOne(S){return console.log("Called get in FlTaskService"),this.get(S,{params:{populate:"*"},headers:this.appConfig.headers}).subscribe()}addTask(S){return this.add(Object.assign(Object.assign({},S),{data:S}),this.appConfig).subscribe()}updateTask(S,w){return this.update(S,{data:w},this.appConfig).subscribe()}}return z.\u0275fac=function(S){return new(S||z)(R.LFG(Z.N),R.LFG(A.i))},z.\u0275prov=R.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},1790:(Me,ne,E)=>{E.d(ne,{N:()=>A});var c=E(655),R=E(1469),Z=E(5e3);let A=class extends R.cf{constructor(){super()}};A.\u0275fac=function(z){return new(z||A)},A.\u0275prov=Z.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A=(0,c.gn)([(0,R.yC)({name:"tasks"})],A)},6324:(Me,ne,E)=>{E.d(ne,{o:()=>D});var c=E(1469),R=E(5e3),Z=E(655);let A=class extends c.cf{constructor(){super()}};A.\u0275fac=function(L){return new(L||A)},A.\u0275prov=R.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A=(0,Z.gn)([(0,c.yC)({name:"users"})],A);let D=(()=>{class z extends c.Gv{constructor(S){super(S),this.store=S}}return z.\u0275fac=function(S){return new(S||z)(R.LFG(A))},z.\u0275prov=R.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},4817:(Me,ne,E)=>{E.d(ne,{z:()=>Z});var c=E(5e3),R=E(9565);let Z=(()=>{class A{constructor(z){this.navigation=z}onClick(){this.navigation.back()}}return A.\u0275fac=function(z){return new(z||A)(c.Y36(R.f))},A.\u0275dir=c.lG2({type:A,selectors:[["","appBackButton",""]],hostBindings:function(z,L){1&z&&c.NdJ("click",function(){return L.onClick()})}}),A})()},4112:(Me,ne,E)=>{E.d(ne,{J:()=>ee});var c=E(6956),R=E(412),Z=E(8197),A=E(3981),D=E(5e3),z=E(7465);E(8769);const w={group:"inline",inline:!0,atom:!0,attrs:{tag:{},type:{}},selectable:!1,draggable:!1,toDOM:q=>["a",{class:"tag",tag:q.attrs.tag},"#"+q.attrs.tag]},j={group:"inline",inline:!0,atom:!0,attrs:{name:{},email:{},id:{}},selectable:!1,draggable:!1,toDOM:q=>["a",{class:"mention",mention:q.attrs.name},"@"+q.attrs.name]};let ee=(()=>{class q{constructor(G,ae){this.element=G,this.global=ae,this.customSchema=new Z.V_({nodes:A.fK.spec.nodes.append({mention:j,tag:w}),marks:A.fK.spec.marks})}ngAfterViewChecked(){this.editorView.updateState(c.yy.fromJSON({schema:this.customSchema},this.content))}ngAfterViewInit(){if(this.content&&(this.editorView=new R.tk(this.element.nativeElement,{state:c.yy.fromJSON({schema:this.customSchema},this.content),editable:()=>!1})),!this.editorView)return;let G=this.editorView.dom.querySelectorAll(".tag"),ae=this.editorView.dom.querySelectorAll(".mention");(G.length>0||ae.length>0)&&(G.forEach(J=>{J.addEventListener("click",se=>{let ce=J.getAttribute("tag");se.stopPropagation(),this.global.navigatToSearch(ce)})}),ae.forEach(J=>{J.addEventListener("click",se=>{let ce=J.getAttribute("mention");se.stopPropagation(),this.global.navigatToSearch(ce)})}))}}return q.\u0275fac=function(G){return new(G||q)(D.Y36(D.SBq),D.Y36(z.U))},q.\u0275dir=D.lG2({type:q,selectors:[["","MarkdownContentParser",""]],inputs:{content:["MarkdownContentParser","content"]}}),q})()},9830:(Me,ne,E)=>{E.d(ne,{Fz:()=>c,Ly:()=>R,MM:()=>A,gE:()=>Z});var c=(()=>{return(D=c||(c={})).Grid="Grid",D.IDEClient="IDEClient",D.IDEServer="IDEServer",D.Explorer="Explorer",D.DataPanel="DataPanel",D.StylePanel="StylePanel",c;var D})(),R=(()=>{return(D=R||(R={})).ShowStopper="ShowStopper",D.Critical="Critical",D.Major="Major",D.Minor="Minor",R;var D})(),Z=(()=>{return(D=Z||(Z={})).Open="Open",D.Close="Close",Z;var D})(),A=(()=>{return(D=A||(A={})).Issue="Issue",D.FeatureRequest="Feature",D.Feedback="Feedback",A;var D})()},7465:(Me,ne,E)=>{E.d(ne,{U:()=>q});var c=E(2626),R=E(8197),Z=E(3981),A=E(5e3),D=E(9854),z=E(6138),L=E(8964);const S=E(8769),{addMentionNodes:j}=S;let q=(()=>{class le{constructor(ae,J,se,ce){this.router=ae,this.requestService=J,this.taskService=se,this.milestoneService=ce,this.selectedIndex=0,this.isSearching=!1,this.url="",this.showMenu=!1,this.requestSubFilterList=["All","Open","Close"],this.taskSubFilterList=["All","Yet To Start","In Progress","Completed"],this.searchFilterList=["Requests","Tasks","Milestones"],this.milestoneSubFilterList=["All","Yet To Start","In Progress","Completed"],this.customSchema=new R.V_({nodes:j(j(Z.fK.spec.nodes)),marks:Z.fK.spec.marks}),this.mentionArray=[{name:"IlayaSelvaGanesh",id:"101",email:"ilaya@gmail.com"},{name:"SanthoshBalaji",id:"102",email:"santhosh@gmail.com"},{name:"Dhivya",id:"103",email:"dhivya@gmail.com"},{name:"Ramya",id:"104",email:"ramya@gmail.com"},{name:"Sathya",id:"104",email:"sathya@gmail.com"},{name:"Murali",id:"105",email:"murali@gmail.com"}],this.tagArray=[{tag:"ShowStopper",type:"Severity"},{tag:"Critical",type:"Severity"},{tag:"Major",type:"Severity"},{tag:"Minor",type:"Severity"},{tag:"Grid",type:"Module"},{tag:"Issue",type:"Category"},{tag:"Feature",type:"Category"},{tag:"Feedback",type:"Category"}],ae.events.subscribe(Y=>{Y instanceof c.m2&&(this.url=Y.url)})}getFilterListFromEntity(ae){switch(ae){case"request":return this.requestSubFilterList;case"task":return this.taskSubFilterList;case"search":return this.searchFilterList;case"milestone":return this.milestoneSubFilterList;default:return[]}return[]}navigatToSearch(ae){null==event||event.stopPropagation(),this.router.navigate([`/home/search/${ae}`])}}return le.\u0275fac=function(ae){return new(ae||le)(A.LFG(c.F0),A.LFG(D.s),A.LFG(z.M),A.LFG(L.$))},le.\u0275prov=A.Yz7({token:le,factory:le.\u0275fac,providedIn:"root"}),le})()},6858:(Me,ne,E)=>{E.d(ne,{O:()=>A});var c=E(2340),R=E(5e3),Z=E(520);let A=(()=>{class D{constructor(L){this.http=L,this.strapi_url=c.N.strapi_url,this.options={headers:{Authorization:`Bearer ${c.N.strapi_token}`}}}addNewRequest(L){return this.http.post(`${this.strapi_url}api/requests`,L,this.options)}getRequestList(){return this.http.get(`${this.strapi_url}api/requests/`,this.options)}getRequestById(L){return this.http.get(`${this.strapi_url}api/requests/${L}/`,this.options)}getAllDetailsRequestById(L){return this.http.get(`${this.strapi_url}api/requests/${L}/?populate=%2A`,this.options)}getUnlinkedRequestList(){return this.http.get(`${this.strapi_url}api/requests/?filters[associatedTask]`,this.options)}getFilteredRequestList(L){let S=`${this.strapi_url}api/requests/?`;return L.forEach(w=>{S+=`&filters[${w.fieldName}][${w.operator}]=${w.searchValue}`}),this.http.get(S,this.options)}updateRequestById(L,S){return this.http.put(`${this.strapi_url}api/requests/${L}`,S={data:{content:S.data.content,rawContent:S.data.rawContent,category:S.data.category,severity:S.data.severity,status:S.data.status,associatedTask:S.data.associatedTask}},this.options)}deleteRequestById(L){return this.http.delete(`${this.strapi_url}api/requests/${L}`,this.options)}addNewTask(L){return this.http.post(`${this.strapi_url}api/tasks`,L,this.options)}getTaskList(){return this.http.get(`${this.strapi_url}api/tasks/`,this.options)}getTaskById(L){return this.http.get(`${this.strapi_url}api/tasks/${L}/`,this.options)}getAllDetailsTaskById(L){return this.http.get(`${this.strapi_url}api/tasks/${L}/?populate=%2A`,this.options)}getUnlinkedTasks(){return this.http.get(`${this.strapi_url}api/tasks/?filters[associatedMilestone]`,this.options)}getFilteredTaskList(L){let S=`${this.strapi_url}api/tasks/?`;return L.forEach(w=>{S+=`&filters[${w.fieldName}][${w.operator}]=${w.searchValue}`}),console.log(S),this.http.get(S,this.options)}updateTaskById(L,S){return this.http.put(`${this.strapi_url}api/tasks/${L}`,S,this.options)}deleteTaskById(L){return this.http.delete(`${this.strapi_url}api/tasks/${L}`,this.options)}addNewMilestone(L){return this.http.post(`${this.strapi_url}api/milestones`,L,this.options)}getMilestoneList(){return this.http.get(`${this.strapi_url}api/milestones/`,this.options)}getMilestoneById(L){return this.http.get(`${this.strapi_url}api/milestones/${L}/`,this.options)}getAllDetailsMilestoneById(L){return this.http.get(`${this.strapi_url}api/milestones/${L}/?populate=%2A`,this.options)}getFilteredMilestoneList(L){let S=`${this.strapi_url}api/milestones/?`;return L.forEach(w=>{S+=`&filters[${w.fieldName}][${w.operator}]=${w.searchValue}`}),this.http.get(S,this.options)}updateMilestoneById(L,S){return this.http.put(`${this.strapi_url}api/milestones/${L}`,S,this.options)}deleteMilestoneById(L){return this.http.delete(`${this.strapi_url}api/milestones/${L}`,this.options)}}return D.\u0275fac=function(L){return new(L||D)(R.LFG(Z.eN))},D.\u0275prov=R.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},8964:(Me,ne,E)=>{E.d(ne,{$:()=>D});var c=E(5861),R=E(4464),Z=E(5e3),A=E(6858);let D=(()=>{class z{constructor(S){this.httpService=S,this.allMilestones=[]}addNewMilestone(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.addNewMilestone(S))})()}getMilestoneList(){var S=this;return(0,c.Z)(function*(){S.allMilestones=yield(0,R.n)(S.httpService.getMilestoneList())})()}getMilestoneById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getMilestoneById(S))})()}getAllDetailsMilestoneById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getAllDetailsMilestoneById(S))})()}getFilteredMilestoneList(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getFilteredMilestoneList(S))})()}updateMilestoneById(S,w){var j=this;return(0,c.Z)(function*(){return yield(0,R.n)(j.httpService.updateMilestoneById(S,w))})()}deleteMilestoneById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.deleteMilestoneById(S))})()}getCustomFilterList(S){return"All"===S?this.allMilestones:this.allMilestones.filter(w=>w.status==S)}}return z.\u0275fac=function(S){return new(S||z)(Z.LFG(A.O))},z.\u0275prov=Z.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},9565:(Me,ne,E)=>{E.d(ne,{f:()=>A});var c=E(2626),R=E(5e3),Z=E(9808);let A=(()=>{class D{constructor(L,S){this.router=L,this.location=S,this.history=[],this.history.push(this.router.url),this.router.events.subscribe(w=>{w instanceof c.m2&&this.history.push(w.urlAfterRedirects)})}back(){this.history.pop(),this.history.length>0?this.location.back():this.router.navigateByUrl("/")}}return D.\u0275fac=function(L){return new(L||D)(R.LFG(c.F0),R.LFG(Z.Ye))},D.\u0275prov=R.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},9854:(Me,ne,E)=>{E.d(ne,{s:()=>D});var c=E(5861),R=E(4464),Z=E(5e3),A=E(6858);let D=(()=>{class z{constructor(S){this.httpService=S,this.allRequests=[]}addNewRequest(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.addNewRequest({data:S}))})()}getAllRequestList(){var S=this;return(0,c.Z)(function*(){S.allRequests=yield(0,R.n)(S.httpService.getRequestList())})()}getRequestById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getRequestById(S))})()}getAllDetailsRequestById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getAllDetailsRequestById(S))})()}getUnlinkedRequestList(){var S=this;return(0,c.Z)(function*(){return yield(0,R.n)(S.httpService.getUnlinkedRequestList())})()}getFilteredRequestList(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getFilteredRequestList(S))})()}updateRequestById(S,w){var j=this;return(0,c.Z)(function*(){return yield(0,R.n)(j.httpService.updateRequestById(S,w))})()}deleteRequestById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.deleteRequestById(S))})()}getCustomFilterList(S){return"All"===S?this.allRequests:this.allRequests.filter(w=>w.status==S)}getRequest(S){let j=S.data.attributes;return j.id=S.data.id,console.log(j),j}}return z.\u0275fac=function(S){return new(S||z)(Z.LFG(A.O))},z.\u0275prov=Z.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},6138:(Me,ne,E)=>{E.d(ne,{M:()=>D});var c=E(5861),R=E(4464),Z=E(5e3),A=E(6858);let D=(()=>{class z{constructor(S){this.httpService=S,this.allTasks=[]}addNewTask(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.addNewTask(S))})()}getTaskList(){var S=this;return(0,c.Z)(function*(){S.allTasks=yield(0,R.n)(S.httpService.getTaskList())})()}getTaskById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getTaskById(S))})()}getAllDetailsTaskById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getAllDetailsTaskById(S))})()}getUnlinkedTaskList(){var S=this;return(0,c.Z)(function*(){return yield(0,R.n)(S.httpService.getUnlinkedTasks())})()}getFilteredTaskList(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.getFilteredTaskList(S))})()}updateTaskById(S,w){var j=this;return(0,c.Z)(function*(){return yield(0,R.n)(j.httpService.updateTaskById(S,w))})()}deleteTaskById(S){var w=this;return(0,c.Z)(function*(){return yield(0,R.n)(w.httpService.deleteTaskById(S))})()}getCustomFilterList(S){return"All"===S?this.allTasks:this.allTasks.filter(w=>w.status==S)}}return z.\u0275fac=function(S){return new(S||z)(Z.LFG(A.O))},z.\u0275prov=Z.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},8769:(Me,ne,E)=>{E.r(ne),E.d(ne,{addMentionNodes:()=>j,addTagNodes:()=>ee,getMentionsPlugin:()=>L,mentionNode:()=>S,tagNode:()=>w});var c=E(6956),R=E(412);const D=(q=null,function(le,G,ae){return ae=ae||this,clearTimeout(q),q=setTimeout(function(){le.apply(ae,arguments)},G),q});var q;function L(G){G=Object.assign({},{mentionTrigger:"@",hashtagTrigger:"#",allowSpace:!0,getSuggestions:(ue,ie,pe)=>{pe([])},getSuggestionsHTML:ue=>'<div class="suggestion-item-list">'+ue.map(ie=>'<div class="suggestion-item">'+ie.name+"</div>").join("")+"</div>",activeClass:"suggestion-item-active",suggestionTextClass:"prosemirror-suggestion",maxNoOfSuggestions:10,delay:500},G);var ae=null,J=document.createElement("div"),ce=function(){J.style.display="none"},Y=function(ue,ie){J.querySelector(".suggestion-item-list").childNodes[ue].classList.remove(ie)},fe=function(ue,ie){J.querySelector(".suggestion-item-list").childNodes[ue].classList.add(ie)},xe=function(ue,ie,pe){Y(ie.index,pe.activeClass),ie.index=ue,fe(ie.index,pe.activeClass)},Ee=function(ue,ie,pe){var ke=ie.suggestions[ie.index],Q=ue.state.schema.nodes[ie.type].create("mention"===ie.type?{name:ke.name,id:ke.id,email:ke.email}:{tag:ke.tag}),M=ue.state.tr.replaceWith(ie.range.from,ie.range.to,Q);ue.dispatch(M)};return new c.Sy({key:new c.H$("autosuggestions"),state:{init:()=>({active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0}),apply(ue,ie){var pe={active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0},ke=ue.selection;if(ke.from!==ke.to)return pe;const Q=function A(q,le){var G=q.before();const ae=q.doc.textBetween(G,q.pos,"\n","\0");var fe,J=function Z(q,le,G){return{mention:G?new RegExp("(^|\\s)"+q+"([\\w-\\+]+\\s?[\\w-\\+]*)$"):new RegExp("(^|\\s)"+q+"([\\w-\\+]+)$"),tag:new RegExp("(^|\\s)"+le+"([\\w-]+)$")}}(le.mentionTrigger,le.hashtagTrigger,le.allowSpace),se=ae.match(J.mention),ce=ae.match(J.tag),Y=se||ce;if(se?fe="mention":ce&&(fe="tag"),Y){Y.index=Y[0].startsWith(" ")?Y.index+1:Y.index,Y[0]=Y[0].startsWith(" ")?Y[0].substring(1,Y[0].length):Y[0];var xe=q.start()+Y.index;return{range:{from:xe,to:xe+Y[0].length},queryText:Y[2],type:fe}}}(ke.$from,G);return Q&&(pe.active=!0,pe.range=Q.range,pe.type=Q.type,pe.text=Q.queryText),pe}},props:{handleKeyDown(ue,ie){var Se,Q,M,pe=this.getState(ue.state);return!(!pe.active&&!pe.suggestions.length||(Q=13===ie.keyCode,Se=38===ie.keyCode,M=27===ie.keyCode,40===ie.keyCode?(function(ue,ie,pe){Y(ie.index,pe.activeClass),ie.index++,ie.index=ie.index===ie.suggestions.length?0:ie.index,fe(ie.index,pe.activeClass)}(0,pe,G),0):Se?(function(ue,ie,pe){Y(ie.index,pe.activeClass),ie.index--,ie.index=-1===ie.index?ie.suggestions.length-1:ie.index,fe(ie.index,pe.activeClass)}(0,pe,G),0):Q?(Ee(ue,pe),0):!M||(clearTimeout(ae),ce(),this.state={active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0},0)))},decorations(ue){const{active:ie,range:pe}=this.getState(ue);return ie?R.EH.create(ue.doc,[R.p.inline(pe.from,pe.to,{nodeName:"span",class:G.suggestionTextClass})]):null}},view(){return{update:ue=>{var ie=this.key.getState(ue.state);if(!ie.text)return ce(),void clearTimeout(ae);ae=D(function(){G.getSuggestions(ie.type,ie.text,function(pe){ie.suggestions=pe,function(ue,ie,pe,ke){J.innerHTML=ke.getSuggestionsHTML(pe,ie.type),J.querySelectorAll(".suggestion-item").forEach(function($,te){$.addEventListener("click",function(){Ee(ue,ie),ue.focus()}),$.addEventListener("mouseover",function(){xe(te,ie,ke)}),$.addEventListener("mouseout",function(){xe(te,ie,ke)})}),fe(ie.index,ke.activeClass);var M=ue.domAtPos(ue.state.selection.$from.pos).node.querySelector("."+ke.suggestionTextClass),P=M.getBoundingClientRect();document.body.appendChild(J),J.classList.add("suggestion-item-container"),J.style.position="fixed",J.style.left=P.left+"px",J.style.top=M.offsetHeight+P.top+"px",J.style.display="block",J.style.zIndex="999999"}(ue,ie,pe,G)})},G.delay,this)}}}})}const S={group:"inline",inline:!0,atom:!0,attrs:{id:"",name:"",email:""},selectable:!1,draggable:!1,toDOM:q=>["span",{"data-mention-id":q.attrs.id,"data-mention-name":q.attrs.name,"data-mention-email":q.attrs.email,class:"prosemirror-mention-node"},"@"+q.attrs.name||0],parseDOM:[{tag:"span[data-mention-id][data-mention-name][data-mention-email]",getAttrs:q=>({id:q.getAttribute("data-mention-id"),name:q.getAttribute("data-mention-name"),email:q.getAttribute("data-mention-email")})}]},w={group:"inline",inline:!0,atom:!0,attrs:{tag:""},selectable:!1,draggable:!1,toDOM:q=>["span",{"data-tag":q.attrs.tag,class:"prosemirror-tag-node"},"#"+q.attrs.tag],parseDOM:[{tag:"span[data-tag]",getAttrs:q=>({tag:q.getAttribute("data-tag")})}]};function j(q){return q.append({mention:S})}function ee(q){return q.append({tag:w})}},4464:(Me,ne,E)=>{E.d(ne,{n:()=>R});var c=E(6805);function R(Z,A){const D="object"==typeof A;return new Promise((z,L)=>{let w,S=!1;Z.subscribe({next:j=>{w=j,S=!0},error:L,complete:()=>{S?z(w):D?z(A.defaultValue):L(new c.K)}})})}},8197:(Me,ne,E)=>{function c(x){this.content=x}E.d(ne,{aw:()=>Le,PW:()=>X,HY:()=>D,vc:()=>w,ZU:()=>Pe,NB:()=>Q,Ts:()=>ke,e4:()=>j,V_:()=>Mt,p2:()=>ee}),c.prototype={constructor:c,find:function(x){for(var i=0;i<this.content.length;i+=2)if(this.content[i]===x)return i;return-1},get:function(x){var i=this.find(x);return-1==i?void 0:this.content[i+1]},update:function(x,i,s){var a=s&&s!=x?this.remove(s):this,f=a.find(x),m=a.content.slice();return-1==f?m.push(s||x,i):(m[f+1]=i,s&&(m[f]=s)),new c(m)},remove:function(x){var i=this.find(x);if(-1==i)return this;var s=this.content.slice();return s.splice(i,2),new c(s)},addToStart:function(x,i){return new c([x,i].concat(this.remove(x).content))},addToEnd:function(x,i){var s=this.remove(x).content.slice();return s.push(x,i),new c(s)},addBefore:function(x,i,s){var a=this.remove(i),f=a.content.slice(),m=a.find(x);return f.splice(-1==m?f.length:m,0,i,s),new c(f)},forEach:function(x){for(var i=0;i<this.content.length;i+=2)x(this.content[i],this.content[i+1])},prepend:function(x){return(x=c.from(x)).size?new c(x.content.concat(this.subtract(x).content)):this},append:function(x){return(x=c.from(x)).size?new c(this.subtract(x).content.concat(x.content)):this},subtract:function(x){var i=this;x=c.from(x);for(var s=0;s<x.content.length;s+=2)i=i.remove(x.content[s]);return i},get size(){return this.content.length>>1}},c.from=function(x){if(x instanceof c)return x;var i=[];if(x)for(var s in x)i.push(s,x[s]);return new c(i)};const R=c;function Z(x,i,s){for(let a=0;;a++){if(a==x.childCount||a==i.childCount)return x.childCount==i.childCount?null:s;let f=x.child(a),m=i.child(a);if(f!=m){if(!f.sameMarkup(m))return s;if(f.isText&&f.text!=m.text){for(let O=0;f.text[O]==m.text[O];O++)s++;return s}if(f.content.size||m.content.size){let O=Z(f.content,m.content,s+1);if(null!=O)return O}s+=f.nodeSize}else s+=f.nodeSize}}function A(x,i,s,a){for(let f=x.childCount,m=i.childCount;;){if(0==f||0==m)return f==m?null:{a:s,b:a};let O=x.child(--f),N=i.child(--m),B=O.nodeSize;if(O!=N){if(!O.sameMarkup(N))return{a:s,b:a};if(O.isText&&O.text!=N.text){let oe=0,de=Math.min(O.text.length,N.text.length);for(;oe<de&&O.text[O.text.length-oe-1]==N.text[N.text.length-oe-1];)oe++,s--,a--;return{a:s,b:a}}if(O.content.size||N.content.size){let oe=A(O.content,N.content,s-1,a-1);if(oe)return oe}s-=B,a-=B}else s-=B,a-=B}}class D{constructor(i,s){if(this.content=i,this.size=s||0,null==s)for(let a=0;a<i.length;a++)this.size+=i[a].nodeSize}nodesBetween(i,s,a,f=0,m){for(let O=0,N=0;N<s;O++){let B=this.content[O],oe=N+B.nodeSize;if(oe>i&&!1!==a(B,f+N,m||null,O)&&B.content.size){let de=N+1;B.nodesBetween(Math.max(0,i-de),Math.min(B.content.size,s-de),a,f+de)}N=oe}}descendants(i){this.nodesBetween(0,this.size,i)}textBetween(i,s,a,f){let m="",O=!0;return this.nodesBetween(i,s,(N,B)=>{N.isText?(m+=N.text.slice(Math.max(i,B)-B,s-B),O=!a):N.isLeaf?(f?m+="function"==typeof f?f(N):f:N.type.spec.leafText&&(m+=N.type.spec.leafText(N)),O=!a):!O&&N.isBlock&&(m+=a,O=!0)},0),m}append(i){if(!i.size)return this;if(!this.size)return i;let s=this.lastChild,a=i.firstChild,f=this.content.slice(),m=0;for(s.isText&&s.sameMarkup(a)&&(f[f.length-1]=s.withText(s.text+a.text),m=1);m<i.content.length;m++)f.push(i.content[m]);return new D(f,this.size+i.size)}cut(i,s=this.size){if(0==i&&s==this.size)return this;let a=[],f=0;if(s>i)for(let m=0,O=0;O<s;m++){let N=this.content[m],B=O+N.nodeSize;B>i&&((O<i||B>s)&&(N=N.isText?N.cut(Math.max(0,i-O),Math.min(N.text.length,s-O)):N.cut(Math.max(0,i-O-1),Math.min(N.content.size,s-O-1))),a.push(N),f+=N.nodeSize),O=B}return new D(a,f)}cutByIndex(i,s){return i==s?D.empty:0==i&&s==this.content.length?this:new D(this.content.slice(i,s))}replaceChild(i,s){let a=this.content[i];if(a==s)return this;let f=this.content.slice(),m=this.size+s.nodeSize-a.nodeSize;return f[i]=s,new D(f,m)}addToStart(i){return new D([i].concat(this.content),this.size+i.nodeSize)}addToEnd(i){return new D(this.content.concat(i),this.size+i.nodeSize)}eq(i){if(this.content.length!=i.content.length)return!1;for(let s=0;s<this.content.length;s++)if(!this.content[s].eq(i.content[s]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(i){let s=this.content[i];if(!s)throw new RangeError("Index "+i+" out of range for "+this);return s}maybeChild(i){return this.content[i]||null}forEach(i){for(let s=0,a=0;s<this.content.length;s++){let f=this.content[s];i(f,a,s),a+=f.nodeSize}}findDiffStart(i,s=0){return Z(this,i,s)}findDiffEnd(i,s=this.size,a=i.size){return A(this,i,s,a)}findIndex(i,s=-1){if(0==i)return L(0,i);if(i==this.size)return L(this.content.length,i);if(i>this.size||i<0)throw new RangeError(`Position ${i} outside of fragment (${this})`);for(let a=0,f=0;;a++){let O=f+this.child(a).nodeSize;if(O>=i)return O==i||s>0?L(a+1,O):L(a,f);f=O}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(i=>i.toJSON()):null}static fromJSON(i,s){if(!s)return D.empty;if(!Array.isArray(s))throw new RangeError("Invalid input for Fragment.fromJSON");return new D(s.map(i.nodeFromJSON))}static fromArray(i){if(!i.length)return D.empty;let s,a=0;for(let f=0;f<i.length;f++){let m=i[f];a+=m.nodeSize,f&&m.isText&&i[f-1].sameMarkup(m)?(s||(s=i.slice(0,f)),s[s.length-1]=m.withText(s[s.length-1].text+m.text)):s&&s.push(m)}return new D(s||i,a)}static from(i){if(!i)return D.empty;if(i instanceof D)return i;if(Array.isArray(i))return this.fromArray(i);if(i.attrs)return new D([i],i.nodeSize);throw new RangeError("Can not convert "+i+" to a Fragment"+(i.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}D.empty=new D([],0);const z={index:0,offset:0};function L(x,i){return z.index=x,z.offset=i,z}function S(x,i){if(x===i)return!0;if(!x||"object"!=typeof x||!i||"object"!=typeof i)return!1;let s=Array.isArray(x);if(Array.isArray(i)!=s)return!1;if(s){if(x.length!=i.length)return!1;for(let a=0;a<x.length;a++)if(!S(x[a],i[a]))return!1}else{for(let a in x)if(!(a in i)||!S(x[a],i[a]))return!1;for(let a in i)if(!(a in x))return!1}return!0}let w=(()=>{class x{constructor(s,a){this.type=s,this.attrs=a}addToSet(s){let a,f=!1;for(let m=0;m<s.length;m++){let O=s[m];if(this.eq(O))return s;if(this.type.excludes(O.type))a||(a=s.slice(0,m));else{if(O.type.excludes(this.type))return s;!f&&O.type.rank>this.type.rank&&(a||(a=s.slice(0,m)),a.push(this),f=!0),a&&a.push(O)}}return a||(a=s.slice()),f||a.push(this),a}removeFromSet(s){for(let a=0;a<s.length;a++)if(this.eq(s[a]))return s.slice(0,a).concat(s.slice(a+1));return s}isInSet(s){for(let a=0;a<s.length;a++)if(this.eq(s[a]))return!0;return!1}eq(s){return this==s||this.type==s.type&&S(this.attrs,s.attrs)}toJSON(){let s={type:this.type.name};for(let a in this.attrs){s.attrs=this.attrs;break}return s}static fromJSON(s,a){if(!a)throw new RangeError("Invalid input for Mark.fromJSON");let f=s.marks[a.type];if(!f)throw new RangeError(`There is no mark type ${a.type} in this schema`);return f.create(a.attrs)}static sameSet(s,a){if(s==a)return!0;if(s.length!=a.length)return!1;for(let f=0;f<s.length;f++)if(!s[f].eq(a[f]))return!1;return!0}static setFrom(s){if(!s||Array.isArray(s)&&0==s.length)return x.none;if(s instanceof x)return[s];let a=s.slice();return a.sort((f,m)=>f.type.rank-m.type.rank),a}}return x.none=[],x})();class j extends Error{}class ee{constructor(i,s,a){this.content=i,this.openStart=s,this.openEnd=a}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(i,s){let a=le(this.content,i+this.openStart,s);return a&&new ee(a,this.openStart,this.openEnd)}removeBetween(i,s){return new ee(q(this.content,i+this.openStart,s+this.openStart),this.openStart,this.openEnd)}eq(i){return this.content.eq(i.content)&&this.openStart==i.openStart&&this.openEnd==i.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let i={content:this.content.toJSON()};return this.openStart>0&&(i.openStart=this.openStart),this.openEnd>0&&(i.openEnd=this.openEnd),i}static fromJSON(i,s){if(!s)return ee.empty;let a=s.openStart||0,f=s.openEnd||0;if("number"!=typeof a||"number"!=typeof f)throw new RangeError("Invalid input for Slice.fromJSON");return new ee(D.fromJSON(i,s.content),a,f)}static maxOpen(i,s=!0){let a=0,f=0;for(let m=i.firstChild;m&&!m.isLeaf&&(s||!m.type.spec.isolating);m=m.firstChild)a++;for(let m=i.lastChild;m&&!m.isLeaf&&(s||!m.type.spec.isolating);m=m.lastChild)f++;return new ee(i,a,f)}}function q(x,i,s){let{index:a,offset:f}=x.findIndex(i),m=x.maybeChild(a),{index:O,offset:N}=x.findIndex(s);if(f==i||m.isText){if(N!=s&&!x.child(O).isText)throw new RangeError("Removing non-flat range");return x.cut(0,i).append(x.cut(s))}if(a!=O)throw new RangeError("Removing non-flat range");return x.replaceChild(a,m.copy(q(m.content,i-f-1,s-f-1)))}function le(x,i,s,a){let{index:f,offset:m}=x.findIndex(i),O=x.maybeChild(f);if(m==i||O.isText)return a&&!a.canReplace(f,f,s)?null:x.cut(0,i).append(s).append(x.cut(i));let N=le(O.content,i-m-1,s);return N&&x.replaceChild(f,O.copy(N))}function G(x,i,s){if(s.openStart>x.depth)throw new j("Inserted content deeper than insertion position");if(x.depth-s.openStart!=i.depth-s.openEnd)throw new j("Inconsistent open depths");return ae(x,i,s,0)}function ae(x,i,s,a){let f=x.index(a),m=x.node(a);if(f==i.index(a)&&a<x.depth-s.openStart){let O=ae(x,i,s,a+1);return m.copy(m.content.replaceChild(f,O))}if(s.content.size){if(s.openStart||s.openEnd||x.depth!=a||i.depth!=a){let{start:O,end:N}=function Ie(x,i){let s=i.depth-x.openStart,f=i.node(s).copy(x.content);for(let m=s-1;m>=0;m--)f=i.node(m).copy(D.from(f));return{start:f.resolveNoCache(x.openStart+s),end:f.resolveNoCache(f.content.size-x.openEnd-s)}}(s,x);return fe(m,xe(x,O,N,i,a))}{let O=x.parent,N=O.content;return fe(O,N.cut(0,x.parentOffset).append(s.content).append(N.cut(i.parentOffset)))}}return fe(m,_e(x,i,a))}function J(x,i){if(!i.type.compatibleContent(x.type))throw new j("Cannot join "+i.type.name+" onto "+x.type.name)}function se(x,i,s){let a=x.node(s);return J(a,i.node(s)),a}function ce(x,i){let s=i.length-1;s>=0&&x.isText&&x.sameMarkup(i[s])?i[s]=x.withText(i[s].text+x.text):i.push(x)}function Y(x,i,s,a){let f=(i||x).node(s),m=0,O=i?i.index(s):f.childCount;x&&(m=x.index(s),x.depth>s?m++:x.textOffset&&(ce(x.nodeAfter,a),m++));for(let N=m;N<O;N++)ce(f.child(N),a);i&&i.depth==s&&i.textOffset&&ce(i.nodeBefore,a)}function fe(x,i){if(!x.type.validContent(i))throw new j("Invalid content for node "+x.type.name);return x.copy(i)}function xe(x,i,s,a,f){let m=x.depth>f&&se(x,i,f+1),O=a.depth>f&&se(s,a,f+1),N=[];return Y(null,x,f,N),m&&O&&i.index(f)==s.index(f)?(J(m,O),ce(fe(m,xe(x,i,s,a,f+1)),N)):(m&&ce(fe(m,_e(x,i,f+1)),N),Y(i,s,f,N),O&&ce(fe(O,_e(s,a,f+1)),N)),Y(a,null,f,N),new D(N)}function _e(x,i,s){let a=[];return Y(null,x,s,a),x.depth>s&&ce(fe(se(x,i,s+1),_e(x,i,s+1)),a),Y(i,null,s,a),new D(a)}ee.empty=new ee(D.empty,0,0);class Ee{constructor(i,s,a){this.pos=i,this.path=s,this.parentOffset=a,this.depth=s.length/3-1}resolveDepth(i){return null==i?this.depth:i<0?this.depth+i:i}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(i){return this.path[3*this.resolveDepth(i)]}index(i){return this.path[3*this.resolveDepth(i)+1]}indexAfter(i){return i=this.resolveDepth(i),this.index(i)+(i!=this.depth||this.textOffset?1:0)}start(i){return 0==(i=this.resolveDepth(i))?0:this.path[3*i-1]+1}end(i){return i=this.resolveDepth(i),this.start(i)+this.node(i).content.size}before(i){if(!(i=this.resolveDepth(i)))throw new RangeError("There is no position before the top-level node");return i==this.depth+1?this.pos:this.path[3*i-1]}after(i){if(!(i=this.resolveDepth(i)))throw new RangeError("There is no position after the top-level node");return i==this.depth+1?this.pos:this.path[3*i-1]+this.path[3*i].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let i=this.parent,s=this.index(this.depth);if(s==i.childCount)return null;let a=this.pos-this.path[this.path.length-1],f=i.child(s);return a?i.child(s).cut(a):f}get nodeBefore(){let i=this.index(this.depth),s=this.pos-this.path[this.path.length-1];return s?this.parent.child(i).cut(0,s):0==i?null:this.parent.child(i-1)}posAtIndex(i,s){s=this.resolveDepth(s);let a=this.path[3*s],f=0==s?0:this.path[3*s-1]+1;for(let m=0;m<i;m++)f+=a.child(m).nodeSize;return f}marks(){let i=this.parent,s=this.index();if(0==i.content.size)return w.none;if(this.textOffset)return i.child(s).marks;let a=i.maybeChild(s-1),f=i.maybeChild(s);if(!a){let N=a;a=f,f=N}let m=a.marks;for(var O=0;O<m.length;O++)!1===m[O].type.spec.inclusive&&(!f||!m[O].isInSet(f.marks))&&(m=m[O--].removeFromSet(m));return m}marksAcross(i){let s=this.parent.maybeChild(this.index());if(!s||!s.isInline)return null;let a=s.marks,f=i.parent.maybeChild(i.index());for(var m=0;m<a.length;m++)!1===a[m].type.spec.inclusive&&(!f||!a[m].isInSet(f.marks))&&(a=a[m--].removeFromSet(a));return a}sharedDepth(i){for(let s=this.depth;s>0;s--)if(this.start(s)<=i&&this.end(s)>=i)return s;return 0}blockRange(i=this,s){if(i.pos<this.pos)return i.blockRange(this);for(let a=this.depth-(this.parent.inlineContent||this.pos==i.pos?1:0);a>=0;a--)if(i.pos<=this.end(a)&&(!s||s(this.node(a))))return new ke(this,i,a);return null}sameParent(i){return this.pos-this.parentOffset==i.pos-i.parentOffset}max(i){return i.pos>this.pos?i:this}min(i){return i.pos<this.pos?i:this}toString(){let i="";for(let s=1;s<=this.depth;s++)i+=(i?"/":"")+this.node(s).type.name+"_"+this.index(s-1);return i+":"+this.parentOffset}static resolve(i,s){if(!(s>=0&&s<=i.content.size))throw new RangeError("Position "+s+" out of range");let a=[],f=0,m=s;for(let O=i;;){let{index:N,offset:B}=O.content.findIndex(m),oe=m-B;if(a.push(O,N,f+B),!oe||(O=O.child(N),O.isText))break;m=oe-1,f+=B+1}return new Ee(s,a,m)}static resolveCached(i,s){for(let f=0;f<ue.length;f++){let m=ue[f];if(m.pos==s&&m.doc==i)return m}let a=ue[ie]=Ee.resolve(i,s);return ie=(ie+1)%pe,a}}let ue=[],ie=0,pe=12;class ke{constructor(i,s,a){this.$from=i,this.$to=s,this.depth=a}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Se=Object.create(null);class Q{constructor(i,s,a,f=w.none){this.type=i,this.attrs=s,this.marks=f,this.content=a||D.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(i){return this.content.child(i)}maybeChild(i){return this.content.maybeChild(i)}forEach(i){this.content.forEach(i)}nodesBetween(i,s,a,f=0){this.content.nodesBetween(i,s,a,f,this)}descendants(i){this.nodesBetween(0,this.content.size,i)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(i,s,a,f){return this.content.textBetween(i,s,a,f)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(i){return this==i||this.sameMarkup(i)&&this.content.eq(i.content)}sameMarkup(i){return this.hasMarkup(i.type,i.attrs,i.marks)}hasMarkup(i,s,a){return this.type==i&&S(this.attrs,s||i.defaultAttrs||Se)&&w.sameSet(this.marks,a||w.none)}copy(i=null){return i==this.content?this:new Q(this.type,this.attrs,i,this.marks)}mark(i){return i==this.marks?this:new Q(this.type,this.attrs,this.content,i)}cut(i,s=this.content.size){return 0==i&&s==this.content.size?this:this.copy(this.content.cut(i,s))}slice(i,s=this.content.size,a=!1){if(i==s)return ee.empty;let f=this.resolve(i),m=this.resolve(s),O=a?0:f.sharedDepth(s),N=f.start(O),oe=f.node(O).content.cut(f.pos-N,m.pos-N);return new ee(oe,f.depth-O,m.depth-O)}replace(i,s,a){return G(this.resolve(i),this.resolve(s),a)}nodeAt(i){for(let s=this;;){let{index:a,offset:f}=s.content.findIndex(i);if(s=s.maybeChild(a),!s)return null;if(f==i||s.isText)return s;i-=f+1}}childAfter(i){let{index:s,offset:a}=this.content.findIndex(i);return{node:this.content.maybeChild(s),index:s,offset:a}}childBefore(i){if(0==i)return{node:null,index:0,offset:0};let{index:s,offset:a}=this.content.findIndex(i);if(a<i)return{node:this.content.child(s),index:s,offset:a};let f=this.content.child(s-1);return{node:f,index:s-1,offset:a-f.nodeSize}}resolve(i){return Ee.resolveCached(this,i)}resolveNoCache(i){return Ee.resolve(this,i)}rangeHasMark(i,s,a){let f=!1;return s>i&&this.nodesBetween(i,s,m=>(a.isInSet(m.marks)&&(f=!0),!f)),f}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let i=this.type.name;return this.content.size&&(i+="("+this.content.toStringInner()+")"),P(this.marks,i)}contentMatchAt(i){let s=this.type.contentMatch.matchFragment(this.content,0,i);if(!s)throw new Error("Called contentMatchAt on a node with invalid content");return s}canReplace(i,s,a=D.empty,f=0,m=a.childCount){let O=this.contentMatchAt(i).matchFragment(a,f,m),N=O&&O.matchFragment(this.content,s);if(!N||!N.validEnd)return!1;for(let B=f;B<m;B++)if(!this.type.allowsMarks(a.child(B).marks))return!1;return!0}canReplaceWith(i,s,a,f){if(f&&!this.type.allowsMarks(f))return!1;let m=this.contentMatchAt(i).matchType(a),O=m&&m.matchFragment(this.content,s);return!!O&&O.validEnd}canAppend(i){return i.content.size?this.canReplace(this.childCount,this.childCount,i.content):this.type.compatibleContent(i.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let i=w.none;for(let s=0;s<this.marks.length;s++)i=this.marks[s].addToSet(i);if(!w.sameSet(i,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(s=>s.type.name)}`);this.content.forEach(s=>s.check())}toJSON(){let i={type:this.type.name};for(let s in this.attrs){i.attrs=this.attrs;break}return this.content.size&&(i.content=this.content.toJSON()),this.marks.length&&(i.marks=this.marks.map(s=>s.toJSON())),i}static fromJSON(i,s){if(!s)throw new RangeError("Invalid input for Node.fromJSON");let a=null;if(s.marks){if(!Array.isArray(s.marks))throw new RangeError("Invalid mark data for Node.fromJSON");a=s.marks.map(i.markFromJSON)}if("text"==s.type){if("string"!=typeof s.text)throw new RangeError("Invalid text node in JSON");return i.text(s.text,a)}let f=D.fromJSON(i,s.content);return i.nodeType(s.type).create(s.attrs,f,a)}}Q.prototype.text=void 0;class M extends Q{constructor(i,s,a,f){if(super(i,s,null,f),!a)throw new RangeError("Empty text nodes are not allowed");this.text=a}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):P(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(i,s){return this.text.slice(i,s)}get nodeSize(){return this.text.length}mark(i){return i==this.marks?this:new M(this.type,this.attrs,this.text,i)}withText(i){return i==this.text?this:new M(this.type,this.attrs,i,this.marks)}cut(i=0,s=this.text.length){return 0==i&&s==this.text.length?this:this.withText(this.text.slice(i,s))}eq(i){return this.sameMarkup(i)&&this.text==i.text}toJSON(){let i=super.toJSON();return i.text=this.text,i}}function P(x,i){for(let s=x.length-1;s>=0;s--)i=x[s].type.name+"("+i+")";return i}class I{constructor(i){this.validEnd=i,this.next=[],this.wrapCache=[]}static parse(i,s){let a=new $(i,s);if(null==a.next)return I.empty;let f=te(a);a.next&&a.err("Unexpected trailing text");let m=function dt(x){let i=Object.create(null);return function s(a){let f=[];a.forEach(O=>{x[O].forEach(({term:N,to:B})=>{if(!N)return;let oe;for(let de=0;de<f.length;de++)f[de][0]==N&&(oe=f[de][1]);nt(x,B).forEach(de=>{oe||f.push([N,oe=[]]),-1==oe.indexOf(de)&&oe.push(de)})})});let m=i[a.join(",")]=new I(a.indexOf(x.length-1)>-1);for(let O=0;O<f.length;O++){let N=f[O][1].sort(ht);m.next.push({type:f[O][0],next:i[N.join(",")]||s(N)})}return m}(nt(x,0))}(function Ke(x){let i=[[]];return f(function m(O,N){if("choice"==O.type)return O.exprs.reduce((B,oe)=>B.concat(m(oe,N)),[]);if("seq"!=O.type){if("star"==O.type){let B=s();return a(N,B),f(m(O.expr,B),B),[a(B)]}if("plus"==O.type){let B=s();return f(m(O.expr,N),B),f(m(O.expr,B),B),[a(B)]}if("opt"==O.type)return[a(N)].concat(m(O.expr,N));if("range"==O.type){let B=N;for(let oe=0;oe<O.min;oe++){let de=s();f(m(O.expr,B),de),B=de}if(-1==O.max)f(m(O.expr,B),B);else for(let oe=O.min;oe<O.max;oe++){let de=s();a(B,de),f(m(O.expr,B),de),B=de}return[a(B)]}if("name"==O.type)return[a(N,void 0,O.value)];throw new Error("Unknown expr type")}for(let B=0;;B++){let oe=m(O.exprs[B],N);if(B==O.exprs.length-1)return oe;f(oe,N=s())}}(x,0),s()),i;function s(){return i.push([])-1}function a(O,N,B){let oe={term:B,to:N};return i[O].push(oe),oe}function f(O,N){O.forEach(B=>B.to=N)}}(f));return function Ge(x,i){for(let s=0,a=[x];s<a.length;s++){let f=a[s],m=!f.validEnd,O=[];for(let N=0;N<f.next.length;N++){let{type:B,next:oe}=f.next[N];O.push(B.name),m&&!(B.isText||B.hasRequiredAttrs())&&(m=!1),-1==a.indexOf(oe)&&a.push(oe)}m&&i.err("Only non-generatable nodes ("+O.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(m,a),m}matchType(i){for(let s=0;s<this.next.length;s++)if(this.next[s].type==i)return this.next[s].next;return null}matchFragment(i,s=0,a=i.childCount){let f=this;for(let m=s;f&&m<a;m++)f=f.matchType(i.child(m).type);return f}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let i=0;i<this.next.length;i++){let{type:s}=this.next[i];if(!s.isText&&!s.hasRequiredAttrs())return s}return null}compatible(i){for(let s=0;s<this.next.length;s++)for(let a=0;a<i.next.length;a++)if(this.next[s].type==i.next[a].type)return!0;return!1}fillBefore(i,s=!1,a=0){let f=[this];return function m(O,N){let B=O.matchFragment(i,a);if(B&&(!s||B.validEnd))return D.from(N.map(oe=>oe.createAndFill()));for(let oe=0;oe<O.next.length;oe++){let{type:de,next:Re}=O.next[oe];if(!de.isText&&!de.hasRequiredAttrs()&&-1==f.indexOf(Re)){f.push(Re);let rt=m(Re,N.concat(de));if(rt)return rt}}return null}(this,[])}findWrapping(i){for(let a=0;a<this.wrapCache.length;a+=2)if(this.wrapCache[a]==i)return this.wrapCache[a+1];let s=this.computeWrapping(i);return this.wrapCache.push(i,s),s}computeWrapping(i){let s=Object.create(null),a=[{match:this,type:null,via:null}];for(;a.length;){let f=a.shift(),m=f.match;if(m.matchType(i)){let O=[];for(let N=f;N.type;N=N.via)O.push(N.type);return O.reverse()}for(let O=0;O<m.next.length;O++){let{type:N,next:B}=m.next[O];!N.isLeaf&&!N.hasRequiredAttrs()&&!(N.name in s)&&(!f.type||B.validEnd)&&(a.push({match:N.contentMatch,type:N,via:f}),s[N.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(i){if(i>=this.next.length)throw new RangeError(`There's no ${i}th edge in this content match`);return this.next[i]}toString(){let i=[];return function s(a){i.push(a);for(let f=0;f<a.next.length;f++)-1==i.indexOf(a.next[f].next)&&s(a.next[f].next)}(this),i.map((a,f)=>{let m=f+(a.validEnd?"*":" ")+" ";for(let O=0;O<a.next.length;O++)m+=(O?", ":"")+a.next[O].type.name+"->"+i.indexOf(a.next[O].next);return m}).join("\n")}}I.empty=new I(!0);class ${constructor(i,s){this.string=i,this.nodeTypes=s,this.inline=null,this.pos=0,this.tokens=i.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(i){return this.next==i&&(this.pos++||!0)}err(i){throw new SyntaxError(i+" (in content expression '"+this.string+"')")}}function te(x){let i=[];do{i.push(me(x))}while(x.eat("|"));return 1==i.length?i[0]:{type:"choice",exprs:i}}function me(x){let i=[];do{i.push(Oe(x))}while(x.next&&")"!=x.next&&"|"!=x.next);return 1==i.length?i[0]:{type:"seq",exprs:i}}function Oe(x){let i=function qe(x){if(x.eat("(")){let i=te(x);return x.eat(")")||x.err("Missing closing paren"),i}if(!/\W/.test(x.next)){let i=function Te(x,i){let s=x.nodeTypes,a=s[i];if(a)return[a];let f=[];for(let m in s){let O=s[m];O.groups.indexOf(i)>-1&&f.push(O)}return 0==f.length&&x.err("No node type or group '"+i+"' found"),f}(x,x.next).map(s=>(null==x.inline?x.inline=s.isInline:x.inline!=s.isInline&&x.err("Mixing inline and block content"),{type:"name",value:s}));return x.pos++,1==i.length?i[0]:{type:"choice",exprs:i}}x.err("Unexpected token '"+x.next+"'")}(x);for(;;)if(x.eat("+"))i={type:"plus",expr:i};else if(x.eat("*"))i={type:"star",expr:i};else if(x.eat("?"))i={type:"opt",expr:i};else{if(!x.eat("{"))break;i=ve(x,i)}return i}function be(x){/\D/.test(x.next)&&x.err("Expected number, got '"+x.next+"'");let i=Number(x.next);return x.pos++,i}function ve(x,i){let s=be(x),a=s;return x.eat(",")&&(a="}"!=x.next?be(x):-1),x.eat("}")||x.err("Unclosed braced range"),{type:"range",min:s,max:a,expr:i}}function ht(x,i){return i-x}function nt(x,i){let s=[];return function a(f){let m=x[f];if(1==m.length&&!m[0].term)return a(m[0].to);s.push(f);for(let O=0;O<m.length;O++){let{term:N,to:B}=m[O];!N&&-1==s.indexOf(B)&&a(B)}}(i),s.sort(ht)}function ut(x){let i=Object.create(null);for(let s in x){let a=x[s];if(!a.hasDefault)return null;i[s]=a.default}return i}function Je(x,i){let s=Object.create(null);for(let a in x){let f=i&&i[a];if(void 0===f){let m=x[a];if(!m.hasDefault)throw new RangeError("No value supplied for attribute "+a);f=m.default}s[a]=f}return s}function $e(x){let i=Object.create(null);if(x)for(let s in x)i[s]=new ft(x[s]);return i}class Ue{constructor(i,s,a){this.name=i,this.schema=s,this.spec=a,this.markSet=null,this.groups=a.group?a.group.split(" "):[],this.attrs=$e(a.attrs),this.defaultAttrs=ut(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(a.inline||"text"==i),this.isText="text"==i}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==I.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let i in this.attrs)if(this.attrs[i].isRequired)return!0;return!1}compatibleContent(i){return this==i||this.contentMatch.compatible(i.contentMatch)}computeAttrs(i){return!i&&this.defaultAttrs?this.defaultAttrs:Je(this.attrs,i)}create(i=null,s,a){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Q(this,this.computeAttrs(i),D.from(s),w.setFrom(a))}createChecked(i=null,s,a){if(s=D.from(s),!this.validContent(s))throw new RangeError("Invalid content for node "+this.name);return new Q(this,this.computeAttrs(i),s,w.setFrom(a))}createAndFill(i=null,s,a){if(i=this.computeAttrs(i),(s=D.from(s)).size){let O=this.contentMatch.fillBefore(s);if(!O)return null;s=O.append(s)}let f=this.contentMatch.matchFragment(s),m=f&&f.fillBefore(D.empty,!0);return m?new Q(this,i,s.append(m),w.setFrom(a)):null}validContent(i){let s=this.contentMatch.matchFragment(i);if(!s||!s.validEnd)return!1;for(let a=0;a<i.childCount;a++)if(!this.allowsMarks(i.child(a).marks))return!1;return!0}allowsMarkType(i){return null==this.markSet||this.markSet.indexOf(i)>-1}allowsMarks(i){if(null==this.markSet)return!0;for(let s=0;s<i.length;s++)if(!this.allowsMarkType(i[s].type))return!1;return!0}allowedMarks(i){if(null==this.markSet)return i;let s;for(let a=0;a<i.length;a++)this.allowsMarkType(i[a].type)?s&&s.push(i[a]):s||(s=i.slice(0,a));return s?s.length?s:w.none:i}static compile(i,s){let a=Object.create(null);i.forEach((m,O)=>a[m]=new Ue(m,s,O));let f=s.spec.topNode||"doc";if(!a[f])throw new RangeError("Schema is missing its top node type ('"+f+"')");if(!a.text)throw new RangeError("Every schema needs a 'text' type");for(let m in a.text.attrs)throw new RangeError("The text node type should not have attributes");return a}}class ft{constructor(i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default}get isRequired(){return!this.hasDefault}}class Pe{constructor(i,s,a,f){this.name=i,this.rank=s,this.schema=a,this.spec=f,this.attrs=$e(f.attrs),this.excluded=null;let m=ut(this.attrs);this.instance=m?new w(this,m):null}create(i=null){return!i&&this.instance?this.instance:new w(this,Je(this.attrs,i))}static compile(i,s){let a=Object.create(null),f=0;return i.forEach((m,O)=>a[m]=new Pe(m,f++,s,O)),a}removeFromSet(i){for(var s=0;s<i.length;s++)i[s].type==this&&(i=i.slice(0,s).concat(i.slice(s+1)),s--);return i}isInSet(i){for(let s=0;s<i.length;s++)if(i[s].type==this)return i[s]}excludes(i){return this.excluded.indexOf(i)>-1}}class Mt{constructor(i){this.cached=Object.create(null),this.spec={nodes:R.from(i.nodes),marks:R.from(i.marks||{}),topNode:i.topNode},this.nodes=Ue.compile(this.spec.nodes,this),this.marks=Pe.compile(this.spec.marks,this);let s=Object.create(null);for(let a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");let f=this.nodes[a],m=f.spec.content||"",O=f.spec.marks;f.contentMatch=s[m]||(s[m]=I.parse(m,this.nodes)),f.inlineContent=f.contentMatch.inlineContent,f.markSet="_"==O?null:O?it(this,O.split(" ")):""!=O&&f.inlineContent?null:[]}for(let a in this.marks){let f=this.marks[a],m=f.spec.excludes;f.excluded=null==m?[f]:""==m?[]:it(this,m.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(i,s=null,a,f){if("string"==typeof i)i=this.nodeType(i);else{if(!(i instanceof Ue))throw new RangeError("Invalid node type: "+i);if(i.schema!=this)throw new RangeError("Node type from different schema used ("+i.name+")")}return i.createChecked(s,a,f)}text(i,s){let a=this.nodes.text;return new M(a,a.defaultAttrs,i,w.setFrom(s))}mark(i,s){return"string"==typeof i&&(i=this.marks[i]),i.create(s)}nodeFromJSON(i){return Q.fromJSON(this,i)}markFromJSON(i){return w.fromJSON(this,i)}nodeType(i){let s=this.nodes[i];if(!s)throw new RangeError("Unknown node type: "+i);return s}}function it(x,i){let s=[];for(let a=0;a<i.length;a++){let f=i[a],m=x.marks[f],O=m;if(m)s.push(m);else for(let N in x.marks){let B=x.marks[N];("_"==f||B.spec.group&&B.spec.group.split(" ").indexOf(f)>-1)&&s.push(O=B)}if(!O)throw new SyntaxError("Unknown mark type: '"+i[a]+"'")}return s}class Le{constructor(i,s){this.schema=i,this.rules=s,this.tags=[],this.styles=[],s.forEach(a=>{a.tag?this.tags.push(a):a.style&&this.styles.push(a)}),this.normalizeLists=!this.tags.some(a=>{if(!/^(ul|ol)\b/.test(a.tag)||!a.node)return!1;let f=i.nodes[a.node];return f.contentMatch.matchType(f)})}parse(i,s={}){let a=new p(this,s,!1);return a.addAll(i,s.from,s.to),a.finish()}parseSlice(i,s={}){let a=new p(this,s,!0);return a.addAll(i,s.from,s.to),ee.maxOpen(a.finish())}matchTag(i,s,a){for(let f=a?this.tags.indexOf(a)+1:0;f<this.tags.length;f++){let m=this.tags[f];if(k(i,m.tag)&&(void 0===m.namespace||i.namespaceURI==m.namespace)&&(!m.context||s.matchesContext(m.context))){if(m.getAttrs){let O=m.getAttrs(i);if(!1===O)continue;m.attrs=O||void 0}return m}}}matchStyle(i,s,a,f){for(let m=f?this.styles.indexOf(f)+1:0;m<this.styles.length;m++){let O=this.styles[m],N=O.style;if(!(0!=N.indexOf(i)||O.context&&!a.matchesContext(O.context)||N.length>i.length&&(61!=N.charCodeAt(i.length)||N.slice(i.length+1)!=s))){if(O.getAttrs){let B=O.getAttrs(s);if(!1===B)continue;O.attrs=B||void 0}return O}}}static schemaRules(i){let s=[];function a(f){let m=null==f.priority?50:f.priority,O=0;for(;O<s.length;O++){let N=s[O];if((null==N.priority?50:N.priority)<m)break}s.splice(O,0,f)}for(let f in i.marks){let m=i.marks[f].spec.parseDOM;m&&m.forEach(O=>{a(O=v(O)),O.mark=f})}for(let f in i.nodes){let m=i.nodes[f].spec.parseDOM;m&&m.forEach(O=>{a(O=v(O)),O.node=f})}return s}static fromSchema(i){return i.cached.domParser||(i.cached.domParser=new Le(i,Le.schemaRules(i)))}}const Ze={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},pt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},mt={ol:!0,ul:!0};function T(x,i,s){return null!=i?(i?1:0)|("full"===i?2:0):x&&"pre"==x.whitespace?3:-5&s}class d{constructor(i,s,a,f,m,O,N){this.type=i,this.attrs=s,this.marks=a,this.pendingMarks=f,this.solid=m,this.options=N,this.content=[],this.activeMarks=w.none,this.stashMarks=[],this.match=O||(4&N?null:i.contentMatch)}findWrapping(i){if(!this.match){if(!this.type)return[];let s=this.type.contentMatch.fillBefore(D.from(i));if(!s){let f,a=this.type.contentMatch;return(f=a.findWrapping(i.type))?(this.match=a,f):null}this.match=this.type.contentMatch.matchFragment(s)}return this.match.findWrapping(i.type)}finish(i){if(!(1&this.options)){let f,a=this.content[this.content.length-1];if(a&&a.isText&&(f=/[ \t\r\n\u000c]+$/.exec(a.text))){let m=a;a.text.length==f[0].length?this.content.pop():this.content[this.content.length-1]=m.withText(m.text.slice(0,m.text.length-f[0].length))}}let s=D.from(this.content);return!i&&this.match&&(s=s.append(this.match.fillBefore(D.empty,!0))),this.type?this.type.create(this.attrs,s,this.marks):s}popFromStashMark(i){for(let s=this.stashMarks.length-1;s>=0;s--)if(i.eq(this.stashMarks[s]))return this.stashMarks.splice(s,1)[0]}applyPending(i){for(let s=0,a=this.pendingMarks;s<a.length;s++){let f=a[s];(this.type?this.type.allowsMarkType(f.type):W(f.type,i))&&!f.isInSet(this.activeMarks)&&(this.activeMarks=f.addToSet(this.activeMarks),this.pendingMarks=f.removeFromSet(this.pendingMarks))}}inlineContext(i){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:i.parentNode&&!Ze.hasOwnProperty(i.parentNode.nodeName.toLowerCase())}}class p{constructor(i,s,a){this.parser=i,this.options=s,this.isOpen=a,this.open=0;let m,f=s.topNode,O=T(null,s.preserveWhitespace,0)|(a?4:0);m=f?new d(f.type,f.attrs,w.none,w.none,!0,s.topMatch||f.type.contentMatch,O):new d(a?null:i.schema.topNodeType,null,w.none,w.none,!0,null,O),this.nodes=[m],this.find=s.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(i){if(3==i.nodeType)this.addTextNode(i);else if(1==i.nodeType){let s=i.getAttribute("style"),a=s?this.readStyles(function b(x){let s,i=/\s*([\w-]+)\s*:\s*([^;]+)/g,a=[];for(;s=i.exec(x);)a.push(s[1],s[2].trim());return a}(s)):null,f=this.top;if(null!=a)for(let m=0;m<a.length;m++)this.addPendingMark(a[m]);if(this.addElement(i),null!=a)for(let m=0;m<a.length;m++)this.removePendingMark(a[m],f)}}addTextNode(i){let s=i.nodeValue,a=this.top;if(2&a.options||a.inlineContext(i)||/[^ \t\r\n\u000c]/.test(s)){if(1&a.options)s=2&a.options?s.replace(/\r\n?/g,"\n"):s.replace(/\r?\n|\r/g," ");else if(s=s.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(s)&&this.open==this.nodes.length-1){let f=a.content[a.content.length-1],m=i.previousSibling;(!f||m&&"BR"==m.nodeName||f.isText&&/[ \t\r\n\u000c]$/.test(f.text))&&(s=s.slice(1))}s&&this.insertNode(this.parser.schema.text(s)),this.findInText(i)}else this.findInside(i)}addElement(i,s){let f,a=i.nodeName.toLowerCase();mt.hasOwnProperty(a)&&this.parser.normalizeLists&&function y(x){for(let i=x.firstChild,s=null;i;i=i.nextSibling){let a=1==i.nodeType?i.nodeName.toLowerCase():null;a&&mt.hasOwnProperty(a)&&s?(s.appendChild(i),i=s):"li"==a?s=i:a&&(s=null)}}(i);let m=this.options.ruleFromNode&&this.options.ruleFromNode(i)||(f=this.parser.matchTag(i,this,s));if(m?m.ignore:pt.hasOwnProperty(a))this.findInside(i),this.ignoreFallback(i);else if(!m||m.skip||m.closeParent){m&&m.closeParent?this.open=Math.max(0,this.open-1):m&&m.skip.nodeType&&(i=m.skip);let O,N=this.top,B=this.needsBlock;if(Ze.hasOwnProperty(a))O=!0,N.type||(this.needsBlock=!0);else if(!i.firstChild)return void this.leafFallback(i);this.addAll(i),O&&this.sync(N),this.needsBlock=B}else this.addElementByRule(i,m,!1===m.consuming?f:void 0)}leafFallback(i){"BR"==i.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(i.ownerDocument.createTextNode("\n"))}ignoreFallback(i){"BR"==i.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(i){let s=w.none;e:for(let a=0;a<i.length;a+=2)for(let f;;){let m=this.parser.matchStyle(i[a],i[a+1],this,f);if(!m)continue e;if(m.ignore)return null;if(s=this.parser.schema.marks[m.mark].create(m.attrs).addToSet(s),!1!==m.consuming)break;f=m}return s}addElementByRule(i,s,a){let f,m,O;s.node?(m=this.parser.schema.nodes[s.node],m.isLeaf?this.insertNode(m.create(s.attrs))||this.leafFallback(i):f=this.enter(m,s.attrs||null,s.preserveWhitespace)):(O=this.parser.schema.marks[s.mark].create(s.attrs),this.addPendingMark(O));let N=this.top;if(m&&m.isLeaf)this.findInside(i);else if(a)this.addElement(i,a);else if(s.getContent)this.findInside(i),s.getContent(i,this.parser.schema).forEach(B=>this.insertNode(B));else{let B=i;"string"==typeof s.contentElement?B=i.querySelector(s.contentElement):"function"==typeof s.contentElement?B=s.contentElement(i):s.contentElement&&(B=s.contentElement),this.findAround(i,B,!0),this.addAll(B)}f&&this.sync(N)&&this.open--,O&&this.removePendingMark(O,N)}addAll(i,s,a){let f=s||0;for(let m=s?i.childNodes[s]:i.firstChild,O=null==a?null:i.childNodes[a];m!=O;m=m.nextSibling,++f)this.findAtPoint(i,f),this.addDOM(m);this.findAtPoint(i,f)}findPlace(i){let s,a;for(let f=this.open;f>=0;f--){let m=this.nodes[f],O=m.findWrapping(i);if(O&&(!s||s.length>O.length)&&(s=O,a=m,!O.length)||m.solid)break}if(!s)return!1;this.sync(a);for(let f=0;f<s.length;f++)this.enterInner(s[f],null,!1);return!0}insertNode(i){if(i.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&this.enterInner(s)}if(this.findPlace(i)){this.closeExtra();let s=this.top;s.applyPending(i.type),s.match&&(s.match=s.match.matchType(i.type));let a=s.activeMarks;for(let f=0;f<i.marks.length;f++)(!s.type||s.type.allowsMarkType(i.marks[f].type))&&(a=i.marks[f].addToSet(a));return s.content.push(i.mark(a)),!0}return!1}enter(i,s,a){let f=this.findPlace(i.create(s));return f&&this.enterInner(i,s,!0,a),f}enterInner(i,s=null,a=!1,f){this.closeExtra();let m=this.top;m.applyPending(i),m.match=m.match&&m.match.matchType(i);let O=T(i,f,m.options);4&m.options&&0==m.content.length&&(O|=4),this.nodes.push(new d(i,s,m.activeMarks,m.pendingMarks,a,null,O)),this.open++}closeExtra(i=!1){let s=this.nodes.length-1;if(s>this.open){for(;s>this.open;s--)this.nodes[s-1].content.push(this.nodes[s].finish(i));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(i){for(let s=this.open;s>=0;s--)if(this.nodes[s]==i)return this.open=s,!0;return!1}get currentPos(){this.closeExtra();let i=0;for(let s=this.open;s>=0;s--){let a=this.nodes[s].content;for(let f=a.length-1;f>=0;f--)i+=a[f].nodeSize;s&&i++}return i}findAtPoint(i,s){if(this.find)for(let a=0;a<this.find.length;a++)this.find[a].node==i&&this.find[a].offset==s&&(this.find[a].pos=this.currentPos)}findInside(i){if(this.find)for(let s=0;s<this.find.length;s++)null==this.find[s].pos&&1==i.nodeType&&i.contains(this.find[s].node)&&(this.find[s].pos=this.currentPos)}findAround(i,s,a){if(i!=s&&this.find)for(let f=0;f<this.find.length;f++)null==this.find[f].pos&&1==i.nodeType&&i.contains(this.find[f].node)&&s.compareDocumentPosition(this.find[f].node)&(a?2:4)&&(this.find[f].pos=this.currentPos)}findInText(i){if(this.find)for(let s=0;s<this.find.length;s++)this.find[s].node==i&&(this.find[s].pos=this.currentPos-(i.nodeValue.length-this.find[s].offset))}matchesContext(i){if(i.indexOf("|")>-1)return i.split(/\s*\|\s*/).some(this.matchesContext,this);let s=i.split("/"),a=this.options.context,f=!(this.isOpen||a&&a.parent.type!=this.nodes[0].type),m=(f?0:1)-(a?a.depth+1:0),O=(N,B)=>{for(;N>=0;N--){let oe=s[N];if(""==oe){if(N==s.length-1||0==N)continue;for(;B>=m;B--)if(O(N-1,B))return!0;return!1}{let de=B>0||0==B&&f?this.nodes[B].type:a&&B>=m?a.node(B-m).type:null;if(!de||de.name!=oe&&-1==de.groups.indexOf(oe))return!1;B--}}return!0};return O(s.length-1,this.open)}textblockFromContext(){let i=this.options.context;if(i)for(let s=i.depth;s>=0;s--){let a=i.node(s).contentMatchAt(i.indexAfter(s)).defaultType;if(a&&a.isTextblock&&a.defaultAttrs)return a}for(let s in this.parser.schema.nodes){let a=this.parser.schema.nodes[s];if(a.isTextblock&&a.defaultAttrs)return a}}addPendingMark(i){let s=function K(x,i){for(let s=0;s<i.length;s++)if(x.eq(i[s]))return i[s]}(i,this.top.pendingMarks);s&&this.top.stashMarks.push(s),this.top.pendingMarks=i.addToSet(this.top.pendingMarks)}removePendingMark(i,s){for(let a=this.open;a>=0;a--){let f=this.nodes[a];if(f.pendingMarks.lastIndexOf(i)>-1)f.pendingMarks=i.removeFromSet(f.pendingMarks);else{f.activeMarks=i.removeFromSet(f.activeMarks);let O=f.popFromStashMark(i);O&&f.type&&f.type.allowsMarkType(O.type)&&(f.activeMarks=O.addToSet(f.activeMarks))}if(f==s)break}}}function k(x,i){return(x.matches||x.msMatchesSelector||x.webkitMatchesSelector||x.mozMatchesSelector).call(x,i)}function v(x){let i={};for(let s in x)i[s]=x[s];return i}function W(x,i){let s=i.schema.nodes;for(let a in s){let f=s[a];if(!f.allowsMarkType(x))continue;let m=[],O=N=>{m.push(N);for(let B=0;B<N.edgeCount;B++){let{type:oe,next:de}=N.edge(B);if(oe==i||m.indexOf(de)<0&&O(de))return!0}};if(O(f.contentMatch))return!0}}class X{constructor(i,s){this.nodes=i,this.marks=s}serializeFragment(i,s={},a){a||(a=he(s).createDocumentFragment());let f=a,m=[];return i.forEach(O=>{if(m.length||O.marks.length){let N=0,B=0;for(;N<m.length&&B<O.marks.length;){let oe=O.marks[B];if(this.marks[oe.type.name]){if(!oe.eq(m[N][0])||!1===oe.type.spec.spanning)break;N++,B++}else B++}for(;N<m.length;)f=m.pop()[1];for(;B<O.marks.length;){let oe=O.marks[B++],de=this.serializeMark(oe,O.isInline,s);de&&(m.push([oe,f]),f.appendChild(de.dom),f=de.contentDOM||de.dom)}}f.appendChild(this.serializeNodeInner(O,s))}),a}serializeNodeInner(i,s){let{dom:a,contentDOM:f}=X.renderSpec(he(s),this.nodes[i.type.name](i));if(f){if(i.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(i.content,s,f)}return a}serializeNode(i,s={}){let a=this.serializeNodeInner(i,s);for(let f=i.marks.length-1;f>=0;f--){let m=this.serializeMark(i.marks[f],i.isInline,s);m&&((m.contentDOM||m.dom).appendChild(a),a=m.dom)}return a}serializeMark(i,s,a={}){let f=this.marks[i.type.name];return f&&X.renderSpec(he(a),f(i,s))}static renderSpec(i,s,a=null){if("string"==typeof s)return{dom:i.createTextNode(s)};if(null!=s.nodeType)return{dom:s};if(s.dom&&null!=s.dom.nodeType)return s;let f=s[0],m=f.indexOf(" ");m>0&&(a=f.slice(0,m),f=f.slice(m+1));let O,N=a?i.createElementNS(a,f):i.createElement(f),B=s[1],oe=1;if(B&&"object"==typeof B&&null==B.nodeType&&!Array.isArray(B)){oe=2;for(let de in B)if(null!=B[de]){let Re=de.indexOf(" ");Re>0?N.setAttributeNS(de.slice(0,Re),de.slice(Re+1),B[de]):N.setAttribute(de,B[de])}}for(let de=oe;de<s.length;de++){let Re=s[de];if(0===Re){if(de<s.length-1||de>oe)throw new RangeError("Content hole must be the only child of its parent node");return{dom:N,contentDOM:N}}{let{dom:rt,contentDOM:Ct}=X.renderSpec(i,Re,a);if(N.appendChild(rt),Ct){if(O)throw new RangeError("Multiple content holes");O=Ct}}}return{dom:N,contentDOM:O}}static fromSchema(i){return i.cached.domSerializer||(i.cached.domSerializer=new X(this.nodesFromSchema(i),this.marksFromSchema(i)))}static nodesFromSchema(i){let s=re(i.nodes);return s.text||(s.text=a=>a.text),s}static marksFromSchema(i){return re(i.marks)}}function re(x){let i={};for(let s in x){let a=x[s].spec.toDOM;a&&(i[s]=a)}return i}function he(x){return x.document||window.document}},3981:(Me,ne,E)=>{E.d(ne,{fK:()=>q});var c=E(8197);const R=["p",0],Z=["blockquote",0],A=["hr"],D=["pre",["code",0]],z=["br"],S=["em",0],w=["strong",0],j=["code",0],q=new c.V_({nodes:{doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>R},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>Z},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>A},heading:{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:le=>["h"+le.attrs.level,0]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>D},text:{group:"inline"},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:le=>({src:le.getAttribute("src"),title:le.getAttribute("title"),alt:le.getAttribute("alt")})}],toDOM(le){let{src:G,alt:ae,title:J}=le.attrs;return["img",{src:G,alt:ae,title:J}]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>z}},marks:{link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:le=>({href:le.getAttribute("href"),title:le.getAttribute("title")})}],toDOM(le){let{href:G,title:ae}=le.attrs;return["a",{href:G,title:ae},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>S},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:le=>"normal"!=le.style.fontWeight&&null},{style:"font-weight",getAttrs:le=>/^(bold(er)?|[5-9]\d{2,})$/.test(le)&&null}],toDOM:()=>w},code:{parseDOM:[{tag:"code"}],toDOM:()=>j}}})},6956:(Me,ne,E)=>{E.d(ne,{Bs:()=>S,C1:()=>q,H$:()=>Se,Sy:()=>ie,Y1:()=>A,qv:()=>j,yy:()=>Ee});var c=E(8197),R=E(3060);const Z=Object.create(null);class A{constructor(M,P,I){this.$anchor=M,this.$head=P,this.ranges=I||[new D(M.min(P),M.max(P))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let M=this.ranges;for(let P=0;P<M.length;P++)if(M[P].$from.pos!=M[P].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(M,P=c.p2.empty){let I=P.content.lastChild,$=null;for(let Oe=0;Oe<P.openEnd;Oe++)$=I,I=I.lastChild;let te=M.steps.length,me=this.ranges;for(let Oe=0;Oe<me.length;Oe++){let{$from:be,$to:ve}=me[Oe],Te=M.mapping.slice(te);M.replaceRange(Te.map(be.pos),Te.map(ve.pos),Oe?c.p2.empty:P),0==Oe&&ae(M,te,(I?I.isInline:$&&$.isTextblock)?-1:1)}}replaceWith(M,P){let I=M.steps.length,$=this.ranges;for(let te=0;te<$.length;te++){let{$from:me,$to:Oe}=$[te],be=M.mapping.slice(I),ve=be.map(me.pos),Te=be.map(Oe.pos);te?M.deleteRange(ve,Te):(M.replaceRangeWith(ve,Te,P),ae(M,I,P.isInline?-1:1))}}static findFrom(M,P,I=!1){let $=M.parent.inlineContent?new S(M):G(M.node(0),M.parent,M.pos,M.index(),P,I);if($)return $;for(let te=M.depth-1;te>=0;te--){let me=P<0?G(M.node(0),M.node(te),M.before(te+1),M.index(te),P,I):G(M.node(0),M.node(te),M.after(te+1),M.index(te)+1,P,I);if(me)return me}return null}static near(M,P=1){return this.findFrom(M,P)||this.findFrom(M,-P)||new q(M.node(0))}static atStart(M){return G(M,M,0,0,1)||new q(M)}static atEnd(M){return G(M,M,M.content.size,M.childCount,-1)||new q(M)}static fromJSON(M,P){if(!P||!P.type)throw new RangeError("Invalid input for Selection.fromJSON");let I=Z[P.type];if(!I)throw new RangeError(`No selection type ${P.type} defined`);return I.fromJSON(M,P)}static jsonID(M,P){if(M in Z)throw new RangeError("Duplicate use of selection JSON ID "+M);return Z[M]=P,P.prototype.jsonID=M,P}getBookmark(){return S.between(this.$anchor,this.$head).getBookmark()}}A.prototype.visible=!0;class D{constructor(M,P){this.$from=M,this.$to=P}}let z=!1;function L(Q){!z&&!Q.parent.inlineContent&&(z=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+Q.parent.type.name+")"))}class S extends A{constructor(M,P=M){L(M),L(P),super(M,P)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(M,P){let I=M.resolve(P.map(this.head));if(!I.parent.inlineContent)return A.near(I);let $=M.resolve(P.map(this.anchor));return new S($.parent.inlineContent?$:I,I)}replace(M,P=c.p2.empty){if(super.replace(M,P),P==c.p2.empty){let I=this.$from.marksAcross(this.$to);I&&M.ensureMarks(I)}}eq(M){return M instanceof S&&M.anchor==this.anchor&&M.head==this.head}getBookmark(){return new w(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(M,P){if("number"!=typeof P.anchor||"number"!=typeof P.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new S(M.resolve(P.anchor),M.resolve(P.head))}static create(M,P,I=P){let $=M.resolve(P);return new this($,I==P?$:M.resolve(I))}static between(M,P,I){let $=M.pos-P.pos;if((!I||$)&&(I=$>=0?1:-1),!P.parent.inlineContent){let te=A.findFrom(P,I,!0)||A.findFrom(P,-I,!0);if(!te)return A.near(P,I);P=te.$head}return M.parent.inlineContent||(0==$||(M=(A.findFrom(M,-I,!0)||A.findFrom(M,I,!0)).$anchor).pos<P.pos!=$<0)&&(M=P),new S(M,P)}}A.jsonID("text",S);class w{constructor(M,P){this.anchor=M,this.head=P}map(M){return new w(M.map(this.anchor),M.map(this.head))}resolve(M){return S.between(M.resolve(this.anchor),M.resolve(this.head))}}class j extends A{constructor(M){let P=M.nodeAfter,I=M.node(0).resolve(M.pos+P.nodeSize);super(M,I),this.node=P}map(M,P){let{deleted:I,pos:$}=P.mapResult(this.anchor),te=M.resolve($);return I?A.near(te):new j(te)}content(){return new c.p2(c.HY.from(this.node),0,0)}eq(M){return M instanceof j&&M.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ee(this.anchor)}static fromJSON(M,P){if("number"!=typeof P.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new j(M.resolve(P.anchor))}static create(M,P){return new j(M.resolve(P))}static isSelectable(M){return!M.isText&&!1!==M.type.spec.selectable}}j.prototype.visible=!1,A.jsonID("node",j);class ee{constructor(M){this.anchor=M}map(M){let{deleted:P,pos:I}=M.mapResult(this.anchor);return P?new w(I,I):new ee(I)}resolve(M){let P=M.resolve(this.anchor),I=P.nodeAfter;return I&&j.isSelectable(I)?new j(P):A.near(P)}}class q extends A{constructor(M){super(M.resolve(0),M.resolve(M.content.size))}replace(M,P=c.p2.empty){if(P==c.p2.empty){M.delete(0,M.doc.content.size);let I=A.atStart(M.doc);I.eq(M.selection)||M.setSelection(I)}else super.replace(M,P)}toJSON(){return{type:"all"}}static fromJSON(M){return new q(M)}map(M){return new q(M)}eq(M){return M instanceof q}getBookmark(){return le}}A.jsonID("all",q);const le={map(){return this},resolve:Q=>new q(Q)};function G(Q,M,P,I,$,te=!1){if(M.inlineContent)return S.create(Q,P);for(let me=I-($>0?0:1);$>0?me<M.childCount:me>=0;me+=$){let Oe=M.child(me);if(Oe.isAtom){if(!te&&j.isSelectable(Oe))return j.create(Q,P-($<0?Oe.nodeSize:0))}else{let be=G(Q,Oe,P+$,$<0?Oe.childCount:0,$,te);if(be)return be}P+=Oe.nodeSize*$}return null}function ae(Q,M,P){let I=Q.steps.length-1;if(I<M)return;let me,$=Q.steps[I];($ instanceof R.Pu||$ instanceof R.FC)&&(Q.mapping.maps[I].forEach((Oe,be,ve,Te)=>{null==me&&(me=Te)}),Q.setSelection(A.near(Q.doc.resolve(me),P)))}class Y extends R.wx{constructor(M){super(M.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=M.selection,this.storedMarks=M.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(M){if(M.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=M,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(M){return this.storedMarks=M,this.updated|=2,this}ensureMarks(M){return c.vc.sameSet(this.storedMarks||this.selection.$from.marks(),M)||this.setStoredMarks(M),this}addStoredMark(M){return this.ensureMarks(M.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(M){return this.ensureMarks(M.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(M,P){super.addStep(M,P),this.updated=-3&this.updated,this.storedMarks=null}setTime(M){return this.time=M,this}replaceSelection(M){return this.selection.replace(this,M),this}replaceSelectionWith(M,P=!0){let I=this.selection;return P&&(M=M.mark(this.storedMarks||(I.empty?I.$from.marks():I.$from.marksAcross(I.$to)||c.vc.none))),I.replaceWith(this,M),this}deleteSelection(){return this.selection.replace(this),this}insertText(M,P,I){let $=this.doc.type.schema;if(null==P)return M?this.replaceSelectionWith($.text(M),!0):this.deleteSelection();{if(null==I&&(I=P),I=null==I?P:I,!M)return this.deleteRange(P,I);let te=this.storedMarks;if(!te){let me=this.doc.resolve(P);te=I==P?me.marks():me.marksAcross(this.doc.resolve(I))}return this.replaceRangeWith(P,I,$.text(M,te)),this.selection.empty||this.setSelection(A.near(this.selection.$to)),this}}setMeta(M,P){return this.meta["string"==typeof M?M:M.key]=P,this}getMeta(M){return this.meta["string"==typeof M?M:M.key]}get isGeneric(){for(let M in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function fe(Q,M){return M&&Q?Q.bind(M):Q}class xe{constructor(M,P,I){this.name=M,this.init=fe(P.init,I),this.apply=fe(P.apply,I)}}const _e=[new xe("doc",{init:Q=>Q.doc||Q.schema.topNodeType.createAndFill(),apply:Q=>Q.doc}),new xe("selection",{init:(Q,M)=>Q.selection||A.atStart(M.doc),apply:Q=>Q.selection}),new xe("storedMarks",{init:Q=>Q.storedMarks||null,apply:(Q,M,P,I)=>I.selection.$cursor?Q.storedMarks:null}),new xe("scrollToSelection",{init:()=>0,apply:(Q,M)=>Q.scrolledIntoView?M+1:M})];class Ie{constructor(M,P){this.schema=M,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=_e.slice(),P&&P.forEach(I=>{if(this.pluginsByKey[I.key])throw new RangeError("Adding different instances of a keyed plugin ("+I.key+")");this.plugins.push(I),this.pluginsByKey[I.key]=I,I.spec.state&&this.fields.push(new xe(I.key,I.spec.state,I))})}}class Ee{constructor(M){this.config=M}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(M){return this.applyTransaction(M).state}filterTransaction(M,P=-1){for(let I=0;I<this.config.plugins.length;I++)if(I!=P){let $=this.config.plugins[I];if($.spec.filterTransaction&&!$.spec.filterTransaction.call($,M,this))return!1}return!0}applyTransaction(M){if(!this.filterTransaction(M))return{state:this,transactions:[]};let P=[M],I=this.applyInner(M),$=null;for(;;){let te=!1;for(let me=0;me<this.config.plugins.length;me++){let Oe=this.config.plugins[me];if(Oe.spec.appendTransaction){let be=$?$[me].n:0,ve=$?$[me].state:this,Te=be<P.length&&Oe.spec.appendTransaction.call(Oe,be?P.slice(be):P,ve,I);if(Te&&I.filterTransaction(Te,me)){if(Te.setMeta("appendedTransaction",M),!$){$=[];for(let qe=0;qe<this.config.plugins.length;qe++)$.push(qe<me?{state:I,n:P.length}:{state:this,n:0})}P.push(Te),I=I.applyInner(Te),te=!0}$&&($[me]={state:I,n:P.length})}}if(!te)return{state:I,transactions:P}}}applyInner(M){if(!M.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let P=new Ee(this.config),I=this.config.fields;for(let $=0;$<I.length;$++){let te=I[$];P[te.name]=te.apply(M,this[te.name],this,P)}return P}get tr(){return new Y(this)}static create(M){let P=new Ie(M.doc?M.doc.type.schema:M.schema,M.plugins),I=new Ee(P);for(let $=0;$<P.fields.length;$++)I[P.fields[$].name]=P.fields[$].init(M,I);return I}reconfigure(M){let P=new Ie(this.schema,M.plugins),I=P.fields,$=new Ee(P);for(let te=0;te<I.length;te++){let me=I[te].name;$[me]=this.hasOwnProperty(me)?this[me]:I[te].init(M,$)}return $}toJSON(M){let P={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(P.storedMarks=this.storedMarks.map(I=>I.toJSON())),M&&"object"==typeof M)for(let I in M){if("doc"==I||"selection"==I)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let $=M[I],te=$.spec.state;te&&te.toJSON&&(P[I]=te.toJSON.call($,this[$.key]))}return P}static fromJSON(M,P,I){if(!P)throw new RangeError("Invalid input for EditorState.fromJSON");if(!M.schema)throw new RangeError("Required config field 'schema' missing");let $=new Ie(M.schema,M.plugins),te=new Ee($);return $.fields.forEach(me=>{if("doc"==me.name)te.doc=c.NB.fromJSON(M.schema,P.doc);else if("selection"==me.name)te.selection=A.fromJSON(te.doc,P.selection);else if("storedMarks"==me.name)P.storedMarks&&(te.storedMarks=P.storedMarks.map(M.schema.markFromJSON));else{if(I)for(let Oe in I){let be=I[Oe],ve=be.spec.state;if(be.key==me.name&&ve&&ve.fromJSON&&Object.prototype.hasOwnProperty.call(P,Oe))return void(te[me.name]=ve.fromJSON.call(be,M,P[Oe],te))}te[me.name]=me.init(M,te)}}),te}}function ue(Q,M,P){for(let I in Q){let $=Q[I];$ instanceof Function?$=$.bind(M):"handleDOMEvents"==I&&($=ue($,M,{})),P[I]=$}return P}class ie{constructor(M){this.spec=M,this.props={},M.props&&ue(M.props,this,this.props),this.key=M.key?M.key.key:ke("plugin")}getState(M){return M[this.key]}}const pe=Object.create(null);function ke(Q){return Q in pe?Q+"$"+ ++pe[Q]:(pe[Q]=0,Q+"$")}class Se{constructor(M="key"){this.key=ke(M)}get(M){return M.config.pluginsByKey[this.key]}getState(M){return M[this.key]}}},3060:(Me,ne,E)=>{E.d(ne,{Ax:()=>Oe,FC:()=>xe,GJ:()=>qe,Mn:()=>ve,Pu:()=>fe,dR:()=>dt,k9:()=>pe,nd:()=>Se,nj:()=>nt,vs:()=>le,wx:()=>Ye});var c=E(8197);const Z=Math.pow(2,16);function A(T,d){return T+d*Z}function D(T){return 65535&T}class ee{constructor(d,p,y){this.pos=d,this.delInfo=p,this.recover=y}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class q{constructor(d,p=!1){if(this.ranges=d,this.inverted=p,!d.length&&q.empty)return q.empty}recover(d){let p=0,y=D(d);if(!this.inverted)for(let k=0;k<y;k++)p+=this.ranges[3*k+2]-this.ranges[3*k+1];return this.ranges[3*y]+p+function z(T){return(T-(65535&T))/Z}(d)}mapResult(d,p=1){return this._map(d,p,!1)}map(d,p=1){return this._map(d,p,!0)}_map(d,p,y){let k=0,b=this.inverted?2:1,v=this.inverted?1:2;for(let W=0;W<this.ranges.length;W+=3){let K=this.ranges[W]-(this.inverted?k:0);if(K>d)break;let X=this.ranges[W+b],re=this.ranges[W+v],he=K+X;if(d<=he){let i=K+k+((X?d==K?-1:d==he?1:p:p)<0?0:re);if(y)return i;let s=d==(p<0?K:he)?null:A(W/3,d-K),a=d==K?2:d==he?1:4;return(p<0?d!=K:d!=he)&&(a|=8),new ee(i,a,s)}k+=re-X}return y?d+k:new ee(d+k,0,null)}touches(d,p){let y=0,k=D(p),b=this.inverted?2:1,v=this.inverted?1:2;for(let W=0;W<this.ranges.length;W+=3){let K=this.ranges[W]-(this.inverted?y:0);if(K>d)break;let X=this.ranges[W+b];if(d<=K+X&&W==3*k)return!0;y+=this.ranges[W+v]-X}return!1}forEach(d){let p=this.inverted?2:1,y=this.inverted?1:2;for(let k=0,b=0;k<this.ranges.length;k+=3){let v=this.ranges[k],W=v-(this.inverted?b:0),K=v+(this.inverted?0:b),X=this.ranges[k+p],re=this.ranges[k+y];d(W,W+X,K,K+re),b+=re-X}}invert(){return new q(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(d){return 0==d?q.empty:new q(d<0?[0,-d,0]:[0,0,d])}}q.empty=new q([]);class le{constructor(d=[],p,y=0,k=d.length){this.maps=d,this.mirror=p,this.from=y,this.to=k}slice(d=0,p=this.maps.length){return new le(this.maps,this.mirror,d,p)}copy(){return new le(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(d,p){this.to=this.maps.push(d),null!=p&&this.setMirror(this.maps.length-1,p)}appendMapping(d){for(let p=0,y=this.maps.length;p<d.maps.length;p++){let k=d.getMirror(p);this.appendMap(d.maps[p],null!=k&&k<p?y+k:void 0)}}getMirror(d){if(this.mirror)for(let p=0;p<this.mirror.length;p++)if(this.mirror[p]==d)return this.mirror[p+(p%2?-1:1)]}setMirror(d,p){this.mirror||(this.mirror=[]),this.mirror.push(d,p)}appendMappingInverted(d){for(let p=d.maps.length-1,y=this.maps.length+d.maps.length;p>=0;p--){let k=d.getMirror(p);this.appendMap(d.maps[p].invert(),null!=k&&k>p?y-k-1:void 0)}}invert(){let d=new le;return d.appendMappingInverted(this),d}map(d,p=1){if(this.mirror)return this._map(d,p,!0);for(let y=this.from;y<this.to;y++)d=this.maps[y].map(d,p);return d}mapResult(d,p=1){return this._map(d,p,!1)}_map(d,p,y){let k=0;for(let b=this.from;b<this.to;b++){let W=this.maps[b].mapResult(d,p);if(null!=W.recover){let K=this.getMirror(b);if(null!=K&&K>b&&K<this.to){b=K,d=this.maps[K].recover(W.recover);continue}}k|=W.delInfo,d=W.pos}return y?d:new ee(d,k,null)}}const G=Object.create(null);class ae{getMap(){return q.empty}merge(d){return null}static fromJSON(d,p){if(!p||!p.stepType)throw new RangeError("Invalid input for Step.fromJSON");let y=G[p.stepType];if(!y)throw new RangeError(`No step type ${p.stepType} defined`);return y.fromJSON(d,p)}static jsonID(d,p){if(d in G)throw new RangeError("Duplicate use of step JSON ID "+d);return G[d]=p,p.prototype.jsonID=d,p}}class J{constructor(d,p){this.doc=d,this.failed=p}static ok(d){return new J(d,null)}static fail(d){return new J(null,d)}static fromReplace(d,p,y,k){try{return J.ok(d.replace(p,y,k))}catch(b){if(b instanceof c.e4)return J.fail(b.message);throw b}}}function se(T,d,p){let y=[];for(let k=0;k<T.childCount;k++){let b=T.child(k);b.content.size&&(b=b.copy(se(b.content,d,b))),b.isInline&&(b=d(b,p,k)),y.push(b)}return c.HY.fromArray(y)}class ce extends ae{constructor(d,p,y){super(),this.from=d,this.to=p,this.mark=y}apply(d){let p=d.slice(this.from,this.to),y=d.resolve(this.from),k=y.node(y.sharedDepth(this.to)),b=new c.p2(se(p.content,(v,W)=>v.isAtom&&W.type.allowsMarkType(this.mark.type)?v.mark(this.mark.addToSet(v.marks)):v,k),p.openStart,p.openEnd);return J.fromReplace(d,this.from,this.to,b)}invert(){return new Y(this.from,this.to,this.mark)}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1);return p.deleted&&y.deleted||p.pos>=y.pos?null:new ce(p.pos,y.pos,this.mark)}merge(d){return d instanceof ce&&d.mark.eq(this.mark)&&this.from<=d.to&&this.to>=d.from?new ce(Math.min(this.from,d.from),Math.max(this.to,d.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ce(p.from,p.to,d.markFromJSON(p.mark))}}ae.jsonID("addMark",ce);class Y extends ae{constructor(d,p,y){super(),this.from=d,this.to=p,this.mark=y}apply(d){let p=d.slice(this.from,this.to),y=new c.p2(se(p.content,k=>k.mark(this.mark.removeFromSet(k.marks)),d),p.openStart,p.openEnd);return J.fromReplace(d,this.from,this.to,y)}invert(){return new ce(this.from,this.to,this.mark)}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1);return p.deleted&&y.deleted||p.pos>=y.pos?null:new Y(p.pos,y.pos,this.mark)}merge(d){return d instanceof Y&&d.mark.eq(this.mark)&&this.from<=d.to&&this.to>=d.from?new Y(Math.min(this.from,d.from),Math.max(this.to,d.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Y(p.from,p.to,d.markFromJSON(p.mark))}}ae.jsonID("removeMark",Y);class fe extends ae{constructor(d,p,y,k=!1){super(),this.from=d,this.to=p,this.slice=y,this.structure=k}apply(d){return this.structure&&_e(d,this.from,this.to)?J.fail("Structure replace would overwrite content"):J.fromReplace(d,this.from,this.to,this.slice)}getMap(){return new q([this.from,this.to-this.from,this.slice.size])}invert(d){return new fe(this.from,this.from+this.slice.size,d.slice(this.from,this.to))}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1);return p.deletedAcross&&y.deletedAcross?null:new fe(p.pos,Math.max(p.pos,y.pos),this.slice)}merge(d){if(!(d instanceof fe)||d.structure||this.structure)return null;if(this.from+this.slice.size!=d.from||this.slice.openEnd||d.slice.openStart){if(d.to!=this.from||this.slice.openStart||d.slice.openEnd)return null;{let p=this.slice.size+d.slice.size==0?c.p2.empty:new c.p2(d.slice.content.append(this.slice.content),d.slice.openStart,this.slice.openEnd);return new fe(d.from,this.to,p,this.structure)}}{let p=this.slice.size+d.slice.size==0?c.p2.empty:new c.p2(this.slice.content.append(d.slice.content),this.slice.openStart,d.slice.openEnd);return new fe(this.from,this.to+(d.to-d.from),p,this.structure)}}toJSON(){let d={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(d.slice=this.slice.toJSON()),this.structure&&(d.structure=!0),d}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new fe(p.from,p.to,c.p2.fromJSON(d,p.slice),!!p.structure)}}ae.jsonID("replace",fe);class xe extends ae{constructor(d,p,y,k,b,v,W=!1){super(),this.from=d,this.to=p,this.gapFrom=y,this.gapTo=k,this.slice=b,this.insert=v,this.structure=W}apply(d){if(this.structure&&(_e(d,this.from,this.gapFrom)||_e(d,this.gapTo,this.to)))return J.fail("Structure gap-replace would overwrite content");let p=d.slice(this.gapFrom,this.gapTo);if(p.openStart||p.openEnd)return J.fail("Gap is not a flat range");let y=this.slice.insertAt(this.insert,p.content);return y?J.fromReplace(d,this.from,this.to,y):J.fail("Content does not fit in gap")}getMap(){return new q([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(d){let p=this.gapTo-this.gapFrom;return new xe(this.from,this.from+this.slice.size+p,this.from+this.insert,this.from+this.insert+p,d.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(d){let p=d.mapResult(this.from,1),y=d.mapResult(this.to,-1),k=d.map(this.gapFrom,-1),b=d.map(this.gapTo,1);return p.deletedAcross&&y.deletedAcross||k<p.pos||b>y.pos?null:new xe(p.pos,y.pos,k,b,this.slice,this.insert,this.structure)}toJSON(){let d={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(d.slice=this.slice.toJSON()),this.structure&&(d.structure=!0),d}static fromJSON(d,p){if("number"!=typeof p.from||"number"!=typeof p.to||"number"!=typeof p.gapFrom||"number"!=typeof p.gapTo||"number"!=typeof p.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new xe(p.from,p.to,p.gapFrom,p.gapTo,c.p2.fromJSON(d,p.slice),p.insert,!!p.structure)}}function _e(T,d,p){let y=T.resolve(d),k=p-d,b=y.depth;for(;k>0&&b>0&&y.indexAfter(b)==y.node(b).childCount;)b--,k--;if(k>0){let v=y.node(b).maybeChild(y.indexAfter(b));for(;k>0;){if(!v||v.isLeaf)return!0;v=v.firstChild,k--}}return!1}function ie(T,d,p){return(0==d||T.canReplace(d,T.childCount))&&(p==T.childCount||T.canReplace(0,p))}function pe(T){let p=T.parent.content.cutByIndex(T.startIndex,T.endIndex);for(let y=T.depth;;--y){let k=T.$from.node(y),b=T.$from.index(y),v=T.$to.indexAfter(y);if(y<T.depth&&k.canReplace(b,v,p))return y;if(0==y||k.type.spec.isolating||!ie(k,b,v))break}return null}function Se(T,d,p=null,y=T){let k=function M(T,d){let{parent:p,startIndex:y,endIndex:k}=T,b=p.contentMatchAt(y).findWrapping(d);return b&&p.canReplaceWith(y,k,b.length?b[0]:d)?b:null}(T,d),b=k&&function P(T,d){let{parent:p,startIndex:y,endIndex:k}=T,b=p.child(y),v=d.contentMatch.findWrapping(b.type);if(!v)return null;let K=(v.length?v[v.length-1]:d).contentMatch;for(let X=y;K&&X<k;X++)K=K.matchType(p.child(X).type);return K&&K.validEnd?v:null}(y,d);return b?k.map(Q).concat({type:d,attrs:p}).concat(b.map(Q)):null}function Q(T){return{type:T,attrs:null}}function Oe(T,d,p=1,y){let k=T.resolve(d),b=k.depth-p,v=y&&y[y.length-1]||k.parent;if(b<0||k.parent.type.spec.isolating||!k.parent.canReplace(k.index(),k.parent.childCount)||!v.type.validContent(k.parent.content.cutByIndex(k.index(),k.parent.childCount)))return!1;for(let X=k.depth-1,re=p-2;X>b;X--,re--){let he=k.node(X),x=k.index(X);if(he.type.spec.isolating)return!1;let i=he.content.cutByIndex(x,he.childCount),s=y&&y[re]||he;if(s!=he&&(i=i.replaceChild(0,s.type.create(s.attrs))),!he.canReplace(x+1,he.childCount)||!s.type.validContent(i))return!1}let W=k.indexAfter(b),K=y&&y[0];return k.node(b).canReplaceWith(W,W,K?K.type:k.node(b+1).type)}function ve(T,d){let p=T.resolve(d),y=p.index();return Te(p.nodeBefore,p.nodeAfter)&&p.parent.canReplace(y,y+1)}function Te(T,d){return!(!T||!d||T.isLeaf||!T.canAppend(d))}function qe(T,d,p=-1){let y=T.resolve(d);for(let k=y.depth;;k--){let b,v,W=y.index(k);if(k==y.depth?(b=y.nodeBefore,v=y.nodeAfter):p>0?(b=y.node(k+1),W++,v=y.node(k).maybeChild(W)):(b=y.node(k).maybeChild(W-1),v=y.node(k+1)),b&&!b.isTextblock&&Te(b,v)&&y.node(k).canReplace(W,W+1))return d;if(0==k)break;d=p<0?y.before(k):y.after(k)}}function nt(T,d,p){let y=T.resolve(d);if(!p.content.size)return d;let k=p.content;for(let b=0;b<p.openStart;b++)k=k.firstChild.content;for(let b=1;b<=(0==p.openStart&&p.size?2:1);b++)for(let v=y.depth;v>=0;v--){let W=v==y.depth?0:y.pos<=(y.start(v+1)+y.end(v+1))/2?-1:1,K=y.index(v)+(W>0?1:0),X=y.node(v),re=!1;if(1==b)re=X.canReplace(K,K,k);else{let he=X.contentMatchAt(K).findWrapping(k.firstChild.type);re=he&&X.canReplaceWith(K,K,he[0])}if(re)return 0==W?y.pos:W<0?y.before(v+1):y.after(v+1)}return null}function dt(T,d,p=d,y=c.p2.empty){if(d==p&&!y.size)return null;let k=T.resolve(d),b=T.resolve(p);return Ge(k,b,y)?new fe(d,p,y):new ut(k,b,y).fit()}function Ge(T,d,p){return!p.openStart&&!p.openEnd&&T.start()==d.start()&&T.parent.canReplace(T.index(),d.index(),p.content)}ae.jsonID("replaceAround",xe);class ut{constructor(d,p,y){this.$from=d,this.$to=p,this.unplaced=y,this.frontier=[],this.placed=c.HY.empty;for(let k=0;k<=d.depth;k++){let b=d.node(k);this.frontier.push({type:b.type,match:b.contentMatchAt(d.indexAfter(k))})}for(let k=d.depth;k>0;k--)this.placed=c.HY.from(d.node(k).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let X=this.findFittable();X?this.placeNodes(X):this.openMore()||this.dropNode()}let d=this.mustMoveInline(),p=this.placed.size-this.depth-this.$from.depth,y=this.$from,k=this.close(d<0?this.$to:y.doc.resolve(d));if(!k)return null;let b=this.placed,v=y.depth,W=k.depth;for(;v&&W&&1==b.childCount;)b=b.firstChild.content,v--,W--;let K=new c.p2(b,v,W);return d>-1?new xe(y.pos,d,this.$to.pos,this.$to.end(),K,p):K.size||y.pos!=this.$to.pos?new fe(y.pos,k.pos,K):null}findFittable(){for(let d=1;d<=2;d++)for(let p=this.unplaced.openStart;p>=0;p--){let y,k=null;p?(k=Ue(this.unplaced.content,p-1).firstChild,y=k.content):y=this.unplaced.content;let b=y.firstChild;for(let v=this.depth;v>=0;v--){let X,{type:W,match:K}=this.frontier[v],re=null;if(1==d&&(b?K.matchType(b.type)||(re=K.fillBefore(c.HY.from(b),!1)):k&&W.compatibleContent(k.type)))return{sliceDepth:p,frontierDepth:v,parent:k,inject:re};if(2==d&&b&&(X=K.findWrapping(b.type)))return{sliceDepth:p,frontierDepth:v,parent:k,wrap:X};if(k&&K.matchType(k.type))break}}}openMore(){let{content:d,openStart:p,openEnd:y}=this.unplaced,k=Ue(d,p);return!(!k.childCount||k.firstChild.isLeaf||(this.unplaced=new c.p2(d,p+1,Math.max(y,k.size+p>=d.size-y?p+1:0)),0))}dropNode(){let{content:d,openStart:p,openEnd:y}=this.unplaced,k=Ue(d,p);if(k.childCount<=1&&p>0){let b=d.size-p<=p+k.size;this.unplaced=new c.p2(Je(d,p-1,1),p-1,b?p-1:y)}else this.unplaced=new c.p2(Je(d,p,1),p,y)}placeNodes({sliceDepth:d,frontierDepth:p,parent:y,inject:k,wrap:b}){for(;this.depth>p;)this.closeFrontierNode();if(b)for(let a=0;a<b.length;a++)this.openFrontierNode(b[a]);let v=this.unplaced,W=y?y.content:v.content,K=v.openStart-d,X=0,re=[],{match:he,type:x}=this.frontier[p];if(k){for(let a=0;a<k.childCount;a++)re.push(k.child(a));he=he.matchFragment(k)}let i=W.size+d-(v.content.size-v.openEnd);for(;X<W.childCount;){let a=W.child(X),f=he.matchType(a.type);if(!f)break;X++,(X>1||0==K||a.content.size)&&(he=f,re.push(ft(a.mark(x.allowedMarks(a.marks)),1==X?K:0,X==W.childCount?i:-1)))}let s=X==W.childCount;s||(i=-1),this.placed=$e(this.placed,p,c.HY.from(re)),this.frontier[p].match=he,s&&i<0&&y&&y.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let a=0,f=W;a<i;a++){let m=f.lastChild;this.frontier.push({type:m.type,match:m.contentMatchAt(m.childCount)}),f=m.content}this.unplaced=s?0==d?c.p2.empty:new c.p2(Je(v.content,d-1,1),d-1,i<0?v.openEnd:d-1):new c.p2(Je(v.content,d,X),v.openStart,v.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let p,d=this.frontier[this.depth];if(!d.type.isTextblock||!Pe(this.$to,this.$to.depth,d.type,d.match,!1)||this.$to.depth==this.depth&&(p=this.findCloseLevel(this.$to))&&p.depth==this.depth)return-1;let{depth:y}=this.$to,k=this.$to.after(y);for(;y>1&&k==this.$to.end(--y);)++k;return k}findCloseLevel(d){e:for(let p=Math.min(this.depth,d.depth);p>=0;p--){let{match:y,type:k}=this.frontier[p],b=p<d.depth&&d.end(p+1)==d.pos+(d.depth-(p+1)),v=Pe(d,p,k,y,b);if(v){for(let W=p-1;W>=0;W--){let{match:K,type:X}=this.frontier[W],re=Pe(d,W,X,K,!0);if(!re||re.childCount)continue e}return{depth:p,fit:v,move:b?d.doc.resolve(d.after(p+1)):d}}}}close(d){let p=this.findCloseLevel(d);if(!p)return null;for(;this.depth>p.depth;)this.closeFrontierNode();p.fit.childCount&&(this.placed=$e(this.placed,p.depth,p.fit)),d=p.move;for(let y=p.depth+1;y<=d.depth;y++){let k=d.node(y),b=k.type.contentMatch.fillBefore(k.content,!0,d.index(y));this.openFrontierNode(k.type,k.attrs,b)}return d}openFrontierNode(d,p=null,y){let k=this.frontier[this.depth];k.match=k.match.matchType(d),this.placed=$e(this.placed,this.depth,c.HY.from(d.create(p,y))),this.frontier.push({type:d,match:d.contentMatch})}closeFrontierNode(){let p=this.frontier.pop().match.fillBefore(c.HY.empty,!0);p.childCount&&(this.placed=$e(this.placed,this.frontier.length,p))}}function Je(T,d,p){return 0==d?T.cutByIndex(p,T.childCount):T.replaceChild(0,T.firstChild.copy(Je(T.firstChild.content,d-1,p)))}function $e(T,d,p){return 0==d?T.append(p):T.replaceChild(T.childCount-1,T.lastChild.copy($e(T.lastChild.content,d-1,p)))}function Ue(T,d){for(let p=0;p<d;p++)T=T.firstChild.content;return T}function ft(T,d,p){if(d<=0)return T;let y=T.content;return d>1&&(y=y.replaceChild(0,ft(y.firstChild,d-1,1==y.childCount?p-1:0))),d>0&&(y=T.type.contentMatch.fillBefore(y).append(y),p<=0&&(y=y.append(T.type.contentMatch.matchFragment(y).fillBefore(c.HY.empty,!0)))),T.copy(y)}function Pe(T,d,p,y,k){let b=T.node(d),v=k?T.indexAfter(d):T.index(d);if(v==b.childCount&&!p.compatibleContent(b.type))return null;let W=y.fillBefore(b.content,!0,v);return W&&!function Mt(T,d,p){for(let y=p;y<d.childCount;y++)if(!T.allowsMarks(d.child(y).marks))return!0;return!1}(p,b.content,v)?W:null}function it(T){return T.spec.defining||T.spec.definingForContent}function Ze(T,d,p,y,k){if(d<p){let b=T.firstChild;T=T.replaceChild(0,b.copy(Ze(b.content,d+1,p,y,b)))}if(d>y){let b=k.contentMatchAt(0),v=b.fillBefore(T).append(T);T=v.append(b.matchFragment(v).fillBefore(c.HY.empty,!0))}return T}function He(T,d){let p=[];for(let k=Math.min(T.depth,d.depth);k>=0;k--){let b=T.start(k);if(b<T.pos-(T.depth-k)||d.end(k)>d.pos+(d.depth-k)||T.node(k).type.spec.isolating||d.node(k).type.spec.isolating)break;(b==d.start(k)||k==T.depth&&k==d.depth&&T.parent.inlineContent&&d.parent.inlineContent&&k&&d.start(k-1)==b-1)&&p.push(k)}return p}let ze=class extends Error{};ze=function T(d){let p=Error.call(this,d);return p.__proto__=T.prototype,p},(ze.prototype=Object.create(Error.prototype)).constructor=ze,ze.prototype.name="TransformError";class Ye{constructor(d){this.doc=d,this.steps=[],this.docs=[],this.mapping=new le}get before(){return this.docs.length?this.docs[0]:this.doc}step(d){let p=this.maybeStep(d);if(p.failed)throw new ze(p.failed);return this}maybeStep(d){let p=d.apply(this.doc);return p.failed||this.addStep(d,p.doc),p}get docChanged(){return this.steps.length>0}addStep(d,p){this.docs.push(this.doc),this.steps.push(d),this.mapping.appendMap(d.getMap()),this.doc=p}replace(d,p=d,y=c.p2.empty){let k=dt(this.doc,d,p,y);return k&&this.step(k),this}replaceWith(d,p,y){return this.replace(d,p,new c.p2(c.HY.from(y),0,0))}delete(d,p){return this.replace(d,p,c.p2.empty)}insert(d,p){return this.replaceWith(d,d,p)}replaceRange(d,p,y){return function Le(T,d,p,y){if(!y.size)return T.deleteRange(d,p);let k=T.doc.resolve(d),b=T.doc.resolve(p);if(Ge(k,b,y))return T.step(new fe(d,p,y));let v=He(k,T.doc.resolve(p));0==v[v.length-1]&&v.pop();let W=-(k.depth+1);v.unshift(W);for(let x=k.depth,i=k.pos-1;x>0;x--,i--){let s=k.node(x).type.spec;if(s.defining||s.definingAsContext||s.isolating)break;v.indexOf(x)>-1?W=x:k.before(x)==i&&v.splice(1,0,-x)}let K=v.indexOf(W),X=[],re=y.openStart;for(let x=y.content,i=0;;i++){let s=x.firstChild;if(X.push(s),i==y.openStart)break;x=s.content}for(let x=re-1;x>=0;x--){let i=X[x].type,s=it(i);if(s&&k.node(K).type!=i)re=x;else if(s||!i.isTextblock)break}for(let x=y.openStart;x>=0;x--){let i=(x+re+1)%(y.openStart+1),s=X[i];if(s)for(let a=0;a<v.length;a++){let f=v[(a+K)%v.length],m=!0;f<0&&(m=!1,f=-f);let O=k.node(f-1),N=k.index(f-1);if(O.canReplaceWith(N,N,s.type,s.marks))return T.replace(k.before(f),m?b.after(f):p,new c.p2(Ze(y.content,0,y.openStart,i),i,y.openEnd))}}let he=T.steps.length;for(let x=v.length-1;x>=0&&(T.replace(d,p,y),!(T.steps.length>he));x--){let i=v[x];i<0||(d=k.before(i),p=b.after(i))}}(this,d,p,y),this}replaceRangeWith(d,p,y){return function pt(T,d,p,y){if(!y.isInline&&d==p&&T.doc.resolve(d).parent.content.size){let k=function ht(T,d,p){let y=T.resolve(d);if(y.parent.canReplaceWith(y.index(),y.index(),p))return d;if(0==y.parentOffset)for(let k=y.depth-1;k>=0;k--){let b=y.index(k);if(y.node(k).canReplaceWith(b,b,p))return y.before(k+1);if(b>0)return null}if(y.parentOffset==y.parent.content.size)for(let k=y.depth-1;k>=0;k--){let b=y.indexAfter(k);if(y.node(k).canReplaceWith(b,b,p))return y.after(k+1);if(b<y.node(k).childCount)return null}return null}(T.doc,d,y.type);null!=k&&(d=p=k)}T.replaceRange(d,p,new c.p2(c.HY.from(y),0,0))}(this,d,p,y),this}deleteRange(d,p){return function mt(T,d,p){let y=T.doc.resolve(d),k=T.doc.resolve(p),b=He(y,k);for(let v=0;v<b.length;v++){let W=b[v],K=v==b.length-1;if(K&&0==W||y.node(W).type.contentMatch.validEnd)return T.delete(y.start(W),k.end(W));if(W>0&&(K||y.node(W-1).canReplace(y.index(W-1),k.indexAfter(W-1))))return T.delete(y.before(W),k.after(W))}for(let v=1;v<=y.depth&&v<=k.depth;v++)if(d-y.start(v)==y.depth-v&&p>y.end(v)&&k.end(v)-p!=k.depth-v)return T.delete(y.before(v),p);T.delete(d,p)}(this,d,p),this}lift(d,p){return function ke(T,d,p){let{$from:y,$to:k,depth:b}=d,v=y.before(b+1),W=k.after(b+1),K=v,X=W,re=c.HY.empty,he=0;for(let s=b,a=!1;s>p;s--)a||y.index(s)>0?(a=!0,re=c.HY.from(y.node(s).copy(re)),he++):K--;let x=c.HY.empty,i=0;for(let s=b,a=!1;s>p;s--)a||k.after(s+1)<k.end(s)?(a=!0,x=c.HY.from(k.node(s).copy(x)),i++):X++;T.step(new xe(K,X,v,W,new c.p2(re.append(x),he,i),re.size-he,!0))}(this,d,p),this}join(d,p=1){return function Ke(T,d,p){let y=new fe(d-p,d+p,c.p2.empty,!0);T.step(y)}(this,d,p),this}wrap(d,p){return function I(T,d,p){let y=c.HY.empty;for(let v=p.length-1;v>=0;v--){if(y.size){let W=p[v].type.contentMatch.matchFragment(y);if(!W||!W.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}y=c.HY.from(p[v].type.create(p[v].attrs,y))}let k=d.start,b=d.end;T.step(new xe(k,b,k,b,new c.p2(y,0,0),p.length,!0))}(this,d,p),this}setBlockType(d,p=d,y,k=null){return function $(T,d,p,y,k){if(!y.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let b=T.steps.length;T.doc.nodesBetween(d,p,(v,W)=>{if(v.isTextblock&&!v.hasMarkup(y,k)&&function te(T,d,p){let y=T.resolve(d),k=y.index();return y.parent.canReplaceWith(k,k+1,p)}(T.doc,T.mapping.slice(b).map(W),y)){T.clearIncompatible(T.mapping.slice(b).map(W,1),y);let K=T.mapping.slice(b),X=K.map(W,1),re=K.map(W+v.nodeSize,1);return T.step(new xe(X,re,X+1,re-1,new c.p2(c.HY.from(y.create(k,null,v.marks)),0,0),1,!0)),!1}})}(this,d,p,y,k),this}setNodeMarkup(d,p,y=null,k=[]){return function me(T,d,p,y,k){let b=T.doc.nodeAt(d);if(!b)throw new RangeError("No node at given position");p||(p=b.type);let v=p.create(y,null,k||b.marks);if(b.isLeaf)return T.replaceWith(d,d+b.nodeSize,v);if(!p.validContent(b.content))throw new RangeError("Invalid content for node type "+p.name);T.step(new xe(d,d+b.nodeSize,d+1,d+b.nodeSize-1,new c.p2(c.HY.from(v),0,0),1,!0))}(this,d,p,y,k),this}split(d,p=1,y){return function be(T,d,p=1,y){let k=T.doc.resolve(d),b=c.HY.empty,v=c.HY.empty;for(let W=k.depth,K=k.depth-p,X=p-1;W>K;W--,X--){b=c.HY.from(k.node(W).copy(b));let re=y&&y[X];v=c.HY.from(re?re.type.create(re.attrs,v):k.node(W).copy(v))}T.step(new fe(d,d,new c.p2(b.append(v),p,p),!0))}(this,d,p,y),this}addMark(d,p,y){return function Ie(T,d,p,y){let v,W,k=[],b=[];T.doc.nodesBetween(d,p,(K,X,re)=>{if(!K.isInline)return;let he=K.marks;if(!y.isInSet(he)&&re.type.allowsMarkType(y.type)){let x=Math.max(X,d),i=Math.min(X+K.nodeSize,p),s=y.addToSet(he);for(let a=0;a<he.length;a++)he[a].isInSet(s)||(v&&v.to==x&&v.mark.eq(he[a])?v.to=i:k.push(v=new Y(x,i,he[a])));W&&W.to==x?W.to=i:b.push(W=new ce(x,i,y))}}),k.forEach(K=>T.step(K)),b.forEach(K=>T.step(K))}(this,d,p,y),this}removeMark(d,p,y){return function Ee(T,d,p,y){let k=[],b=0;T.doc.nodesBetween(d,p,(v,W)=>{if(!v.isInline)return;b++;let K=null;if(y instanceof c.ZU){let re,X=v.marks;for(;re=y.isInSet(X);)(K||(K=[])).push(re),X=re.removeFromSet(X)}else y?y.isInSet(v.marks)&&(K=[y]):K=v.marks;if(K&&K.length){let X=Math.min(W+v.nodeSize,p);for(let re=0;re<K.length;re++){let x,he=K[re];for(let i=0;i<k.length;i++){let s=k[i];s.step==b-1&&he.eq(k[i].style)&&(x=s)}x?(x.to=X,x.step=b):k.push({style:he,from:Math.max(W,d),to:X,step:b})}}}),k.forEach(v=>T.step(new Y(v.from,v.to,v.style)))}(this,d,p,y),this}clearIncompatible(d,p,y){return function ue(T,d,p,y=p.contentMatch){let k=T.doc.nodeAt(d),b=[],v=d+1;for(let W=0;W<k.childCount;W++){let K=k.child(W),X=v+K.nodeSize,re=y.matchType(K.type);if(re){y=re;for(let he=0;he<K.marks.length;he++)p.allowsMarkType(K.marks[he].type)||T.step(new Y(v,X,K.marks[he]))}else b.push(new fe(v,X,c.p2.empty));v=X}if(!y.validEnd){let W=y.fillBefore(c.HY.empty,!0);T.replace(v,v,new c.p2(W,0,0))}for(let W=b.length-1;W>=0;W--)T.step(b[W])}(this,d,p,y),this}}},412:(Me,ne,E)=>{E.d(ne,{EH:()=>Ne,p:()=>Fe,tk:()=>vi});var c=E(6956),R=E(8197),Z=E(3060);const A="undefined"!=typeof navigator?navigator:null,D="undefined"!=typeof document?document:null,z=A&&A.userAgent||"",L=/Edge\/(\d+)/.exec(z),S=/MSIE \d/.exec(z),w=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(z),j=!!(S||w||L),ee=S?document.documentMode:w?+w[1]:L?+L[1]:0,q=!j&&/gecko\/(\d+)/i.test(z);q&&/Firefox\/(\d+)/.exec(z);const le=!j&&/Chrome\/(\d+)/.exec(z),G=!!le,ae=le?+le[1]:0,J=!j&&!!A&&/Apple Computer/.test(A.vendor),se=J&&(/Mobile\/\w+/.test(z)||!!A&&A.maxTouchPoints>2),ce=se||!!A&&/Mac/.test(A.platform),Y=/Android \d/.test(z),fe=!!D&&"webkitFontSmoothing"in D.documentElement.style,xe=fe?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,_e=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Ie=function(t){let e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e};let Ee=null;const ue=function(t,e,n){let r=Ee||(Ee=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},ie=function(t,e,n,r){return n&&(ke(t,e,n,r,-1)||ke(t,e,n,r,1))},pe=/^(img|br|input|textarea|hr)$/i;function ke(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Se(t))){let l=t.parentNode;if(!l||1!=l.nodeType||M(t)||pe.test(t.nodeName)||"false"==t.contentEditable)return!1;e=_e(t)+(o<0?0:1),t=l}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?Se(t):0}}}function Se(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function M(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const P=function(t){let e=t.isCollapsed;return e&&G&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function I(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function $(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function te(t,e){return"number"==typeof t?t:t[e]}function me(t){let e=t.getBoundingClientRect();return{left:e.left,right:e.left+t.clientWidth*(e.width/t.offsetWidth||1),top:e.top,bottom:e.top+t.clientHeight*(e.height/t.offsetHeight||1)}}function Oe(t,e,n){let r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,l=t.dom.ownerDocument;for(let h=n||t.dom;h;h=Ie(h)){if(1!=h.nodeType)continue;let u=h,g=u==l.body,C=g?$(l):me(u),_=0,V=0;if(e.top<C.top+te(r,"top")?V=-(C.top-e.top+te(o,"top")):e.bottom>C.bottom-te(r,"bottom")&&(V=e.bottom-C.bottom+te(o,"bottom")),e.left<C.left+te(r,"left")?_=-(C.left-e.left+te(o,"left")):e.right>C.right-te(r,"right")&&(_=e.right-C.right+te(o,"right")),_||V)if(g)l.defaultView.scrollBy(_,V);else{let U=u.scrollLeft,F=u.scrollTop;V&&(u.scrollTop+=V),_&&(u.scrollLeft+=_);let H=u.scrollLeft-U,ge=u.scrollTop-F;e={left:e.left-H,top:e.top-ge,right:e.right-H,bottom:e.bottom-ge}}if(g)break}}function ve(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Ie(r));return e}function qe(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:o,left:l}=t[n];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=l&&(r.scrollLeft=l)}}let Ke=null;function nt(t,e){let n,o,r=2e8,l=0,h=e.top,u=e.top;for(let g=t.firstChild,C=0;g;g=g.nextSibling,C++){let _;if(1==g.nodeType)_=g.getClientRects();else{if(3!=g.nodeType)continue;_=ue(g).getClientRects()}for(let V=0;V<_.length;V++){let U=_[V];if(U.top<=h&&U.bottom>=u){h=Math.max(U.bottom,h),u=Math.min(U.top,u);let F=U.left>e.left?U.left-e.left:U.right<e.left?e.left-U.right:0;if(F<r){n=g,r=F,o=F&&3==n.nodeType?{left:U.right<e.left?U.right:U.left,top:e.top}:e,1==g.nodeType&&F&&(l=C+(e.left>=(U.left+U.right)/2?1:0));continue}}!n&&(e.left>=U.right&&e.top>=U.top||e.left>=U.left&&e.top>=U.bottom)&&(l=C+1)}}return n&&3==n.nodeType?function dt(t,e){let n=t.nodeValue.length,r=document.createRange();for(let o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);let l=Pe(r,1);if(l.top!=l.bottom&&Ge(e,l))return{node:t,offset:o+(e.left>=(l.left+l.right)/2?1:0)}}return{node:t,offset:0}}(n,o):!n||r&&1==n.nodeType?{node:t,offset:l}:nt(n,o)}function Ge(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function Ue(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),l=o;;){let h=t.childNodes[l];if(1==h.nodeType){let u=h.getClientRects();for(let g=0;g<u.length;g++){let C=u[g];if(Ge(e,C))return Ue(h,e,C)}}if((l=(l+1)%r)==o)break}return t}function ft(t,e){let r,n=t.dom.ownerDocument,o=0;if(n.caretPositionFromPoint)try{let g=n.caretPositionFromPoint(e.left,e.top);g&&({offsetNode:r,offset:o}=g)}catch(g){}if(!r&&n.caretRangeFromPoint){let g=n.caretRangeFromPoint(e.left,e.top);g&&({startContainer:r,startOffset:o}=g)}let h,l=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top);if(!l||!t.dom.contains(1!=l.nodeType?l.parentNode:l)){let g=t.dom.getBoundingClientRect();if(!Ge(e,g)||(l=Ue(t.dom,e,g),!l))return null}if(J)for(let g=l;r&&g;g=Ie(g))g.draggable&&(r=void 0);if(l=function ut(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(l,e),r){if(q&&1==r.nodeType&&(o=Math.min(o,r.childNodes.length),o<r.childNodes.length)){let C,g=r.childNodes[o];"IMG"==g.nodeName&&(C=g.getBoundingClientRect()).right<=e.left&&C.bottom>e.top&&o++}r==t.dom&&o==r.childNodes.length-1&&1==r.lastChild.nodeType&&e.top>r.lastChild.getBoundingClientRect().bottom?h=t.state.doc.content.size:(0==o||1!=r.nodeType||"BR"!=r.childNodes[o-1].nodeName)&&(h=function $e(t,e,n,r){let o=-1;for(let l=e;l!=t.dom;){let h=t.docView.nearestDesc(l,!0);if(!h)return null;if(h.node.isBlock&&h.parent){let u=h.dom.getBoundingClientRect();if(u.left>r.left||u.top>r.top)o=h.posBefore;else{if(!(u.right<r.left||u.bottom<r.top))break;o=h.posAfter}}l=h.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n,1)}(t,r,o,e))}null==h&&(h=function Je(t,e,n){let{node:r,offset:o}=nt(e,n),l=-1;if(1==r.nodeType&&!r.firstChild){let h=r.getBoundingClientRect();l=h.left!=h.right&&n.left>(h.left+h.right)/2?1:-1}return t.docView.posFromDOM(r,o,l)}(t,l,e));let u=t.docView.nearestDesc(l,!0);return{pos:h,inside:u?u.posAtStart-u.border:-1}}function Pe(t,e){let n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}const Mt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function it(t,e,n){let{node:r,offset:o,atom:l}=t.docView.domFromPos(e,n<0?-1:1),h=fe||q;if(3==r.nodeType){if(!h||!Mt.test(r.nodeValue)&&(n<0?o:o!=r.nodeValue.length)){let g=o,C=o,_=n<0?1:-1;return n<0&&!o?(C++,_=-1):n>=0&&o==r.nodeValue.length?(g--,_=1):n<0?g--:C++,Le(Pe(ue(r,g,C),_),_<0)}{let g=Pe(ue(r,o,o),n);if(q&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let C=Pe(ue(r,o-1,o-1),-1);if(C.top==g.top){let _=Pe(ue(r,o,o+1),-1);if(_.top!=g.top)return Le(_,_.left<C.left)}}return g}}if(!t.state.doc.resolve(e-(l||0)).parent.inlineContent){if(null==l&&o&&(n<0||o==Se(r))){let g=r.childNodes[o-1];if(1==g.nodeType)return Ze(g.getBoundingClientRect(),!1)}if(null==l&&o<Se(r)){let g=r.childNodes[o];if(1==g.nodeType)return Ze(g.getBoundingClientRect(),!0)}return Ze(r.getBoundingClientRect(),n>=0)}if(null==l&&o&&(n<0||o==Se(r))){let g=r.childNodes[o-1],C=3==g.nodeType?ue(g,Se(g)-(h?0:1)):1!=g.nodeType||"BR"==g.nodeName&&g.nextSibling?null:g;if(C)return Le(Pe(C,1),!1)}if(null==l&&o<Se(r)){let g=r.childNodes[o];for(;g.pmViewDesc&&g.pmViewDesc.ignoreForCoords;)g=g.nextSibling;let C=g?3==g.nodeType?ue(g,0,h?0:1):1==g.nodeType?g:null:null;if(C)return Le(Pe(C,-1),!0)}return Le(Pe(3==r.nodeType?ue(r):r,-n),n>=0)}function Le(t,e){if(0==t.width)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Ze(t,e){if(0==t.height)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function pt(t,e,n){let r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}const He=/[\u0590-\u08ac]/;let Ye=null,T=null,d=!1;class W{constructor(e,n,r,o){this.parent=e,this.children=n,this.dom=r,this.contentDOM=o,this.dirty=0,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let o=this.children[n];if(o==e)return r;r+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(r<0){let l,h;if(e==this.contentDOM)l=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;l=e.previousSibling}for(;l&&(!(h=l.pmViewDesc)||h.parent!=this);)l=l.previousSibling;return l?this.posBeforeChild(h)+h.size:this.posAtStart}{let l,h;if(e==this.contentDOM)l=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;l=e.nextSibling}for(;l&&(!(h=l.pmViewDesc)||h.parent!=this);)l=l.nextSibling;return l?this.posBeforeChild(h):this.posAtEnd}}let o;if(e==this.dom&&this.contentDOM)o=n>_e(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(let l=e;;l=l.parentNode){if(l==this.dom){o=!1;break}if(l.previousSibling)break}if(null==o&&n==e.childNodes.length)for(let l=e;;l=l.parentNode){if(l==this.dom){o=!0;break}if(l.nextSibling)break}}return(null==o?r>0:o)?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,o=e;o;o=o.parentNode){let h,l=this.getDesc(o);if(l&&(!n||l.node)){if(!r||!(h=l.nodeDOM)||(1==h.nodeType?h.contains(1==e.nodeType?e:e.parentNode):h==e))return l;r=!1}}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let o=e;o;o=o.parentNode){let l=this.getDesc(o);if(l)return l.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],l=r+o.size;if(r==e&&l!=r){for(;!o.border&&o.children.length;)o=o.children[0];return o}if(e<l)return o.descAt(e-r-o.border);r=l}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let l,r=0,o=0;for(let l=0;r<this.children.length;r++){let h=this.children[r],u=l+h.size;if(u>e||h instanceof s){o=e-l;break}l=u}if(o)return this.children[r].domFromPos(o-this.children[r].border,n);for(;r&&!(l=this.children[r-1]).size&&l instanceof K&&l.side>=0;r--);if(n<=0){let l,h=!0;for(;l=r?this.children[r-1]:null,l&&l.dom.parentNode!=this.contentDOM;r--,h=!1);return l&&n&&h&&!l.border&&!l.domAtom?l.domFromPos(l.size,n):{node:this.contentDOM,offset:l?_e(l.dom)+1:0}}{let l,h=!0;for(;l=r<this.children.length?this.children[r]:null,l&&l.dom.parentNode!=this.contentDOM;r++,h=!1);return l&&h&&!l.border&&!l.domAtom?l.domFromPos(0,n):{node:this.contentDOM,offset:l?_e(l.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,l=-1;for(let h=r,u=0;;u++){let g=this.children[u],C=h+g.size;if(-1==o&&e<=C){let _=h+g.border;if(e>=_&&n<=C-g.border&&g.node&&g.contentDOM&&this.contentDOM.contains(g.contentDOM))return g.parseRange(e,n,_);e=h;for(let V=u;V>0;V--){let U=this.children[V-1];if(U.size&&U.dom.parentNode==this.contentDOM&&!U.emptyChildAt(1)){o=_e(U.dom)+1;break}e-=U.size}-1==o&&(o=0)}if(o>-1&&(C>n||u==this.children.length-1)){n=C;for(let _=u+1;_<this.children.length;_++){let V=this.children[_];if(V.size&&V.dom.parentNode==this.contentDOM&&!V.emptyChildAt(-1)){l=_e(V.dom);break}n+=V.size}-1==l&&(l=this.contentDOM.childNodes.length);break}h=C}return{node:this.contentDOM,from:e,to:n,fromOffset:o,toOffset:l}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,o=!1){let l=Math.min(e,n),h=Math.max(e,n);for(let U=0,F=0;U<this.children.length;U++){let H=this.children[U],ge=F+H.size;if(l>F&&h<ge)return H.setSelection(e-F-H.border,n-F-H.border,r,o);F=ge}let u=this.domFromPos(e,e?-1:1),g=n==e?u:this.domFromPos(n,n?-1:1),C=r.getSelection(),_=!1;if((q||J)&&e==n){let{node:U,offset:F}=u;if(3==U.nodeType){if(_=!(!F||"\n"!=U.nodeValue[F-1]),_&&F==U.nodeValue.length)for(let ge,H=U;H;H=H.parentNode){if(ge=H.nextSibling){"BR"==ge.nodeName&&(u=g={node:ge.parentNode,offset:_e(ge)+1});break}let Ce=H.pmViewDesc;if(Ce&&Ce.node&&Ce.node.isBlock)break}}else{let H=U.childNodes[F-1];_=H&&("BR"==H.nodeName||"false"==H.contentEditable)}}if(q&&C.focusNode&&C.focusNode!=g.node&&1==C.focusNode.nodeType){let U=C.focusNode.childNodes[C.focusOffset];U&&"false"==U.contentEditable&&(o=!0)}if(!(o||_&&J)&&ie(u.node,u.offset,C.anchorNode,C.anchorOffset)&&ie(g.node,g.offset,C.focusNode,C.focusOffset))return;let V=!1;if((C.extend||e==n)&&!_){C.collapse(u.node,u.offset);try{e!=n&&C.extend(g.node,g.offset),V=!0}catch(U){if(!(U instanceof DOMException))throw U}}if(!V){if(e>n){let F=u;u=g,g=F}let U=document.createRange();U.setEnd(g.node,g.offset),U.setStart(u.node,u.offset),C.removeAllRanges(),C.addRange(U)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,o=0;o<this.children.length;o++){let l=this.children[o],h=r+l.size;if(r==h?e<=h&&n>=r:e<h&&n>r){let u=r+l.border,g=h-l.border;if(e>=u&&n<=g)return this.dirty=e==r||n==h?2:1,void(e!=u||n!=g||!l.contentLost&&l.dom.parentNode==this.contentDOM?l.markDirty(e-u,n-u):l.dirty=3);l.dirty=l.dom!=l.contentDOM||l.dom.parentNode!=this.contentDOM||l.children.length?3:2}r=h}this.dirty=2}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=1==e?2:1;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class K extends W{constructor(e,n,r,o){let l,h=n.type.toDOM;if("function"==typeof h&&(h=h(r,()=>l?l.parent?l.parent.posBeforeChild(l):void 0:o)),!n.type.spec.raw){if(1!=h.nodeType){let u=document.createElement("span");u.appendChild(h),h=u}h.contentEditable="false",h.classList.add("ProseMirror-widget")}super(e,[],h,null),this.widget=n,this.widget=n,l=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return!!n&&n(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class X extends W{constructor(e,n,r,o){super(e,[],n,null),this.textDOM=r,this.text=o}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class re extends W{constructor(e,n,r,o){super(e,[],r,o),this.mark=n}static create(e,n,r,o){let l=o.nodeViews[n.type.name],h=l&&l(n,o,r);return(!h||!h.dom)&&(h=R.PW.renderSpec(document,n.type.spec.toDOM(n,r))),new re(e,n,h.dom,h.contentDOM||h.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),0!=this.dirty){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}}slice(e,n,r){let o=re.create(this.parent,this.mark,!0,r),l=this.children,h=this.size;n<h&&(l=Dt(l,n,h,r)),e>0&&(l=Dt(l,0,e,r));for(let u=0;u<l.length;u++)l[u].parent=o;return o.children=l,o}}class he extends W{constructor(e,n,r,o,l,h,u,g,C){super(e,[],l,h),this.node=n,this.outerDeco=r,this.innerDeco=o,this.nodeDOM=u,h&&this.updateChildren(g,C)}static create(e,n,r,o,l,h){let g,u=l.nodeViews[n.type.name],C=u&&u(n,l,()=>g?g.parent?g.parent.posBeforeChild(g):void 0:h,r,o),_=C&&C.dom,V=C&&C.contentDOM;if(n.isText)if(_){if(3!=_.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else _=document.createTextNode(n.text);else _||({dom:_,contentDOM:V}=R.PW.renderSpec(document,n.type.spec.toDOM(n)));!V&&!n.isText&&"BR"!=_.nodeName&&(_.hasAttribute("contenteditable")||(_.contentEditable="false"),n.type.spec.draggable&&(_.draggable=!0));let U=_;return _=de(_,r,n),C?g=new a(e,n,r,o,_,V||null,U,C,l,h+1):n.isText?new i(e,n,r,o,_,U,l):new he(e,n,r,o,_,V||null,U,l,h+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>R.HY.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,n,r){return 0==this.dirty&&e.eq(this.node)&&Re(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,o=n,l=e.composing?this.localCompositionInfo(e,n):null,h=l&&l.pos>-1?l:null,u=l&&l.pos<0,g=new Ct(this,h&&h.node);(function Bn(t,e,n,r){let o=e.locals(t),l=0;if(0==o.length){for(let C=0;C<t.childCount;C++){let _=t.child(C);r(_,o,e.forChild(l,_),C),l+=_.nodeSize}return}let h=0,u=[],g=null;for(let C=0;;){if(h<o.length&&o[h].to==l){let ge,H=o[h++];for(;h<o.length&&o[h].to==l;)(ge||(ge=[H])).push(o[h++]);if(ge){ge.sort(Rn);for(let Ce=0;Ce<ge.length;Ce++)n(ge[Ce],C,!!g)}else n(H,C,!!g)}let _,V;if(g)V=-1,_=g,g=null;else{if(!(C<t.childCount))break;V=C,_=t.child(C++)}for(let H=0;H<u.length;H++)u[H].to<=l&&u.splice(H--,1);for(;h<o.length&&o[h].from<=l&&o[h].to>l;)u.push(o[h++]);let U=l+_.nodeSize;if(_.isText){let H=U;h<o.length&&o[h].from<H&&(H=o[h].from);for(let ge=0;ge<u.length;ge++)u[ge].to<H&&(H=u[ge].to);H<U&&(g=_.cut(H-l),_=_.cut(0,H-l),U=H,V=-1)}r(_,_.isInline&&!_.isLeaf?u.filter(H=>!H.inline):u.slice(),e.forChild(l,_),V),l=U}})(this.node,this.innerDeco,(C,_,V)=>{C.spec.marks?g.syncToMarks(C.spec.marks,r,e):C.type.side>=0&&!V&&g.syncToMarks(_==this.node.childCount?R.vc.none:this.node.child(_).marks,r,e),g.placeWidget(C,e,o)},(C,_,V,U)=>{let F;g.syncToMarks(C.marks,r,e),g.findNodeMatch(C,_,V,U)||u&&e.state.selection.from>o&&e.state.selection.to<o+C.nodeSize&&(F=g.findIndexWithChild(l.node))>-1&&g.updateNodeAt(C,_,V,F,e)||g.updateNextNode(C,_,V,e,U)||g.addNode(C,_,V,e,o),o+=C.nodeSize}),g.syncToMarks([],r,e),this.node.isTextblock&&g.addTextblockHacks(),g.destroyRest(),(g.changed||2==this.dirty)&&(h&&this.protectLocalComposition(e,h),f(this.contentDOM,this.children,e),se&&function zn(t){if("UL"==t.nodeName||"OL"==t.nodeName){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t),t.style.cssText=e}}(this.dom))}localCompositionInfo(e,n){let{from:r,to:o}=e.state.selection;if(!(e.state.selection instanceof c.Bs)||r<n||o>n+this.node.content.size)return null;let l=e.domSelection(),h=function Ln(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=Se(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(l.focusNode,l.focusOffset);if(!h||!this.dom.contains(h.parentNode))return null;if(this.node.inlineContent){let u=h.nodeValue,g=function Fn(t,e,n,r){for(let o=0,l=0;o<t.childCount&&l<=r;){let h=t.child(o++),u=l;if(l+=h.nodeSize,!h.isText)continue;let g=h.text;for(;o<t.childCount;){let C=t.child(o++);if(l+=C.nodeSize,!C.isText)break;g+=C.text}if(l>=n){let C=u<r?g.lastIndexOf(e,r-u-1):-1;if(C>=0&&C+e.length+u>=n)return u+C;if(n==r&&g.length>=r+e.length-u&&g.slice(r-u,r-u+e.length)==e)return r}}return-1}(this.node.content,u,r-n,o-n);return g<0?null:{node:h,pos:g,text:u}}return{node:h,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:o}){if(this.getDesc(n))return;let l=n;for(;l.parentNode!=this.contentDOM;l=l.parentNode){for(;l.previousSibling;)l.parentNode.removeChild(l.previousSibling);for(;l.nextSibling;)l.parentNode.removeChild(l.nextSibling);l.pmViewDesc&&(l.pmViewDesc=void 0)}let h=new X(this,l,n,o);e.input.compositionNodes.push(h),this.children=Dt(this.children,r,r+o.length,e,h)}update(e,n,r,o){return!(3==this.dirty||!e.sameMarkup(this.node)||(this.updateInner(e,n,r,o),0))}updateInner(e,n,r,o){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(Re(e,this.outerDeco))return;let n=1!=this.nodeDOM.nodeType,r=this.dom;this.dom=B(this.dom,this.nodeDOM,N(this.outerDeco,this.node,n),N(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function x(t,e,n,r,o){return de(r,e,t),new he(void 0,t,e,n,r,r,r,o,0)}class i extends he{constructor(e,n,r,o,l,h,u){super(e,n,r,o,l,null,h,u,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,o){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node)||(this.updateOuterDeco(n),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=0,0))}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,n,r){let o=this.node.cut(e,n),l=document.createTextNode(o.text);return new i(this.parent,o,this.outerDeco,this.innerDeco,l,l,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(0==e||n==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class s extends W{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class a extends he{constructor(e,n,r,o,l,h,u,g,C,_){super(e,n,r,o,l,h,u,C,_),this.spec=g}update(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){let l=this.spec.update(e,n,r);return l&&this.updateInner(e,n,r,o),l}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,n,r,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):super.setSelection(e,n,r,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function f(t,e,n){let r=t.firstChild,o=!1;for(let l=0;l<e.length;l++){let h=e[l],u=h.dom;if(u.parentNode==t){for(;u!=r;)r=rt(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(u,r);if(h instanceof re){let g=r?r.previousSibling:t.lastChild;f(h.contentDOM,h.children,n),r=g?g.nextSibling:t.firstChild}}for(;r;)r=rt(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}const m=function(t){t&&(this.nodeName=t)};m.prototype=Object.create(null);const O=[new m];function N(t,e,n){if(0==t.length)return O;let r=n?O[0]:new m,o=[r];for(let l=0;l<t.length;l++){let h=t[l].type.attrs;if(h){h.nodeName&&o.push(r=new m(h.nodeName));for(let u in h){let g=h[u];null!=g&&(n&&1==o.length&&o.push(r=new m(e.isInline?"span":"div")),"class"==u?r.class=(r.class?r.class+" ":"")+g:"style"==u?r.style=(r.style?r.style+";":"")+g:"nodeName"!=u&&(r[u]=g))}}}return o}function B(t,e,n,r){if(n==O&&r==O)return e;let o=e;for(let l=0;l<r.length;l++){let h=r[l],u=n[l];if(l){let g;u&&u.nodeName==h.nodeName&&o!=t&&(g=o.parentNode)&&g.nodeName.toLowerCase()==h.nodeName||(g=document.createElement(h.nodeName),g.pmIsDeco=!0,g.appendChild(o),u=O[0]),o=g}oe(o,u||O[0],h)}return o}function oe(t,e,n){for(let r in e)"class"!=r&&"style"!=r&&"nodeName"!=r&&!(r in n)&&t.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let l=0;l<r.length;l++)-1==o.indexOf(r[l])&&t.classList.remove(r[l]);for(let l=0;l<o.length;l++)-1==r.indexOf(o[l])&&t.classList.add(o[l]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let o,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;o=r.exec(e.style);)t.style.removeProperty(o[1])}n.style&&(t.style.cssText+=n.style)}}function de(t,e,n){return B(t,t,O,N(e,n,1!=t.nodeType))}function Re(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function rt(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Ct{constructor(e,n){this.lock=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function An(t,e){let n=e,r=n.children.length,o=t.childCount,l=new Map,h=[];e:for(;o>0;){let u;for(;;)if(r){let C=n.children[r-1];if(!(C instanceof re)){u=C,r--;break}n=C,r=C.children.length}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let g=u.node;if(g){if(g!=t.child(o-1))break;--o,l.set(u,o),h.push(u)}}return{index:o,matched:l,matches:h.reverse()}}(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let o=0,l=this.stack.length>>1,h=Math.min(l,e.length);for(;o<h&&(o==l-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&!1!==e[o].type.spec.spanning;)o++;for(;o<l;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),l--;for(;l<e.length;){this.stack.push(this.top,this.index+1);let u=-1;for(let g=this.index;g<Math.min(this.index+3,this.top.children.length);g++)if(this.top.children[g].matchesMark(e[l])){u=g;break}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let g=re.create(this.top,e[l],n,r);this.top.children.splice(this.index,0,g),this.top=g,this.changed=!0}this.index=0,l++}}findNodeMatch(e,n,r,o){let h,l=-1;if(o>=this.preMatch.index&&(h=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&h.matchesNode(e,n,r))l=this.top.children.indexOf(h,this.index);else for(let u=this.index,g=Math.min(this.top.children.length,u+5);u<g;u++){let C=this.top.children[u];if(C.matchesNode(e,n,r)&&!this.preMatch.matched.has(C)){l=u;break}}return!(l<0||(this.destroyBetween(this.index,l),this.index++,0))}updateNodeAt(e,n,r,o,l){let h=this.top.children[o];return 3==h.dirty&&h.dom==h.contentDOM&&(h.dirty=2),!!h.update(e,n,r,l)&&(this.destroyBetween(this.index,o),this.index++,!0)}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r)for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o;return-1}e=n}}updateNextNode(e,n,r,o,l){for(let h=this.index;h<this.top.children.length;h++){let u=this.top.children[h];if(u instanceof he){let g=this.preMatch.matched.get(u);if(null!=g&&g!=l)return!1;let C=u.dom;if((!this.lock||!(C==this.lock||1==C.nodeType&&C.contains(this.lock.parentNode))||e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&3!=u.dirty&&Re(n,u.outerDeco))&&u.update(e,n,r,o))return this.destroyBetween(this.index,h),u.dom!=C&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(e,n,r,o,l){this.top.children.splice(this.index++,0,he.create(this.top,e,n,r,o,l)),this.changed=!0}placeWidget(e,n,r){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(!o||!o.matchesWidget(e)||e!=o.widget&&o.widget.type.toDOM.parentNode){let l=new K(this.top,e,n,r);this.top.children.splice(this.index++,0,l),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof re;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof i)||/\n$/.test(e.node.text))&&((J||G)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);"IMG"==e&&(r.className="ProseMirror-separator",r.alt=""),"BR"==e&&(r.className="ProseMirror-trailingBreak");let o=new s(this.top,[],r,null);n!=this.top?n.children.push(o):n.children.splice(this.index++,0,o),this.changed=!0}}}function Rn(t,e){return t.type.side-e.type.side}function Dt(t,e,n,r,o){let l=[];for(let h=0,u=0;h<t.length;h++){let g=t[h],C=u,_=u+=g.size;C>=n||_<=e?l.push(g):(C<e&&l.push(g.slice(0,e-C,r)),o&&(l.push(o),o=void 0),_>n&&l.push(g.slice(n-C,g.size,r)))}return l}function Zt(t,e=null){let n=t.domSelection(),r=t.state.doc;if(!n.focusNode)return null;let o=t.docView.nearestDesc(n.focusNode),l=o&&0==o.size,h=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(h<0)return null;let g,C,u=r.resolve(h);if(P(n)){for(g=u;o&&!o.node;)o=o.parent;let _=o.node;if(o&&_.isAtom&&c.qv.isSelectable(_)&&o.parent&&(!_.isInline||!function Q(t,e,n){for(let r=0==e,o=e==Se(t);r||o;){if(t==n)return!0;let l=_e(t);if(!(t=t.parentNode))return!1;r=r&&0==l,o=o&&l==Se(t)}}(n.focusNode,n.focusOffset,o.dom))){let V=o.posBefore;C=new c.qv(h==V?u:r.resolve(V))}}else{let _=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(_<0)return null;g=r.resolve(_)}return C||(C=Pt(t,g,u,"pointer"==e||t.state.selection.head<u.pos&&!l?1:-1)),C}function Ht(t){return t.editable?t.hasFocus():nn(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function je(t,e=!1){let n=t.state.selection;if(Xt(t,n),Ht(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&G){let r=t.domSelection(),o=t.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&ie(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function Un(t){let e=t.domSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,_e(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&j&&ee<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{let l,h,{anchor:r,head:o}=n;Gt&&!(n instanceof c.Bs)&&(n.$from.parent.inlineContent||(l=jt(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(h=jt(t,n.to))),t.docView.setSelection(r,o,t.root,e),Gt&&(l&&Qt(l),h&&Qt(h)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function Wn(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=o)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Ht(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Gt=J||G&&ae<63;function jt(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),o=r<n.childNodes.length?n.childNodes[r]:null,l=r?n.childNodes[r-1]:null;if(J&&o&&"false"==o.contentEditable)return vt(o);if(!(o&&"false"!=o.contentEditable||l&&"false"!=l.contentEditable)){if(o)return vt(o);if(l)return vt(l)}}function vt(t){return t.contentEditable="true",J&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Qt(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Xt(t,e){if(e instanceof c.qv){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(en(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else en(t)}function en(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Pt(t,e,n,r){return t.someProp("createSelectionBetween",o=>o(t,e,n))||c.Bs.between(e,n,r)}function tn(t){return(!t.editable||t.root.activeElement==t.dom)&&nn(t)}function nn(t){let e=t.domSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function Nt(t,e){let{$anchor:n,$head:r}=t.selection,o=e>0?n.max(r):n.min(r),l=o.parent.inlineContent?o.depth?t.doc.resolve(e>0?o.after():o.before()):null:o;return l&&c.Y1.findFrom(l,e)}function st(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function rn(t,e,n){let r=t.state.selection;if(!(r instanceof c.Bs)){if(r instanceof c.qv&&r.node.isInline)return st(t,new c.Bs(e>0?r.$to:r.$from));{let o=Nt(t.state,e);return!!o&&st(t,o)}}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){let o=Nt(t.state,e);return!!(o&&o instanceof c.qv)&&st(t,o)}if(!(ce&&n.indexOf("m")>-1)){let h,o=r.$head,l=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!l||l.isText)return!1;let u=e<0?o.pos-l.nodeSize:o.pos;return!!(l.isAtom||(h=t.docView.descAt(u))&&!h.contentDOM)&&(c.qv.isSelectable(l)?st(t,new c.qv(e<0?t.state.doc.resolve(o.pos-l.nodeSize):o)):!!fe&&st(t,new c.Bs(t.state.doc.resolve(e<0?u:u+l.nodeSize))))}}function _t(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function kt(t){let e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function wt(t){let e=t.domSelection(),n=e.focusNode,r=e.focusOffset;if(!n)return;let o,l,h=!1;for(q&&1==n.nodeType&&r<_t(n)&&kt(n.childNodes[r])&&(h=!0);;)if(r>0){if(1!=n.nodeType)break;{let u=n.childNodes[r-1];if(kt(u))o=n,l=--r;else{if(3!=u.nodeType)break;n=u,r=n.nodeValue.length}}}else{if(sn(n))break;{let u=n.previousSibling;for(;u&&kt(u);)o=n.parentNode,l=_e(u),u=u.previousSibling;if(u)n=u,r=_t(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}h?At(t,e,n,r):o&&At(t,e,o,l)}function It(t){let e=t.domSelection(),n=e.focusNode,r=e.focusOffset;if(!n)return;let l,h,o=_t(n);for(;;)if(r<o){if(1!=n.nodeType)break;if(!kt(n.childNodes[r]))break;l=n,h=++r}else{if(sn(n))break;{let u=n.nextSibling;for(;u&&kt(u);)l=u.parentNode,h=_e(u)+1,u=u.nextSibling;if(u)n=u,r=0,o=_t(n);else{if(n=n.parentNode,n==t.dom)break;r=o=0}}}l&&At(t,e,l,h)}function sn(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function At(t,e,n,r){if(P(e)){let l=document.createRange();l.setEnd(n,r),l.setStart(n,r),e.removeAllRanges(),e.addRange(l)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection();let{state:o}=t;setTimeout(()=>{t.state==o&&je(t)},50)}function on(t,e,n){let r=t.state.selection;if(r instanceof c.Bs&&!r.empty||n.indexOf("s")>-1||ce&&n.indexOf("m")>-1)return!1;let{$from:o,$to:l}=r;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let h=Nt(t.state,e);if(h&&h instanceof c.qv)return st(t,h)}if(!o.parent.inlineContent){let h=e<0?o:l,u=r instanceof c.C1?c.Y1.near(h,e):c.Y1.findFrom(h,e);return!!u&&st(t,u)}return!1}function ln(t,e){if(!(t.state.selection instanceof c.Bs))return!0;let{$head:n,$anchor:r,empty:o}=t.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let l=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(l&&!l.isText){let h=t.state.tr;return e<0?h.delete(n.pos-l.nodeSize,n.pos):h.delete(n.pos,n.pos+l.nodeSize),t.dispatch(h),!0}return!1}function an(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function cn(t,e){let n=[],{content:r,openStart:o,openEnd:l}=e;for(;o>1&&l>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,l--;let F=r.firstChild;n.push(F.type.name,F.attrs!=F.type.defaultAttrs?F.attrs:null),r=F.content}let h=t.someProp("clipboardSerializer")||R.PW.fromSchema(t.state.schema),u=yn(),g=u.createElement("div");g.appendChild(h.serializeFragment(r,{document:u}));let _,C=g.firstChild,V=0;for(;C&&1==C.nodeType&&(_=mn[C.nodeName.toLowerCase()]);){for(let F=_.length-1;F>=0;F--){let H=u.createElement(_[F]);for(;g.firstChild;)H.appendChild(g.firstChild);g.appendChild(H),V++}C=g.firstChild}return C&&1==C.nodeType&&C.setAttribute("data-pm-slice",`${o} ${l}${V?` -${V}`:""} ${JSON.stringify(n)}`),{dom:g,text:t.someProp("clipboardTextSerializer",F=>F(e))||e.content.textBetween(0,e.content.size,"\n\n")}}function hn(t,e,n,r,o){let h,u,l=o.parent.type.spec.code;if(!n&&!e)return null;let g=e&&(r||l||!n);if(g){if(t.someProp("transformPastedText",U=>{e=U(e,l||r)}),l)return e?new R.p2(R.HY.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):R.p2.empty;let V=t.someProp("clipboardTextParser",U=>U(e,o,r));if(V)u=V;else{let U=o.marks(),{schema:F}=t.state,H=R.PW.fromSchema(F);h=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(ge=>{let Ce=h.appendChild(document.createElement("p"));ge&&Ce.appendChild(H.serializeNode(F.text(ge,U)))})}}else t.someProp("transformPastedHTML",V=>{n=V(n)}),h=function Zn(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let o,n=yn().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t);if((o=r&&mn[r[1].toLowerCase()])&&(t=o.map(l=>"<"+l+">").join("")+t+o.map(l=>"</"+l+">").reverse().join("")),n.innerHTML=t,o)for(let l=0;l<o.length;l++)n=n.querySelector(o[l])||n;return n}(n),fe&&function Hn(t){let e=t.querySelectorAll(G?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}(h);let C=h&&h.querySelector("[data-pm-slice]"),_=C&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(C.getAttribute("data-pm-slice")||"");if(_&&_[3])for(let V=+_[3];V>0&&h.firstChild;V--)h=h.firstChild;if(u||(u=(t.someProp("clipboardParser")||t.someProp("domParser")||R.aw.fromSchema(t.state.schema)).parseSlice(h,{preserveWhitespace:!(!g&&!_),context:o,ruleFromNode:U=>"BR"!=U.nodeName||U.nextSibling||!U.parentNode||$n.test(U.parentNode.nodeName)?null:{ignore:!0}})),_)u=function Gn(t,e){if(!t.size)return t;let r,n=t.content.firstChild.type.schema;try{r=JSON.parse(e)}catch(u){return t}let{content:o,openStart:l,openEnd:h}=t;for(let u=r.length-2;u>=0;u-=2){let g=n.nodes[r[u]];if(!g||g.hasRequiredAttrs())break;o=R.HY.from(g.create(r[u+1],o)),l++,h++}return new R.p2(o,l,h)}(pn(u,+_[1],+_[2]),_[4]);else if(u=R.p2.maxOpen(function Yn(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let l,o=e.node(n).contentMatchAt(e.index(n)),h=[];if(t.forEach(u=>{if(!h)return;let C,g=o.findWrapping(u.type);if(!g)return h=null;if(C=h.length&&l.length&&un(g,l,u,h[h.length-1],0))h[h.length-1]=C;else{h.length&&(h[h.length-1]=fn(h[h.length-1],l.length));let _=dn(u,g);h.push(_),o=o.matchType(_.type),l=g}}),h)return R.HY.from(h)}return t}(u.content,o),!0),u.openStart||u.openEnd){let V=0,U=0;for(let F=u.content.firstChild;V<u.openStart&&!F.type.spec.isolating;V++,F=F.firstChild);for(let F=u.content.lastChild;U<u.openEnd&&!F.type.spec.isolating;U++,F=F.lastChild);u=pn(u,V,U)}return t.someProp("transformPasted",V=>{u=V(u)}),u}const $n=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function dn(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,R.HY.from(t));return t}function un(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){let l=un(t,e,n,r.lastChild,o+1);if(l)return r.copy(r.content.replaceChild(r.childCount-1,l));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(R.HY.from(dn(n,t,o+1))))}}function fn(t,e){if(0==e)return t;let n=t.content.replaceChild(t.childCount-1,fn(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(R.HY.empty,!0);return t.copy(n.append(r))}function Rt(t,e,n,r,o,l){let h=e<0?t.firstChild:t.lastChild,u=h.content;return o<r-1&&(u=Rt(u,e,n,r,o+1,l)),o>=n&&(u=e<0?h.contentMatchAt(0).fillBefore(u,t.childCount>1||l<=o).append(u):u.append(h.contentMatchAt(h.childCount).fillBefore(R.HY.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,h.copy(u))}function pn(t,e,n){return e<t.openStart&&(t=new R.p2(Rt(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new R.p2(Rt(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const mn={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let gn=null;function yn(){return gn||(gn=document.implementation.createHTMLDocument("title"))}const Be={};let Ae={};class jn{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ot(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Bt(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>zt(t,r))})}function zt(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)})}function ei(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function St(t){return{left:t.clientX,top:t.clientY}}function Lt(t,e,n,r,o){if(-1==r)return!1;let l=t.state.doc.resolve(r);for(let h=l.depth+1;h>0;h--)if(t.someProp(e,u=>h>l.depth?u(t,n,l.nodeAfter,l.before(h),o,!0):u(t,n,l.node(h),l.before(h),o,!1)))return!0;return!1}function gt(t,e,n){t.focused||t.focus();let r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function oi(t,e,n,r){return Lt(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",o=>o(t,e,r))}function li(t,e,n,r){return Lt(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",o=>o(t,e,r))||function ai(t,e,n){if(0!=n.button)return!1;let r=t.state.doc;if(-1==e)return!!r.inlineContent&&(gt(t,c.Bs.create(r,0,r.content.size),"pointer"),!0);let o=r.resolve(e);for(let l=o.depth+1;l>0;l--){let h=l>o.depth?o.nodeAfter:o.node(l),u=o.before(l);if(h.inlineContent)gt(t,c.Bs.create(r,u+1,u+1+h.content.size),"pointer");else{if(!c.qv.isSelectable(h))continue;gt(t,c.qv.create(r,u),"pointer")}return!0}}(t,n,r)}function Ft(t){return bt(t)}Ae.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!Mn(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!Y||!G||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!se||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",r=>r(t,n))||function Jn(t,e){let n=e.keyCode,r=function Kn(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||ce&&72==n&&"c"==r?ln(t,-1)||wt(t):46==n||ce&&68==n&&"c"==r?ln(t,1)||It(t):13==n||27==n||(37==n||ce&&66==n&&"c"==r?rn(t,-1,r)||wt(t):39==n||ce&&70==n&&"c"==r?rn(t,1,r)||It(t):38==n||ce&&80==n&&"c"==r?on(t,-1,r)||wt(t):40==n||ce&&78==n&&"c"==r?function qn(t){if(!J||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelection();if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){let r=e.firstChild;an(t,r,"true"),setTimeout(()=>an(t,r,"false"),20)}return!1}(t)||on(t,1,r)||It(t):r==(ce?"m":"c")&&(66==n||73==n||89==n||90==n))}(t,n)?n.preventDefault():ot(t,"key");else{let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",o=>o(t,I(13,"Enter"))),t.input.lastIOSEnter=0)},200)}},Ae.keyup=(t,e)=>{16==e.keyCode&&(t.input.shiftKey=!1)},Ae.keypress=(t,e)=>{let n=e;if(Mn(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ce&&n.metaKey)return;if(t.someProp("handleKeyPress",o=>o(t,n)))return void n.preventDefault();let r=t.state.selection;if(!(r instanceof c.Bs&&r.$from.sameParent(r.$to))){let o=String.fromCharCode(n.charCode);t.someProp("handleTextInput",l=>l(t,r.$from.pos,r.$to.pos,o))||t.dispatch(t.state.tr.insertText(o).scrollIntoView()),n.preventDefault()}};const xn=ce?"metaKey":"ctrlKey";Be.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Ft(t),o=Date.now(),l="singleClick";o-t.input.lastClick.time<500&&function ni(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(n,t.input.lastClick)&&!n[xn]&&("singleClick"==t.input.lastClick.type?l="doubleClick":"doubleClick"==t.input.lastClick.type&&(l="tripleClick")),t.input.lastClick={time:o,x:n.clientX,y:n.clientY,type:l};let h=t.posAtCoords(St(n));!h||("singleClick"==l?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new ci(t,h,n,!!r)):("doubleClick"==l?oi:li)(t,h.pos,h.inside,n)?n.preventDefault():ot(t,"pointer"))};class ci{constructor(e,n,r,o){let l,h;if(this.view=e,this.pos=n,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[xn],this.allowDefault=r.shiftKey,n.inside>-1)l=e.state.doc.nodeAt(n.inside),h=n.inside;else{let _=e.state.doc.resolve(n.pos);l=_.parent,h=_.depth?_.before():0}const u=o?null:r.target,g=u?e.docView.nearestDesc(u,!0):null;this.target=g?g.dom:null;let{selection:C}=e.state;(0==r.button&&l.type.spec.draggable&&!1!==l.type.spec.selectable||C instanceof c.qv&&C.from<=h&&C.to>h)&&(this.mightDrag={node:l,pos:h,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!q||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ot(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>je(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(St(e))),this.allowDefault||!n?ot(this.view,"pointer"):function si(t,e,n,r,o){return Lt(t,"handleClickOn",e,n,r)||t.someProp("handleClick",l=>l(t,e,r))||(o?function ri(t,e){if(-1==e)return!1;let r,o,n=t.state.selection;n instanceof c.qv&&(r=n.node);let l=t.state.doc.resolve(e);for(let h=l.depth+1;h>0;h--){let u=h>l.depth?l.nodeAfter:l.node(h);if(c.qv.isSelectable(u)){o=r&&n.$from.depth>0&&h>=n.$from.depth&&l.before(n.$from.depth+1)==n.$from.pos?l.before(n.$from.depth):l.before(h);break}}return null!=o&&(gt(t,c.qv.create(t.state.doc,o),"pointer"),!0)}(t,n):function ii(t,e){if(-1==e)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&c.qv.isSelectable(r))&&(gt(t,new c.qv(n),"pointer"),!0)}(t,n))}(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||J&&this.mightDrag&&!this.mightDrag.node.isAtom||G&&!(this.view.state.selection instanceof c.Bs)&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(gt(this.view,c.Y1.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):ot(this.view,"pointer")}move(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),ot(this.view,"pointer"),0==e.buttons&&this.done()}}function Mn(t,e){return!!t.composing||!!(J&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}Be.touchdown=t=>{Ft(t),ot(t,"pointer")},Be.contextmenu=t=>Ft(t);const hi=Y?5e3:-1;function kn(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>bt(t),e))}function On(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=function di(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function bt(t,e=!1){if(!(Y&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),On(t),e||t.docView&&t.docView.dirty){let n=Zt(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}Ae.compositionstart=Ae.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>!1===r.type.spec.inclusive)))t.markCursor=t.state.storedMarks||n.marks(),bt(t,!0),t.markCursor=null;else if(bt(t),q&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelection();for(let o=r.focusNode,l=r.focusOffset;o&&1==o.nodeType&&0!=l;){let h=l<0?o.lastChild:o.childNodes[l-1];if(!h)break;if(3==h.nodeType){r.collapse(h,h.nodeValue.length);break}o=h,l=-1}}t.input.composing=!0}kn(t,hi)},Ae.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,kn(t,20))};const yt=j&&ee<15||se&&xe<604;function Wt(t,e,n,r){let o=hn(t,e,n,t.input.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",u=>u(t,r,o||R.p2.empty)))return!0;if(!o)return!1;let l=function fi(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),h=l?t.state.tr.replaceSelectionWith(l,t.input.shiftKey):t.state.tr.replaceSelection(o);return t.dispatch(h.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Be.copy=Ae.cut=(t,e)=>{let n=e,r=t.state.selection,o="cut"==n.type;if(r.empty)return;let l=yt?null:n.clipboardData,h=r.content(),{dom:u,text:g}=cn(t,h);l?(n.preventDefault(),l.clearData(),l.setData("text/html",u.innerHTML),l.setData("text/plain",g)):function ui(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}(t,u),o&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Ae.paste=(t,e)=>{let n=e;if(t.composing&&!Y)return;let r=yt?null:n.clipboardData;r&&Wt(t,r.getData("text/plain"),r.getData("text/html"),n)?n.preventDefault():function pi(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Wt(t,r.value,null,e):Wt(t,r.textContent,r.innerHTML,e)},50)}(t,n)};class mi{constructor(e,n){this.slice=e,this.move=n}}const Cn=ce?"altKey":"ctrlKey";Be.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let o=t.state.selection,l=o.empty?null:t.posAtCoords(St(n));if(!(l&&l.pos>=o.from&&l.pos<=(o instanceof c.qv?o.to-1:o.to)))if(r&&r.mightDrag)t.dispatch(t.state.tr.setSelection(c.qv.create(t.state.doc,r.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let C=t.docView.nearestDesc(n.target,!0);C&&C.node.type.spec.draggable&&C!=t.docView&&t.dispatch(t.state.tr.setSelection(c.qv.create(t.state.doc,C.posBefore)))}let h=t.state.selection.content(),{dom:u,text:g}=cn(t,h);n.dataTransfer.clearData(),n.dataTransfer.setData(yt?"Text":"text/html",u.innerHTML),n.dataTransfer.effectAllowed="copyMove",yt||n.dataTransfer.setData("text/plain",g),t.dragging=new mi(h,!n[Cn])},Be.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)},Ae.dragover=Ae.dragenter=(t,e)=>e.preventDefault(),Ae.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let o=t.posAtCoords(St(n));if(!o)return;let l=t.state.doc.resolve(o.pos);if(!l)return;let h=r&&r.slice;h?t.someProp("transformPasted",H=>{h=H(h)}):h=hn(t,n.dataTransfer.getData(yt?"Text":"text/plain"),yt?null:n.dataTransfer.getData("text/html"),!1,l);let u=!(!r||n[Cn]);if(t.someProp("handleDrop",H=>H(t,n,h||R.p2.empty,u)))return void n.preventDefault();if(!h)return;n.preventDefault();let g=h?(0,Z.nj)(t.state.doc,l.pos,h):l.pos;null==g&&(g=l.pos);let C=t.state.tr;u&&C.deleteSelection();let _=C.mapping.map(g),V=0==h.openStart&&0==h.openEnd&&1==h.content.childCount,U=C.doc;if(V?C.replaceRangeWith(_,_,h.content.firstChild):C.replaceRange(_,_,h),C.doc.eq(U))return;let F=C.doc.resolve(_);if(V&&c.qv.isSelectable(h.content.firstChild)&&F.nodeAfter&&F.nodeAfter.sameMarkup(h.content.firstChild))C.setSelection(new c.qv(F));else{let H=C.mapping.map(g);C.mapping.maps[C.mapping.maps.length-1].forEach((ge,Ce,De,Ve)=>H=Ve),C.setSelection(Pt(t,F,C.doc.resolve(H)))}t.focus(),t.dispatch(C.setMeta("uiEvent","drop"))},Be.focus=t=>{t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelection())&&je(t)},20))},Be.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},Be.beforeinput=(t,e)=>{if(G&&Y&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",l=>l(t,I(8,"Backspace")))))return;let{$cursor:o}=t.state.selection;o&&o.pos>0&&t.dispatch(t.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let t in Ae)Be[t]=Ae[t];function Ot(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Ut{constructor(e,n){this.toDOM=e,this.spec=n||lt,this.side=this.spec.side||0}map(e,n,r,o){let{pos:l,deleted:h}=e.mapResult(n.from+o,this.side<0?-1:1);return h?null:new Fe(l-r,l-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Ut&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ot(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Qe{constructor(e,n){this.attrs=e,this.spec=n||lt}map(e,n,r,o){let l=e.map(n.from+o,this.spec.inclusiveStart?-1:1)-r,h=e.map(n.to+o,this.spec.inclusiveEnd?1:-1)-r;return l>=h?null:new Fe(l,h,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Qe&&Ot(this.attrs,e.attrs)&&Ot(this.spec,e.spec)}static is(e){return e.type instanceof Qe}destroy(){}}class Vt{constructor(e,n){this.attrs=e,this.spec=n||lt}map(e,n,r,o){let l=e.mapResult(n.from+o,1);if(l.deleted)return null;let h=e.mapResult(n.to+o,-1);return h.deleted||h.pos<=l.pos?null:new Fe(l.pos-r,h.pos-r,this)}valid(e,n){let l,{index:r,offset:o}=e.content.findIndex(n.from);return o==n.from&&!(l=e.child(r)).isText&&o+l.nodeSize==n.to}eq(e){return this==e||e instanceof Vt&&Ot(this.attrs,e.attrs)&&Ot(this.spec,e.spec)}destroy(){}}class Fe{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Fe(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Fe(e,e,new Ut(n,r))}static inline(e,n,r,o){return new Fe(e,n,new Qe(r,o))}static node(e,n,r,o){return new Fe(e,n,new Vt(r,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof Qe}}const xt=[],lt={};class Ne{constructor(e,n){this.local=e.length?e:xt,this.children=n.length?n:xt}static create(e,n){return n.length?Et(n,e,0,lt):we}find(e,n,r){let o=[];return this.findInner(null==e?0:e,null==n?1e9:n,o,0,r),o}findInner(e,n,r,o,l){for(let h=0;h<this.local.length;h++){let u=this.local[h];u.from<=n&&u.to>=e&&(!l||l(u.spec))&&r.push(u.copy(u.from+o,u.to+o))}for(let h=0;h<this.children.length;h+=3)if(this.children[h]<n&&this.children[h+1]>e){let u=this.children[h]+1;this.children[h+2].findInner(e-u,n-u,r,o+u,l)}}map(e,n,r){return this==we||0==e.maps.length?this:this.mapInner(e,n,0,0,r||lt)}mapInner(e,n,r,o,l){let h;for(let u=0;u<this.local.length;u++){let g=this.local[u].map(e,r,o);g&&g.type.valid(n,g)?(h||(h=[])).push(g):l.onRemove&&l.onRemove(this.local[u].spec)}return this.children.length?function gi(t,e,n,r,o,l,h){let u=t.slice(),g=(_,V,U,F)=>{for(let H=0;H<u.length;H+=3){let Ce,ge=u[H+1];if(ge<0||_>ge+l)continue;let De=u[H]+l;V>=De?u[H+1]=_<=De?-2:-1:U>=o&&(Ce=F-U-(V-_))&&(u[H]+=Ce,u[H+1]+=Ce)}};for(let _=0;_<n.maps.length;_++)n.maps[_].forEach(g);let C=!1;for(let _=0;_<u.length;_+=3)if(u[_+1]<0){if(-2==u[_+1]){C=!0,u[_+1]=-1;continue}let V=n.map(t[_]+l),U=V-o;if(U<0||U>=r.content.size){C=!0;continue}let H=n.map(t[_+1]+l,-1)-o,{index:ge,offset:Ce}=r.content.findIndex(U),De=r.maybeChild(ge);if(De&&Ce==U&&Ce+De.nodeSize==H){let Ve=u[_+2].mapInner(n,De,V+1,t[_]+l+1,h);Ve!=we?(u[_]=U,u[_+1]=H,u[_+2]=Ve):(u[_+1]=-2,C=!0)}else C=!0}if(C){let _=function yi(t,e,n,r,o,l,h){function u(g,C){for(let _=0;_<g.local.length;_++){let V=g.local[_].map(r,o,C);V?n.push(V):h.onRemove&&h.onRemove(g.local[_].spec)}for(let _=0;_<g.children.length;_+=3)u(g.children[_+2],g.children[_]+C+1)}for(let g=0;g<t.length;g+=3)-1==t[g+1]&&u(t[g+2],e[g]+l+1);return n}(u,t,e,n,o,l,h),V=Et(_,r,0,h);e=V.local;for(let U=0;U<u.length;U+=3)u[U+1]<0&&(u.splice(U,3),U-=3);for(let U=0,F=0;U<V.children.length;U+=3){let H=V.children[U];for(;F<u.length&&u[F]<H;)F+=3;u.splice(F,0,V.children[U],V.children[U+1],V.children[U+2])}}return new Ne(e.sort(at),u)}(this.children,h||[],e,n,r,o,l):h?new Ne(h.sort(at),xt):we}add(e,n){return n.length?this==we?Ne.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let o,l=0;e.forEach((u,g)=>{let _,C=g+r;if(_=Sn(n,u,C)){for(o||(o=this.children.slice());l<o.length&&o[l]<g;)l+=3;o[l]==g?o[l+2]=o[l+2].addInner(u,_,C+1):o.splice(l,0,g,g+u.nodeSize,Et(_,u,C+1,lt)),l+=3}});let h=_n(l?bn(n):n,-r);for(let u=0;u<h.length;u++)h[u].type.valid(e,h[u])||h.splice(u--,1);return new Ne(h.length?this.local.concat(h).sort(at):this.local,o||this.children)}remove(e){return 0==e.length||this==we?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,o=this.local;for(let l=0;l<r.length;l+=3){let h,u=r[l]+n,g=r[l+1]+n;for(let V,_=0;_<e.length;_++)(V=e[_])&&V.from>u&&V.to<g&&(e[_]=null,(h||(h=[])).push(V));if(!h)continue;r==this.children&&(r=this.children.slice());let C=r[l+2].removeInner(h,u+1);C!=we?r[l+2]=C:(r.splice(l,3),l-=3)}if(o.length)for(let h,l=0;l<e.length;l++)if(h=e[l])for(let u=0;u<o.length;u++)o[u].eq(h,n)&&(o==this.local&&(o=this.local.slice()),o.splice(u--,1));return r==this.children&&o==this.local?this:o.length||r.length?new Ne(o,r):we}forChild(e,n){if(this==we)return this;if(n.isLeaf)return Ne.empty;let r,o;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=e){this.children[u]==e&&(r=this.children[u+2]);break}let l=e+1,h=l+n.content.size;for(let u=0;u<this.local.length;u++){let g=this.local[u];if(g.from<h&&g.to>l&&g.type instanceof Qe){let C=Math.max(l,g.from)-l,_=Math.min(h,g.to)-l;C<_&&(o||(o=[])).push(g.copy(C,_))}}if(o){let u=new Ne(o.sort(at),xt);return r?new Xe([u,r]):u}return r||we}eq(e){if(this==e)return!0;if(!(e instanceof Ne)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return qt(this.localsInner(e))}localsInner(e){if(this==we)return xt;if(e.inlineContent||!this.local.some(Qe.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Qe||n.push(this.local[r]);return n}}Ne.empty=new Ne([],[]),Ne.removeOverlap=qt;const we=Ne.empty;class Xe{constructor(e){this.members=e}map(e,n){const r=this.members.map(o=>o.map(e,n,lt));return Xe.from(r)}forChild(e,n){if(n.isLeaf)return Ne.empty;let r=[];for(let o=0;o<this.members.length;o++){let l=this.members[o].forChild(e,n);l!=we&&(l instanceof Xe?r=r.concat(l.members):r.push(l))}return Xe.from(r)}eq(e){if(!(e instanceof Xe)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let o=0;o<this.members.length;o++){let l=this.members[o].localsInner(e);if(l.length)if(n){r&&(n=n.slice(),r=!1);for(let h=0;h<l.length;h++)n.push(l[h])}else n=l}return n?qt(r?n:n.sort(at)):xt}static from(e){switch(e.length){case 0:return we;case 1:return e[0];default:return new Xe(e)}}}function _n(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let o=t[r];n.push(new Fe(o.from+e,o.to+e,o.type))}return n}function Sn(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,o=null;for(let h,l=0;l<t.length;l++)(h=t[l])&&h.from>n&&h.to<r&&((o||(o=[])).push(h),t[l]=null);return o}function bn(t){let e=[];for(let n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Et(t,e,n,r){let o=[],l=!1;e.forEach((u,g)=>{let C=Sn(t,u,g+n);if(C){l=!0;let _=Et(C,u,n+g+1,r);_!=we&&o.push(g,g+u.nodeSize,_)}});let h=_n(l?bn(t):t,-n).sort(at);for(let u=0;u<h.length;u++)h[u].type.valid(e,h[u])||(r.onRemove&&r.onRemove(h[u].spec),h.splice(u--,1));return h.length||o.length?new Ne(h,o):we}function at(t,e){return t.from-e.from||t.to-e.to}function qt(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let o=n+1;o<e.length;o++){let l=e[o];if(l.from!=r.from){l.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,l.from),En(e,o,r.copy(l.from,r.to)));break}l.to!=r.to&&(e==t&&(e=t.slice()),e[o]=l.copy(l.from,r.to),En(e,o+1,l.copy(r.to,l.to)))}}return e}function En(t,e,n){for(;e<t.length&&at(n,t[e])>0;)e++;t.splice(e,0,n)}function Kt(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=we&&e.push(r)}),t.cursorWrapper&&e.push(Ne.create(t.state.doc,[t.cursorWrapper.deco])),Xe.from(e)}const xi={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Mi=j&&ee<=11;class ki{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Oi{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ki,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let o=0;o<r.length;o++)this.queue.push(r[o]);j&&ee<=11&&r.some(o=>"childList"==o.type&&o.removedNodes.length||"characterData"==o.type&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),Mi&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,xi)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(tn(this.view)){if(this.suppressingSelectionUpdates)return je(this.view);if(j&&ee<=11&&!this.view.state.selection.empty){let e=this.view.domSelection();if(e.focusNode&&ie(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(e){if(0==e.rangeCount)return!0;let n=e.getRangeAt(0).commonAncestorContainer,r=this.view.docView.nearestDesc(n);return r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);let n=this.view.domSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&tn(this.view)&&!this.ignoreSelectionChange(n),o=-1,l=-1,h=!1,u=[];if(this.view.editable)for(let g=0;g<e.length;g++){let C=this.registerMutation(e[g],u);C&&(o=o<0?C.from:Math.min(C.from,o),l=l<0?C.to:Math.max(C.to,l),C.typeOver&&(h=!0))}if(q&&u.length>1){let g=u.filter(C=>"BR"==C.nodeName);if(2==g.length){let C=g[0],_=g[1];C.parentNode&&C.parentNode.parentNode==_.parentNode?_.remove():C.remove()}}(o>-1||r)&&(o>-1&&(this.view.docView.markDirty(o,l),function Ci(t){Tn||(Tn=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}(this.view)),this.handleDOMChange(o,l,h,u),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(n)||je(this.view),this.currentSelection.set(n))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(r==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if("childList"==e.type){for(let _=0;_<e.addedNodes.length;_++)n.push(e.addedNodes[_]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let o=e.previousSibling,l=e.nextSibling;if(j&&ee<=11&&e.addedNodes.length)for(let _=0;_<e.addedNodes.length;_++){let{previousSibling:V,nextSibling:U}=e.addedNodes[_];(!V||Array.prototype.indexOf.call(e.addedNodes,V)<0)&&(o=V),(!U||Array.prototype.indexOf.call(e.addedNodes,U)<0)&&(l=U)}let h=o&&o.parentNode==e.target?_e(o)+1:0,u=r.localPosFromDOM(e.target,h,-1),g=l&&l.parentNode==e.target?_e(l):e.target.childNodes.length;return{from:u,to:r.localPosFromDOM(e.target,g,1)}}return"attributes"==e.type?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let Tn=!1;function Si(t){let e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(J&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||J&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Dn(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Pt(t,e.resolve(n.anchor),e.resolve(n.head))}function Jt(t,e,n){let r=t.depth,o=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n){let l=t.node(r).maybeChild(t.indexAfter(r));for(;l&&!l.isLeaf;)l=l.firstChild,o++}return o}class vi{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new jn,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(In),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Nn(this),Pn(this),this.nodeViews=wn(this),this.docView=x(this.state.doc,vn(this),Kt(this),this.dom,this),this.domObserver=new Oi(this,(r,o,l,h)=>function bi(t,e,n,r,o){if(e<0){let ye=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,tt=Zt(t,ye);if(tt&&!t.state.selection.eq(tt)){let Yt=t.state.tr.setSelection(tt);"pointer"==ye?Yt.setMeta("pointer",!0):"key"==ye&&Yt.scrollIntoView(),t.dispatch(Yt)}return}let l=t.state.doc.resolve(e),h=l.sharedDepth(n);e=l.before(h+1),n=t.state.doc.resolve(n).after(h+1);let u=t.state.selection,g=function _i(t,e,n){let C,{node:r,fromOffset:o,toOffset:l,from:h,to:u}=t.docView.parseRange(e,n),g=t.domSelection(),_=g.anchorNode;if(_&&t.dom.contains(1==_.nodeType?_:_.parentNode)&&(C=[{node:_,offset:g.anchorOffset}],P(g)||C.push({node:g.focusNode,offset:g.focusOffset})),G&&8===t.input.lastKeyCode)for(let Ce=l;Ce>o;Ce--){let De=r.childNodes[Ce-1],Ve=De.pmViewDesc;if("BR"==De.nodeName&&!Ve){l=Ce;break}if(!Ve||Ve.size)break}let V=t.state.doc,U=t.someProp("domParser")||R.aw.fromSchema(t.state.schema),F=V.resolve(h),H=null,ge=U.parse(r,{topNode:F.parent,topMatch:F.parent.contentMatchAt(F.index()),topOpen:!0,from:o,to:l,preserveWhitespace:"pre"!=F.parent.type.whitespace||"full",findPositions:C,ruleFromNode:Si,context:F});if(C&&null!=C[0].pos){let Ce=C[0].pos,De=C[1]&&C[1].pos;null==De&&(De=Ce),H={anchor:Ce+h,head:De+h}}return{doc:ge,sel:H,from:h,to:u}}(t,e,n);if(G&&t.cursorWrapper&&g.sel&&g.sel.anchor==t.cursorWrapper.deco.from&&g.sel.head==g.sel.anchor){let ye=t.cursorWrapper.deco.type.toDOM.nextSibling,tt=ye&&ye.nodeValue?ye.nodeValue.length:1;g.sel={anchor:g.sel.anchor+tt,head:g.sel.anchor+tt}}let V,U,C=t.state.doc,_=C.slice(g.from,g.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(V=t.state.selection.to,U="end"):(V=t.state.selection.from,U="start"),t.input.lastKeyCode=null;let F=function Di(t,e,n,r,o){let l=t.findDiffStart(e,n);if(null==l)return null;let{a:h,b:u}=t.findDiffEnd(e,n+t.size,n+e.size);return"end"==o&&(r-=h+Math.max(0,l-Math.min(h,u))-l),h<l&&t.size<e.size?(l-=r<=l&&r>=h?l-r:0,u=l+(u-h),h=l):u<l&&(l-=r<=l&&r>=u?l-r:0,h=l+(h-u),u=l),{start:l,endA:h,endB:u}}(_.content,g.doc.content,g.from,V,U);if((se&&t.input.lastIOSEnter>Date.now()-225||Y)&&o.some(ye=>"DIV"==ye.nodeName||"P"==ye.nodeName)&&(!F||F.endA>=F.endB)&&t.someProp("handleKeyDown",ye=>ye(t,I(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(!F){if(!(r&&u instanceof c.Bs&&!u.empty&&u.$head.sameParent(u.$anchor))||t.composing||g.sel&&g.sel.anchor!=g.sel.head){if(g.sel){let ye=Dn(t,t.state.doc,g.sel);ye&&!ye.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(ye))}return}F={start:u.from,endA:u.to,endB:u.to}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&F.start==F.endB&&t.state.selection instanceof c.Bs&&(F.start>t.state.selection.from&&F.start<=t.state.selection.from+2&&t.state.selection.from>=g.from?F.start=t.state.selection.from:F.endA<t.state.selection.to&&F.endA>=t.state.selection.to-2&&t.state.selection.to<=g.to&&(F.endB+=t.state.selection.to-F.endA,F.endA=t.state.selection.to)),j&&ee<=11&&F.endB==F.start+1&&F.endA==F.start&&F.start>g.from&&" \xa0"==g.doc.textBetween(F.start-g.from-1,F.start-g.from+1)&&(F.start--,F.endA--,F.endB--);let Ve,H=g.doc.resolveNoCache(F.start-g.from),ge=g.doc.resolveNoCache(F.endB-g.from),Ce=C.resolve(F.start),De=H.sameParent(ge)&&H.parent.inlineContent&&Ce.end()>=F.endA;if((se&&t.input.lastIOSEnter>Date.now()-225&&(!De||o.some(ye=>"DIV"==ye.nodeName||"P"==ye.nodeName))||!De&&H.pos<g.doc.content.size&&(Ve=c.Y1.findFrom(g.doc.resolve(H.pos+1),1,!0))&&Ve.head==ge.pos)&&t.someProp("handleKeyDown",ye=>ye(t,I(13,"Enter"))))return void(t.input.lastIOSEnter=0);if(t.state.selection.anchor>F.start&&function Ti(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||Jt(r,!0,!1)<o.pos)return!1;let l=t.resolve(e);if(l.parentOffset<l.parent.content.size||!l.parent.isTextblock)return!1;let h=t.resolve(Jt(l,!0,!0));return!(!h.parent.isTextblock||h.pos>n||Jt(h,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(h.parent.content)}(C,F.start,F.endA,H,ge)&&t.someProp("handleKeyDown",ye=>ye(t,I(8,"Backspace"))))return void(Y&&G&&t.domObserver.suppressSelectionUpdates());G&&Y&&F.endB==F.start&&(t.input.lastAndroidDelete=Date.now()),Y&&!De&&H.start()!=ge.start()&&0==ge.parentOffset&&H.depth==ge.depth&&g.sel&&g.sel.anchor==g.sel.head&&g.sel.head==F.endA&&(F.endB-=2,ge=g.doc.resolveNoCache(F.endB-g.from),setTimeout(()=>{t.someProp("handleKeyDown",function(ye){return ye(t,I(13,"Enter"))})},20));let We,$t,Tt,et=F.start,ct=F.endA;if(De)if(H.pos==ge.pos)j&&ee<=11&&0==H.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>je(t),20)),We=t.state.tr.delete(et,ct),$t=C.resolve(F.start).marksAcross(C.resolve(F.endA));else if(F.endA==F.endB&&(Tt=function Ei(t,e){let h,u,g,n=t.firstChild.marks,r=e.firstChild.marks,o=n,l=r;for(let _=0;_<r.length;_++)o=r[_].removeFromSet(o);for(let _=0;_<n.length;_++)l=n[_].removeFromSet(l);if(1==o.length&&0==l.length)u=o[0],h="add",g=_=>_.mark(u.addToSet(_.marks));else{if(0!=o.length||1!=l.length)return null;u=l[0],h="remove",g=_=>_.mark(u.removeFromSet(_.marks))}let C=[];for(let _=0;_<e.childCount;_++)C.push(g(e.child(_)));if(R.HY.from(C).eq(t))return{mark:u,type:h}}(H.parent.content.cut(H.parentOffset,ge.parentOffset),Ce.parent.content.cut(Ce.parentOffset,F.endA-Ce.start()))))We=t.state.tr,"add"==Tt.type?We.addMark(et,ct,Tt.mark):We.removeMark(et,ct,Tt.mark);else if(H.parent.child(H.index()).isText&&H.index()==ge.index()-(ge.textOffset?0:1)){let ye=H.parent.textBetween(H.parentOffset,ge.parentOffset);if(t.someProp("handleTextInput",tt=>tt(t,et,ct,ye)))return;We=t.state.tr.insertText(ye,et,ct)}if(We||(We=t.state.tr.replace(et,ct,g.doc.slice(F.start-g.from,F.endB-g.from))),g.sel){let ye=Dn(t,We.doc,g.sel);ye&&!(G&&Y&&t.composing&&ye.empty&&(F.start!=F.endB||t.input.lastAndroidDelete<Date.now()-100)&&(ye.head==et||ye.head==We.mapping.map(ct)-1)||j&&ye.empty&&ye.head==et)&&We.setSelection(ye)}$t&&We.ensureMarks($t),t.dispatch(We.scrollIntoView())}(this,r,o,l,h)),this.domObserver.start(),function Qn(t){for(let e in Be){let n=Be[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{ei(t,r)&&!zt(t,r)&&(t.editable||!(r.type in Ae))&&n(t,r)})}J&&t.dom.addEventListener("input",()=>null),Bt(t)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Bt(this),this._props=e,e.plugins&&(e.plugins.forEach(In),this.directPlugins=e.plugins),this.updateStateInner(e.state,!0)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this.state.plugins!=e.plugins)}updateStateInner(e,n){let r=this.state,o=!1,l=!1;if(e.storedMarks&&this.composing&&(On(this),l=!0),this.state=e,n){let V=wn(this);(function Ni(t,e){let n=0,r=0;for(let o in t){if(t[o]!=e[o])return!0;n++}for(let o in e)r++;return n!=r})(V,this.nodeViews)&&(this.nodeViews=V,o=!0),Bt(this)}this.editable=Nn(this),Pn(this);let h=Kt(this),u=vn(this),g=n?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",C=o||!this.docView.matchesNode(e.doc,u,h);(C||!e.selection.eq(r.selection))&&(l=!0);let _="preserve"==g&&l&&null==this.dom.style.overflowAnchor&&function be(t){let r,o,e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top);for(let l=(e.left+e.right)/2,h=n+1;h<Math.min(innerHeight,e.bottom);h+=5){let u=t.root.elementFromPoint(l,h);if(!u||u==t.dom||!t.dom.contains(u))continue;let g=u.getBoundingClientRect();if(g.top>=n-20){r=u,o=g.top;break}}return{refDOM:r,refTop:o,stack:ve(t.dom)}}(this);if(l){this.domObserver.stop();let V=C&&(j||G)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function Pi(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,e.selection);if(C){let U=G?this.trackWrites=this.domSelection().focusNode:null;(o||!this.docView.update(e.doc,u,h,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=x(e.doc,u,h,this.dom,this)),U&&!this.trackWrites&&(V=!0)}V||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function Vn(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelection();return ie(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?je(this,V):(Xt(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==g)this.dom.scrollTop=0;else if("to selection"==g){let V=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",U=>U(this)))if(e.selection instanceof c.qv){let U=this.docView.domAfterPos(e.selection.from);1==U.nodeType&&Oe(this,U.getBoundingClientRect(),V)}else Oe(this,this.coordsAtPos(e.selection.head,1),V)}else _&&function Te({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;qe(n,0==r?0:r-e)}(_)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}}someProp(e,n){let o,r=this._props&&this._props[e];if(null!=r&&(o=n?n(r):r))return o;for(let h=0;h<this.directPlugins.length;h++){let u=this.directPlugins[h].props[e];if(null!=u&&(o=n?n(u):u))return o}let l=this.state.plugins;if(l)for(let h=0;h<l.length;h++){let u=l[h].props[e];if(null!=u&&(o=n?n(u):u))return o}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function ht(t){if(t.setActive)return t.setActive();if(Ke)return t.focus(Ke);let e=ve(t);t.focus(null==Ke?{get preventScroll(){return Ke={preventScroll:!0},!0}}:void 0),Ke||(Ke=!1,qe(e,0))}(this.dom),je(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n;return e||document}posAtCoords(e){return ft(this,e)}coordsAtPos(e,n=1){return it(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let o=this.docView.posFromDOM(e,n,r);if(null==o)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,n){return function p(t,e,n){return Ye==e&&T==n?d:(Ye=e,T=n,d="up"==n||"down"==n?function mt(t,e,n){let r=e.selection,o="up"==n?r.$from:r.$to;return pt(t,e,()=>{let{node:l}=t.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let u=t.docView.nearestDesc(l,!0);if(!u)break;if(u.node.isBlock){l=u.dom;break}l=u.dom.parentNode}let h=it(t,o.pos,1);for(let u=l.firstChild;u;u=u.nextSibling){let g;if(1==u.nodeType)g=u.getClientRects();else{if(3!=u.nodeType)continue;g=ue(u,0,u.nodeValue.length).getClientRects()}for(let C=0;C<g.length;C++){let _=g[C];if(_.bottom>_.top+1&&("up"==n?h.top-_.top>2*(_.bottom-h.top):_.bottom-h.bottom>2*(h.bottom-_.top)))return!1}}return!0})}(t,e,n):function ze(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,l=!o,h=o==r.parent.content.size,u=t.domSelection();return He.test(r.parent.textContent)&&u.modify?pt(t,e,()=>{let g=u.getRangeAt(0),C=u.focusNode,_=u.focusOffset,V=u.caretBidiLevel;u.modify("move",n,"character");let F=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==u.focusNode.nodeType?u.focusNode:u.focusNode.parentNode)||C==u.focusNode&&_==u.focusOffset;return u.removeAllRanges(),u.addRange(g),null!=V&&(u.caretBidiLevel=V),F}):"left"==n||"backward"==n?l:h}(t,e,n))}(this,n||this.state,e)}destroy(){!this.docView||(function Xn(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Kt(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function ti(t,e){!zt(t,e)&&Be[e.type]&&(t.editable||!(e.type in Ae))&&Be[e.type](t,e)}(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelection(){return this.root.getSelection()}}function vn(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),e.translate="no",t.someProp("attributes",n=>{if("function"==typeof n&&(n=n(t.state)),n)for(let r in n)"class"==r&&(e.class+=" "+n[r]),"style"==r?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&"contenteditable"!=r&&"nodeName"!=r&&(e[r]=String(n[r]))}),[Fe.node(0,t.state.doc.content.size,e)]}function Pn(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Fe.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Nn(t){return!t.someProp("editable",e=>!1===e(t.state))}function wn(t){let e=Object.create(null);function n(r){for(let o in r)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=r[o])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function In(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}},5861:(Me,ne,E)=>{function c(Z,A,D,z,L,S,w){try{var j=Z[S](w),ee=j.value}catch(q){return void D(q)}j.done?A(ee):Promise.resolve(ee).then(z,L)}function R(Z){return function(){var A=this,D=arguments;return new Promise(function(z,L){var S=Z.apply(A,D);function w(ee){c(S,z,L,w,j,"next",ee)}function j(ee){c(S,z,L,w,j,"throw",ee)}w(void 0)})}}E.d(ne,{Z:()=>R})}}]);